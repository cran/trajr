<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jim McLean" />

<meta name="date" content="2019-06-10" />

<title>Animal trajectory analysis with trajr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Animal trajectory analysis with trajr</h1>
<h4 class="author"><em>Jim McLean</em></h4>
<h4 class="date"><em>2019-06-10</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#installation-and-setup">Installation and setup</a></li>
</ul></li>
<li><a href="#trajectories-in-trajr">Trajectories in <code>trajr</code></a><ul>
<li><a href="#creating-trajectories">Creating Trajectories</a></li>
<li><a href="#scaling-trajectories">Scaling Trajectories</a></li>
<li><a href="#smoothing-trajectories">Smoothing trajectories</a></li>
<li><a href="#resampling-trajectories">Resampling trajectories</a></li>
<li><a href="#other-trajectory-operations">Other trajectory operations</a></li>
</ul></li>
<li><a href="#trajectory-analysis">Trajectory analysis</a><ul>
<li><a href="#analysing-speed">Analysing speed</a></li>
<li><a href="#analysing-straightness">Analysing straightness</a><ul>
<li><a href="#straightness-index">Straightness index</a></li>
<li><a href="#sinuosity">Sinuosity</a></li>
<li><a href="#emax">E<sub>max</sub></a></li>
<li><a href="#fractal-dimension">Fractal dimension</a></li>
<li><a href="#directional-change-dc-and-sddc">Directional change (DC and SDDC)</a></li>
<li><a href="#direction-autocorrelation">Direction autocorrelation</a></li>
</ul></li>
</ul></li>
<li><a href="#working-with-multiple-trajectories">Working with multiple trajectories</a><ul>
<li><a href="#building-multiple-trajectories">Building multiple trajectories</a></li>
<li><a href="#characterising-multiple-trajectories">Characterising multiple trajectories</a></li>
<li><a href="#pca-analysis-of-multiple-trajectories">PCA analysis of multiple trajectories</a></li>
<li><a href="#other-operations">Other operations</a></li>
</ul></li>
<li><a href="#random-trajectory-generation">Random trajectory generation</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#and-finally">And finally…</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>trajr</code> R package is a toolkit for the numerical characterisation and analysis of the trajectories of moving animals. Trajectory analysis is applicable in fields as diverse as optimal foraging theory, migration, and behavioural mimicry (e.g. for verifying similarities in locomotion). A <em>trajectory</em> is simply a record of the path followed by a moving animal. <code>Trajr</code> operates on trajectories in the form of a series of locations (as x, y coordinates) with times. Trajectories may be obtained by any method which provides this information, including manual tracking, radio telemetry, GPS tracking, and motion tracking from videos.</p>
<p>The goal of this package (and this document) is to aid biological researchers, who may not have extensive experience with R, to analyse trajectories without being handicapped by a limited knowledge of R or programming. However, a basic understanding of R is required.</p>
<p>Within this document, the plots are generated by running the code examples immediately before them. For that reason, most code examples start with a call to <code>TrajGenerate</code>, which generates a random trajectory to be plotted. These calls would not occur in an analysis of real animal trajectories.</p>
<p>If you use <code>trajr</code> in your publications, please cite <a href="http://dx.doi.org/10.1111/eth.12739">McLean DJ, Skowron Volponi MA. trajr: An R package for characterisation of animal trajectories. Ethology. 2018;00:1–9. https://doi.org/10.1111/eth.12739</a>.</p>
<div id="installation-and-setup" class="section level3">
<h3>Installation and setup</h3>
<p>Before using any R package, it is first necessary to install and load it. To install the latest released version of <code>trajr</code>, simply run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;trajr&quot;</span>)</code></pre></div>
<p>To install the latest development version, which is available on <a href="https://github.com/JimMcL/trajr">GitHub</a>, run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;JimMcL/trajr&quot;</span>)</code></pre></div>
<p>Once the package has been installed, you must load it, then it’s ready for use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;trajr&quot;</span>)</code></pre></div>
<p>Packages only need to be installed once, but they must be loaded in every session before they can be used.</p>
<p>Once the <code>trajr</code> package has been installed and loaded, you have access to the set of R functions it provides. All <code>trajr</code> functions (other than the generic functions <code>plot</code>, <code>lines</code> and <code>points</code>) start with the prefix <code>Traj</code>. Several of the functions provided by <code>trajr</code> do not provide additional analytic functionality, rather they make it easier to work with multiple trajectories. These convenience functions are prefixed with <code>Trajs</code>.</p>
</div>
</div>
<div id="trajectories-in-trajr" class="section level2">
<h2>Trajectories in <code>trajr</code></h2>
<p><code>Trajr</code> works with trajectories, where a trajectory is a simplification of a real path travelled by an animal, and is a set of 2-dimensional spatial coordinates with a third temporal dimension. A trajectory can also be thought of as a series of steps, each comprised of a length (L<sub>i</sub>), a turning angle (<span class="math inline">\(\Delta\)</span><sub>i</sub>), and a time. While trajectories have been modelled in various ways, <code>trajr</code> works with two theoretical models: <em>correlated random walks</em> in which the turning angle of each step is the direction of the previous step ± some error; and <em>directed walks</em>, or compass-based navigation, in which the angular errors at each step are added to the “ideal” or compass direction. <code>Trajr</code> generally assumes correlated random walks, but provides some support for directed walks.</p>
<div class="figure">
<img src="data:image/png;base64,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" alt="A correlated random walk with 5 steps. The direction of step i is the direction of step (i - 1) + \Deltai." />
<p class="caption"><em>A correlated random walk with 5 steps. The direction of step <span class="math inline">\(i\)</span> is the direction of step <span class="math inline">\((i - 1) + \Delta\)</span><sub>i</sub>.</em></p>
</div>
<div class="figure">
<img src="data:image/png;base64,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" alt="A directed walk with 5 steps. The direction of step i is the compass direction (here 0^\circ) + \Deltai." />
<p class="caption"><em>A directed walk with 5 steps. The direction of step <span class="math inline">\(i\)</span> is the compass direction (here 0<span class="math inline">\(^\circ\)</span>) + <span class="math inline">\(\Delta\)</span><sub>i</sub>.</em></p>
</div>
<p>Within <code>trajr</code>, trajectories are represented by R objects with class <code>Trajectory</code>. The <code>TrajFromCoords</code> function is used to create a <code>Trajectory</code> object from a set of x-y coordinates, with optional times.</p>
<!-- NOTE the echo=-1 removes the first line of code from the output, as I want it to run to make the plot look pretty, but it's not relevant to a reader -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define x, y, and time coordinates</span>
coords &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="dv">4</span>), 
                     <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), 
                     <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))
<span class="co"># Create a trajectory from the coordinates</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords)

<span class="co"># Plot it</span>
<span class="kw">plot</span>(trj)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Trajectory created from coordinates." />
<p class="caption"><em>Trajectory created from coordinates.</em></p>
</div>
<div id="creating-trajectories" class="section level3">
<h3>Creating Trajectories</h3>
<p>In practice, trajectory coordinates are typically read from a data file such as a CSV file, and then passed in to the <code>TrajFromCoords</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;mycoords.csv&quot;</span>)
trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords)</code></pre></div>
<p><code>TrajFromCoords</code> assumes that the first column in <code>coords</code> contains x values, the second contains y values, and that points were sampled at a constant sampling frequency of 50 points/second. The help page for <code>TrajFromCoords</code> describes how to alter these defaults - run <code>?TrajFromCoords</code> to access the help page. Many functions (including <code>TrajFromCoords</code>) contain code examples as part of their help information. You can also display and run an example by calling the <code>example</code> function: i.e. <code>example(&quot;TrajFromCoords&quot;)</code>.</p>
</div>
<div id="scaling-trajectories" class="section level3">
<h3>Scaling Trajectories</h3>
<p>Trajectories may need to be scaled before analysis. For instance, when a trajectory is digitised from video, the spatial units will be pixels, and require conversion to more meaningful units such as metres. Trajectories are scaled by calling <code>TrajScale</code>, specifying the scale factor and the abbreviation of the transformed units. In the case of a trajectory digitised from a video, you can calculate scale as <span class="math inline">\(width^{m}/width^{p}\)</span>, where <span class="math inline">\(width^{m}\)</span> is the width of an object in metres, and <span class="math inline">\(width^{p}\)</span> is the width of the same object in pixels, as measured from the video. A commonly used method to determine the scale is to include a measuring tape in the video, then measure the number of pixels in a length of the tape.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Example 1</span>
coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;H. pahangensis.csv&quot;</span>)
trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords, <span class="dt">spatialUnits =</span> <span class="st">&quot;pixels&quot;</span>)
<span class="co"># A 10 mm (= .01 m) object had length 47 pixels in the video, scale to metres</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajScale</span>(trj, .<span class="dv">01</span> <span class="op">/</span><span class="st"> </span><span class="dv">47</span>, <span class="st">&quot;m&quot;</span>)

<span class="co"># Example 2</span>
coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;A. argentifasciata.csv&quot;</span>)
<span class="co"># In this video, a 20 cm (= .2 m) object had length 1800 pixels, scale to metres</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajScale</span>(trj, .<span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">1800</span>, <span class="st">&quot;m&quot;</span>)</code></pre></div>
</div>
<div id="smoothing-trajectories" class="section level3">
<h3>Smoothing trajectories</h3>
<p>Many trajectories will suffer from noise which may bias the results of some analyses. The <code>TrajSmoothSG</code> function reduces high frequency noise while preserving the shape of the trajectory, by applying a Savitzky-Golay smoothing filter. It requires two arguments (in addition to the trajectory), <code>n</code>, the filter order, and <code>m</code>, the filter length (which must be odd). Refer to the help for the function <code>sgolayfilt</code> (run <code>?signal::sgolayfilt</code>) for details of the filter function.</p>
<p>There are some issues which should be considered when deciding whether to smooth and by how much. If duplicate points are omitted from a trajectory (i.e. multiple points representing the same stopped location are not explicitly specified), smoothing is likely to result in a segment spanning the gap which is decreasing in velocity, but not stopped. Similarly, smoothing (or too much smoothing) may eliminate short periods of zero (or near-zero) velocity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">200</span>, <span class="dt">random =</span> <span class="ot">TRUE</span>, <span class="dt">angularErrorSd =</span> .<span class="dv">25</span>)

<span class="co"># Plot original trajectory</span>
<span class="kw">plot</span>(trj, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">1</span>)

<span class="co"># Create a smoothed trajectory, filter order 3, length 31</span>
smoothed &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dt">p =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">31</span>)
<span class="co"># Plot it in slightly transparent red</span>
<span class="kw">lines</span>(smoothed, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Smoothed&quot;</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Effect of smoothing a trajectory." />
<p class="caption"><em>Effect of smoothing a trajectory.</em></p>
</div>
</div>
<div id="resampling-trajectories" class="section level3">
<h3>Resampling trajectories</h3>
<p><code>trajr</code> provides functions to resample a trajectory to a fixed step length or a fixed step stime.</p>
<p>Some functions require a <code>Trajectory</code> with a fixed step length. The process of resampling a trajectory to a fixed step length is called <em>rediscretization</em>. The function <code>TrajRediscretize</code> implements trajectory resampling using the algorithm described by Bovet &amp; Benhamou (1988). There are no clear guidelines for choosing a suitable step length for rediscretization: too small a step length leads to oversampling, leading to high autocorrelation between steps and high variability; too large a step length results in undersampling and loss of information. See Turchin (1998) section 5.2.2 for a discussion.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">10</span>, <span class="dt">stepLength =</span> <span class="dv">2</span>)

<span class="co"># Plot original trajectory with dots at trajectory coordinates</span>
<span class="kw">plot</span>(trj, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">points</span>(trj, <span class="dt">draw.start.pt =</span> <span class="ot">FALSE</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)

<span class="co"># Resample to step length 1</span>
resampled &lt;-<span class="st"> </span><span class="kw">TrajRediscretize</span>(trj, <span class="dv">1</span>)

<span class="co"># Plot rediscretized trajectory in red</span>
<span class="kw">lines</span>(resampled, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">points</span>(resampled, <span class="dt">type =</span> <span class="st">'p'</span>, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Rediscretized&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), 
       <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Rediscretization of trajectory with \mu_{L} = 2 to step length 1." />
<p class="caption"><em>Rediscretization of trajectory with <span class="math inline">\(\mu_{L} = 2\)</span> to step length <span class="math inline">\(1\)</span>.</em></p>
</div>
<p>The function <code>TrajResampleTime</code> linearly interpolates points along a trajectory to create a new trajectory with fixed step time intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate trajectory with a point every 2 hours and highly variable speed (which equates to step length)</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">10</span>, <span class="dt">stepLength =</span> <span class="dv">1</span>, <span class="dt">fps =</span> .<span class="dv">5</span>, <span class="dt">timeUnits =</span> <span class="st">&quot;hours&quot;</span>, <span class="dt">linearErrorSd =</span> .<span class="dv">8</span>)

<span class="co"># Plot original trajectory with dots at trajectory coordinates</span>
<span class="kw">plot</span>(trj, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">points</span>(trj, <span class="dt">draw.start.pt =</span> <span class="ot">FALSE</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>)

<span class="co"># Resample to 1 hourly steps</span>
resampled &lt;-<span class="st"> </span><span class="kw">TrajResampleTime</span>(trj, <span class="dv">1</span>)

<span class="co"># Plot rediscretized trajectory in red</span>
<span class="kw">lines</span>(resampled, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">points</span>(resampled, <span class="dt">type =</span> <span class="st">'p'</span>, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Resampled&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), 
       <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Resampling of trajectory with step duration 1 hour." />
<p class="caption"><em>Resampling of trajectory with step duration <span class="math inline">\(1\)</span> hour.</em></p>
</div>
</div>
<div id="other-trajectory-operations" class="section level3">
<h3>Other trajectory operations</h3>
<p>This table lists trajectory operations not otherwise addressed by this document. Refer to the help for each function for information.</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>TrajRotate</code></td>
<td align="left">Rotates a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajTranslate</code></td>
<td align="left">Translates a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajReverse</code></td>
<td align="left">Reverses a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajGetFPS</code></td>
<td align="left">Returns the frames-per-second of a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajGetNCoords</code></td>
<td align="left">Returns the number of coordinates of a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajGetUnits</code></td>
<td align="left">Returns the spatial units of a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajGetTimeUnits</code></td>
<td align="left">Returns the temporal units of a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajStepLengths</code></td>
<td align="left">Returns the lengths of each step within the trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajLength</code></td>
<td align="left">Returns the total length of the trajectory (or a portion)</td>
</tr>
<tr class="even">
<td align="left"><code>TrajDistance</code></td>
<td align="left">Returns the straight-line distance from the start to the end of the trajectory (or a portion)</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajDuration</code></td>
<td align="left">Returns the temporal duration of the trajectory (or a portion)</td>
</tr>
<tr class="even">
<td align="left"><code>TrajMeanVelocity</code></td>
<td align="left">Returns the mean velocity vector of the trajectory (or a portion)</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajAngles</code></td>
<td align="left">Returns the turning angles (radians) of a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajMeanVectorOfTurningAngles</code></td>
<td align="left">Returns the mean vector of the turning angles</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajExpectedSquareDisplacement</code></td>
<td align="left">Returns the expected square displacement of a correlated random walk</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="trajectory-analysis" class="section level2">
<h2>Trajectory analysis</h2>
<p>Once you have obtained a correctly scaled <code>Trajectory</code> object, you may call various functions to analyse the trajectory. Broadly speaking, analysis may be divided into measures of speed or acceleration, and measures of straightness or tortuosity.</p>
<div id="analysing-speed" class="section level3">
<h3>Analysing speed</h3>
<p>The <code>TrajDerivatives</code> function calculates linear speed and acceleration along a <code>Trajectory</code>. If the trajectory is noisy, it should be smoothed before the derivatives are calculated (see <a href="#smoothing-trajectories">Smoothing trajectories</a>, but take note of the caveats described there).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>()

<span class="co"># Smooth before calculating derivatives</span>
smoothed &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">101</span>)

<span class="co"># Calculate speed and acceleration</span>
derivs &lt;-<span class="st"> </span><span class="kw">TrajDerivatives</span>(smoothed)

<span class="co"># Plot acceleration and speed</span>
<span class="kw">plot</span>(derivs<span class="op">$</span>acceleration <span class="op">~</span><span class="st"> </span>derivs<span class="op">$</span>accelerationTimes, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">'red'</span>, 
     <span class="dt">yaxt =</span> <span class="st">'n'</span>,
     <span class="dt">xlab =</span> <span class="st">'Time (s)'</span>,
     <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">'Acceleration ('</span>, m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span>, <span class="st">')'</span>)))
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">lines</span>(derivs<span class="op">$</span>speed <span class="op">~</span><span class="st"> </span>derivs<span class="op">$</span>speedTimes, <span class="dt">col =</span> <span class="st">'blue'</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">mtext</span>(<span class="st">'Speed (m/s)'</span>, <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">'lightGrey'</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Speed and acceleration over time." />
<p class="caption"><em>Speed and acceleration over time.</em></p>
</div>
<p>Once the trajectory speed and acceleration have been obtained, it is simple to calculate values such as mean, maximum, minimum or standard deviation of speed (or acceleration): <code>mean(derivs$speed)</code>, <code>max(derivs$speed)</code>, <code>min(derivs$speed)</code>, or <code>sd(derivs$speed)</code>. Similarly, calculations excluding periods when speed drops below (or above) some value are also straightforward, for example: <code>mean(derivs$speed[deriv$speed &gt; STOPPED_SPEED])</code>. In addition, the function <code>TrajSpeedIntervals</code> allows you to determine the time intervals within the trajectory that satisfy a speed constraint, either slower than some speed, faster than a speed, or both. This may be useful, for example, when testing how often, or for how long, a flying insect hovers, or a running insect stops, i.e. when its speed drops below some threshold. The object returned by a call to <code>TrajSpeedIntervals</code> can be plotted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulate a flying bee</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">100</span>, <span class="dt">angularErrorSd =</span> <span class="fl">0.3</span>, <span class="dt">stepLength =</span> <span class="fl">0.001</span>)
<span class="co"># Smooth the trajectory</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">51</span>)

<span class="co"># Calculate hovering intervals</span>
intervals &lt;-<span class="st"> </span><span class="kw">TrajSpeedIntervals</span>(trj, <span class="dt">slowerThan =</span> <span class="dv">2</span>)
<span class="kw">print</span>(intervals)</code></pre></div>
<pre><code>#&gt;   startFrame startTime stopFrame  stopTime  duration
#&gt; 1         11 0.2337088        27 0.5488033 0.3150945
#&gt; 2         85 1.7073675        94 1.8866781 0.1793107</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot speed over time with hovering intervals highlighted</span>
<span class="kw">plot</span>(intervals)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Speed over time, hovering intervals (speed &lt; 2 m/s) highlighted." />
<p class="caption"><em>Speed over time, hovering intervals (speed &lt; 2 m/s) highlighted.</em></p>
</div>
</div>
<div id="analysing-straightness" class="section level3">
<h3>Analysing straightness</h3>
<div id="straightness-index" class="section level4">
<h4>Straightness index</h4>
<p>Various methods to measure the straightness, or conversely, tortuosity, of trajectories are available within <code>trajr</code>. The simplest is <span class="math inline">\(D/L\)</span>, where <span class="math inline">\(D\)</span> is the distance from the start to the end of the trajectory, and <span class="math inline">\(L\)</span> is the length of the trajectory. This straightness index is calculated by the function <code>TrajStraightness</code>, and is a number ranging from 0 to 1, where 1 indicates a straight line. Benhamou (2004) considers the straightness index to be a reliable measure of the efficiency of a directed walk, but inapplicable to random trajectories. Batschelet (1981) considers this straightness index to be an approximation of <em>r</em>, which is the length of the mean vector of turning angles after rediscretizing to a constant step length. <em>r</em> can be calculated by calling <code>Mod(TrajMeanVectorOfTurningAngles(trj))</code>, assuming <code>trj</code> is a Trajectory with constant step length.</p>
<p>Within this section, most of the figures show the appropriate statistic plotted for multiple randomly generated correlated random walks which vary in the standard deviations of angular errors, <span class="math inline">\(\sigma_{\Delta}\)</span> (higher values of <span class="math inline">\(\sigma_{\Delta}\)</span> produce more tortuous trajectories).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate some trajectories for use in examples</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
<span class="co"># Random magnitude of angular errors</span>
angularErrorSd &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)

<span class="co"># Generate some trajectories with varying angular errors</span>
trjs &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajGenerate</span>(<span class="dv">500</span>, <span class="dt">stepLength =</span> <span class="dv">2</span>, 
                                             <span class="dt">angularErrorSd =</span> angularErrorSd[i]))

<span class="co"># Rediscretize each trajectory to a range of step sizes</span>
stepSizes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>)
reds &lt;-<span class="st"> </span><span class="kw">lapply</span>(stepSizes, <span class="cf">function</span>(ss) <span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajRediscretize</span>(trjs[[i]], ss)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate straightness (D/L) for all of the rediscretized trajectories</span>
ds &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajStraightness</span>(rtrjs[[i]])))
<span class="co"># Calculate alternate straightness (r) for all of the rediscretized trajectories</span>
rs &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">Mod</span>(<span class="kw">TrajMeanVectorOfTurningAngles</span>(rtrjs[[i]]))))

<span class="co"># Plot both indices on the same graph</span>
<span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), rs,
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>,
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),
     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[Delta]), <span class="dt">ylab =</span> <span class="st">&quot;Straightness&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(ds, rs)))
<span class="kw">points</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), ds,
     <span class="dt">pch =</span> <span class="dv">3</span>, <span class="dt">cex =</span> .<span class="dv">8</span>,
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)))

<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(r)), <span class="st">&quot;D/L&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes)), 
       <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">16</span>, <span class="dv">16</span>), 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAmVBMVEUAAAAAACsAAFUAAP8AKysAK4AAVaoAZAArAAArACsrAFUrKysrK4ArVYArVaorgNRVAABVACtVAFVVKwBVVapVgIBVqqpVqtRVqv+AKwCAKyuAgFWAqoCAqv+A1P+qVQCqVSuqgICqgKqqqlWq1P+q///UgCvUgIDUqoDU/6rU////AAD/qlX/qoD/1ID/1Kr//6r//9T///+xGdGkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO2di3/juHHHtces6Usf67RNzk7a1bXJqe1KcW3+/39cRYIA8ZjB+0Vxfve5tUVSACR+PTMYgMBpIpESdGrdANK+RQCRkkQAkZJEAJGSRACRkkQAkZJEAJGSRACRkkQAkZJEAJGSlBmgE+kIigbo840V8NNvGEDR6JH2o2iALqdv7Jcb/8VWNOlRFQvQ55vA5vL1h7No0qMqFqCPl1f+6w1xYgTQEUQWiJSkhBhoNUEUAx1a8b2wjxfWC0PsDwF0DMUDFFT0onG8/zMM6sHrNW+tpLqqCNB41zSMo0LQdViIYhitMBFTO1IGgC5+vbBRSCJo5udO0P3HdVr/vfNzJ0ghitSv8lsgMMk9yQCN28Fh03WBaUZn/n2GaFp/kDpWZRdmAWgVM0ocIkEQgdSpagfRKj8AQduRK7dF0+rWSB2qJkDTjI7Kz0IQw0j+V2ZJ+DKZoJWqvA0mRag6QMYxqXPP/9VskgnQGmfzSFsE3aTqih8L24Jl77EwAKA1JlLs0mp7Jo2g7YLrVQqQ1FiJVFnRFujzDZ0IBBYHRNAT0jWbtWCzAaTmH2WAFJhI1ZUyoezJv2gGw8hxEBpRgsSbhFuTjksuDACIPFpFJcRAt9Or9by/C0MBUsMi/bDon+n88JeEUXn1EUSv/CAQmQDJr7gnU15vJoogKqvmAK1nGD9WgtRXMkFYgESxUXl1AtByFndkWhAt0kTbK+ksThCxlF9VAbJLAIRSJCR6+dMkd/ZXGR006Xhgm0gu1QfI5sdcnkxIZInkxPUmEUTr/BBBudUTQFsk5MeQBpBKEP+pR9fqeVKqugKInQ8haEIAEjIGQLTfSInqD6AQgti/WzzkkMwPEZRHdQHyY8MXoFVrKB3QMhFkU9I6WR1aoOUif35MbT18TPooGjEUrU4B8ujKo7JEREIaP0RQtHoFKF5STG2liNLVWfTIAMnpakAEUA51lIkGFeHKZH6szgxIVrOeGiHlr84BigqmbTlqQwY/ZJSC1DdAQd35Tb4maJE2Wd8kiEiyqWuAwvJBm7Yg2s2PKgAgdTQkuC2Prp4BiuVnmz4UDJDmwkSUtJ2MaM1Dq3+Aot7KqQnlRw2iAVtEBGnqGaC0fDSTOZPaRzo/BBCqrgFKyUcDindn0oGcDXoE9Q1QVsUHRMqB9Ze8bduvCCCbtMF6gROZIqEDARQRUWtSg+tMrdq5jgRQ2KQhSJIBIoCYDgXQpliU5P6YeuioOiZAeZyZ+C1Hk/aqQwIUEU5rUsLpQxN0ZIASGNIAOjBBhwQo5EkORCo/ByaoA4BKT1GEtE32iC1hW15vM0bZmrcjHRSgSVvMM7qUq+LM8rVuN9oLQHlHxRYNsiLLUPk54jjHTgDKMC5vKgNBGzbqb/ka2bsaA+RY4E69LE+zZOUxQeIXjaRDqDFA860b3TewFECe06ZtMnLTBJCnzqfT07L1N7bUZvcubFYqP6tkag7FTzxA806p59PTvOR44paXrYJophz4aGbnSPxEA7Rsunv78n1K33S3UTeeKwc/kNk5CEaxAC3bfrMNv1O3/c5yA7MqxiqZ/ByDoA4sUF9Kz1EvOkwonR4DSTvI40XvRhmSi4sIIKey9cJiVCqmVnKL4tmymJIOwk/rPFCkSvfqZYBibRHAzyMitUuAiuUVpYkeMj95OmqPaZQyAOS57XdGFQRI2j+Bv84QUK8/HpGg/BYI2/Y7p0x+iiYa0ztk/CcBFFl0bpn8lAyKpFfhJTz4MP1OAdJUerBVehVcBDZR6EFgigdo6cLjW+4+BEBmfyySIN+j+1N8IvG05g9vpw4SiaWnC0kvw4vB+HkIgpKGMpjaD2Xc4anAT66R+0U4QDvDKmkwlSl1MDVZpSLoFZ7EIBoRRtAWcWerqqgewAKVywqZFqc4QfzobhxcQgy0mqB2MRCjJn4pTrdMfvIRBAJ0VZSrqpKK74V9vLBeGGJ/ygPEsCnJj66MwxoTaGSuRwIoqOgCWsGpyE9mgOQwR3vOdT/87B+gckloQFKPPmu5Ky4rN3viZ8cACXLq8SMPteYkSAADRdCdk7RjgKqSoyizK9MXNtd2V+iboD0D1Ey5ATIXNhfUdO/NHgCgBoYoMz/yBgsEUKniMNUMooUy87NoQ8fiwrqDafcA1ezGyyqA0ArPpGJi7GeWvd4kEUBxkp1YxhFW1/n+PNruAWrlwjhB2QNqXF2mGPcPUJPevMBGm/BRRMqk/N4IegCAIBWHSuOnJEAcGAKoniq4NdmBFedHnpS/hdpd6CEBajNAXwgjyeRwgozOWEOeCKA0qTOmi1Sh8APur9DSqT0kQPV6ZpsHK+jKjKy0BlDTsOgxAarWM6sCkJDmy+TDBNBOVcGFSUKWYSSAdiz5oR/9lyqS54E0EAGUXdUy04vE6Gsjhgig3Ko4tjEZc0DqE0QA5VYLgGSOKieF2gPUeJno/Grgwho+UEYA5Vf9IJr9bELQwwPUbOZ9dTHvRQDlVZvpim0kDdrXq7QtQH67hSWo1YTXqbYjm7RpH9VqfXAL1A6guqH0ZBlqLSsYoHkLp4tl3YTgoi16EBem4VK3Mz8LBKg8SDBA568/3p+fpvNTrqIRzV/yWPabrjgsr79uYIK02UK4McpGFgjQvPzY7fSKrj0WXrRF+W9w00n28pHKjTDmK+Kd+nxODgXofIcHW4M+vGiLsn/NLaIewOBU52eWCgyYFrrqff00lBAX9vTx8vXHx0tpFzYr9/csxc0VQWpgcCBpvGwASbhoWCUaIyyIPn35/vmWxE97gKqaoi74UXDY5nkY02I1flIIiu/Gzz7u/fl0WnYtdBVdUzI/x8kicimmhh/YKOHwaBYpvr5ogBZ+fv6uLPiLF11VwoEdESAuLcxRTZB+YUI9sXmgZbNv1s1vvcwvql4I6iSc3n7Vr0ypJzYPNNudda3o5guNo+qDoEbxtWpZMEqSe/PReaAZrkvfFqgPghqkFJnsbMgPu6YoOg/08fLTb9Le346iG+nQAFm1dc4SCUrIA93YQuPoNR0A1MVsjg752fpiEEA+rk+ofR6orNrz002KaJOcX4T4CVkjtv10DlJtyZlEmJ+ALGMGgOrv2uxWD4anW12tXOQB6O7Dvv44I9vw2FVj12aXnKHPsQGzU5HDhd17Vpc5iI4iCCq6rpydrz5i63Z1+/Twfa6cEIDm7vmc3akynaOAXAD1sDRwZ32z6M48mgeaAbJOKOtp12ZdHgao+dLAXREUnw+yWqCzZTCsr12bdTlDoNazFvsCyAyrvXGyxUBiV0tAHe2ZGqOmSwOLV/XbgOiqE+RvkPBemGWmz9TXrs17kcpMR/wYJihgiCM2D7RzC9RGLmbWtfKqtEWTaYDgufjGoehEYge7NudR+w4912Kh1n/q166FQL7PcsAAOXtYUwe7NudRDykhZnYGRY0bhPFjHEdG45MSQEDR3aqHCR+S7emHIED+ACWmoIGiu1UXAK3E9A6QvwtD58kHaRcAdeHCODGDRFLrNoHyDaJTZwKZRXes9vxoe/9MnXXx7UISiZYUYlTRJEASJupi5d1aIECICzu5e2FBRZNMQZgAuyZ0ztLBZyQ29F9IqLwF09tl6um+BFugP7BBjCrLu7RUywgaBkjujgFX9efcrADtdT6Qr9r24TF+FILMEdjOCAIAOm+TUnc6I9FXjZNAoAOTO/T8iHG6I1ktUL6iO1UPSSBVJjdaCNQZP70H0aVvb2/8bLxAoLBhVhChZlzFD6YGFR2rZve3P7K4+UH6bq0I6nwwtdVt7Mq3SVlGZKCsYWzU+WBqo7vYxRArl9qjBxHqD6AeBlOL74Pgqrp+vZD0DhlKUJPW9T6YSi5Mti5WghrF0XAM9P7cyWAqBdGSdUGyi/pldWUCJEZSW/fC5m+k8D4IqDriR+7Zg9nFSRpAq9+4g+eBsGr78WCykOyiFF7Xb1PnALWJDHuKoRXBhODde1T5Ppx9PtApZWIZAVRJlgQRpsIArc963U6vKRmh/QLUqwvDtJATRFBhgHg3fn4+Pn7TuR0MpqLaFT/KREY/goq7MOa5bj/9ljCnbM8A7VIaQBhLeRO06PIus2YLRADtRxo/FmtULQZKyUl3D9DO/JSHvOeelQaI9cPuxidlWL4/gFRidhYpB6oxQLmL7kIqMTvrq6PCKGnqwrIX3YM0Yh4EIJwTW4eMAIqQTszD8JM4gpH2dmgw9duDPpmqE/MA/HgDhF+TCOCBLJCFmB2T5MuPLVRKIehQAJni26vWqq5Amb78INeVAYj7sMdyYaa4U9NvbCnnVhZUu5tSZ4JkW28YeSrj64/Lk9e8RMs1/QMkwurRPF6mwiKlrsJmC+nn9GeDcgfRE3sq4zbvlYGPpHrMW9wLQMbQULkOfkmA8PmK7Jh8VcbZZ+hg6vvvf1v+x7Su7rtrC4S4sDIAlX7IREBhpaMOQPNg6vx8vA2gad5Vde8ArcGOflO125zvlldxYXY6TBeWJjgGmsfgz99sLmzW+cv3vQO0yDQLuwRIeYJVPWRelW36NNKNPz/NUY6rE3Y5fXsAgEDHskeAmFR+is+zT8sDvT//jgAKqSpbSajUHruToGTArBPK3Pp8w6fd7wUgsNdeBqAKCgMo3UR1/Gx8PY1QL2zNELV7QD9SaorH0h2b/AhzVIfMSAxJQfe47Xea7rggFmgPIMn33Nqd9wDIbaHyrxPdw7bfadItjppirN+eIAHPzEMXDV7deY8gqvRg6qkX+bfbcFkjeqY/GTccTktLWcftIFxaDEAZ14nuxQz5t8OMeXYEkHHHIQTATDRMSqwL81kn2m/b7x0CZHFUvfMTBJD9jeK4o8bodaI9t/3eI0CWULlzfrxcGMhK9OhY7DrRvpvu7hKgPUujYDRsCIJKbEYoNoj23fZ7XwCBWZ/urY5NRttRUxOZUYQAen/+Nnsm677xh7FArri5c7z8AYoUANAyPjpvOWedkei57ffeAXLloYPC6gawmTVGBsuYoCB6fhx+eab5bHsw3m/b750D5BrICOrY5+zDAQWZA8Jw6+O665jA58L4CkHHzAMpLzwMkC8VWbNIZjlw4X71Jfg1CKBXvlb9IQFS5Q6BggxQOYCQ0lsBxMKfhOXJpr0DxG+G65YHhUD+xsp5BVR4NEBZXdgS+VzmHljigvW7BqhIzjnE2TlOm7ikuLC8QfTty3c2YT5xz549A1Rl1Ms2YOI0fP7FBcs2I984BOWBbkvX6v05yYHtBiDwe68BEFpDJEByAdGNmsSar9gZTcWnc+QtM1poO5B7FRCvRLbIgolH5br7Cny7RXysHh7tMA5XBciYlvP59suvaTv7BjUGEHob/TtXkS2y2ZnAIFotKNF6DihBzQEyJ3Z9vPzul7yVWhsDCP62kRQcXEJsk7I5Sa2pqe7XboL0YxUBAqYGosMg2RXqwvzBiL9VuYIsnZhUMtdl7+EzutoClLAKdUxjQKFuxKPUEEtVUHoLMrTHu1vfFiDrYFv+xqCCvq3yFiif0omJLqFpDOT/AGOexqDaD0ClFi6KtqJNe2F5HmD0bwyqlPkxCXc0/K2F3GWCH26aB3r/2Tl1NpdCAfJHqiZApQKuvQJUL4a2tAPutToBynEfuwFoLy6soXJboCw3sqkLs+WyA0QAXe8a5n+UozBA4mveTEHsNx+ZAbBdH1aUbZZcQDFHB4h9V9BDdrNTWxfoEBeL+y3uvYRAOEqZnVEmgMKoJoBmIS5s+SoBaibxLUuHgrN5Y58ABdpFAmjW1Tg+AzRuYtfKXy13YJsrCx1PaAiQzX8SQKBCABJRkQYQBIXiy8JGNLMCFB5SkQsLEtQOnQ9ZkAuD3JJqgqDjqBxnI7poma6mIBqQFSDg3LBeMbm+T9k+wcexd0FVK908W7VgoQWvRlUXoHY42V2YKTMqwhQ9KQw4D4db3i0peDWqtgCtK8mwEbH3f/xxTpyG7WgMIB+ACi21bFaNh+SRBVZQY4AWYN6fl1kdt6epH4Bk2QGKzuHaACo1appfPQA0P0g0v3jdI0Dxd9rmwsK5LISbsxldALQ8wfj55+8NAPKRDaAoX2MrznUazf9la4NaoevDVQMIXDGVAzP/vIdAHQKEzzBnygyQXba6irTB49N1YYGWeR33EKgrgBgy8FCrpPL8KENxBJAiGaB7CNQFQIP2s1gQ7St1BgA++lCC5I5cGFiD5MLmEGiXABXvPWsAwfc0DB7g6thsVhcAzUH0HAIdHSD4bilzASw2KKQeYEzG/+2KugBo7sbfnqYuABq3XWx46GzJSmd1HuDQhlz+iPXC7MMiflcHN5cpHqALTyFbd+uxl8kTid+WLFALgJCpZK7QWVYuC4R6J+V3b4BwrPsAaF6C6uNlNhspAImhjCUE4q8LPC3mB9D83Q4jNskMUQcAAbTYDKN2zuocXYoFiD0T+Pk27y6/54XGVUzkTnt1gDCbMSK/a+8FCgtxYgZ/aDNVxQLEnwm8O50HAmj+4oYRPoOqUhDtcaV2CX6REyB/c5Rmgab58fbdAgSuhDPyF/4TOvLK58553V/XfKT1t0n9KU57EhQfA63Y4LuDdw/QLNPOtAJnlc+dg+9vUAgz6uBUB0jsdfD5tleARMSjMJMNoCjX5nXrkF57GEHaz9jCGk9pXfZLWAC8Yess2FdguL9Nv+D99wDQ/hYom4A74K7N728fzRh5tkzqdcVmoLnaAnRbrNh5yQhEATSf1C74eIEsojUGsrYxWlEArWy4bRD0vqBs9KSCFKsMAKXkgZapiPNIRjaAbvAmnHuxQCsbEbdUyld7Xa79jFV+C6RO+1HK1FO721L478/L2tQXlkV8//nfn0U6ceFjPfHx8qcXlv8+n05f/vJlvuzr/7788fkkbT4F7vBRFyAsNVc0NRA2GbZfgNTi5DKNePV+uzlBDJO7L5vHNe44va7ujZ3hJz5e7r/ML+ZF9G+neUn91+0gL7Q1QPxOajUFOMwEp+Lrk3YI0PVqEjRbnuV+MxLWLYKWwTG+1cv9jDix/PL+/Mr2gjlzgL5N8uZ4lQEySuA3MNKFTd5GBH1vaCyUoniAgrf9hgBi5axBNJtbL/hgL+cz4sS6FdUrY+TGAXp17+FaLp1g5rLx/o0XQImhbWJQHKr4RGLwtt8IQNOyq8sC0Bo7vbKl7ySA+AnOyuWRAUqdZ41MGIouz67koYyATXcNfrjfWUm48TjGAIif6MYCSfcDdWGanLOrnSV4Ni17iValDqZOIdt+Y72wG7NAokwWA52lGOhVqvX+z7ofXjOA+P1Yw+Jx0M5i7/PNcqvLNAS2DSyvGEE1LZCp27Jl7+wEl0h46UrdQ+P353mKotYL4zHzcmDrhX1rAJByP4aAQNR7mESdrOPfsikbQMUz0Xm2/V6GMthzqTwPdL/9789SZkfkge4nNlbO99d/nZ/lmPNA2QFyfHv5AQqbfoqWIv7Rj3oNsJlleSi+F1Zw22/rhvWbQvYE1tth/358RjPnn2tcM/paFuw6/P6GAQR24BhWvh9JeZeHGg+mwnICtFzAskMhjZE0gr9aDmkXjNtv7k531Oi6dM7VGqUe0AKFGVWP64X2CRDr8YfskxAMUIhbwvKGlhrU8zYCA2KXXADJfxSu2rsEqID8AQrN410HfuPQd8RMz4iRaAdgH2NdGAHEJLdDCxUcFsj1DeYAKEOeb5RZAVBQKwAymkgQTQAxIRYIDjuDAJrsAIUaNLcsc+Xn/zaARnbtCLRhgGYUga8IIKaQGEj5Y0a/QXF8cFCSlR5rcRwVAZDyQtYAlGICZHwsoOZHm9K6DPECvbPIIFoHSH+bmKOBI5Td/izFgaNqkq1ZyMEd9aA1ytJ8rW79/INNaf18m+cGncydNMMA4kfNP0HgbQN/jRRUAyDFXgijI1ctuS8BvVkGUJ9Rtaq2AGWf0roOkpkZRr0d0g2wfXEuCySNkKJBdDI/WvdoKQ4AiJ9kUZDOfqgLA462B0ifjldgSuui2xdjJ0QLQLCg0NOMvaWi5M6zVlQqPzpBEwbQCAXRkNxBNHS0tQszJ3QWmdK6zC8CGyPbcb/PoHTHVKA0FzbiACEKmJ6oEWROjmUkrxfCcbOzbjdAjYNoaEpwiSmt4PCuDBD4SLMqyfBbXdisZYBLuckFAQLMojhkRMbJdZuNMY40BmgqMaUViKEVgOAnUhXxKNUSJ2wAiQ4PcJVFyjdheYvhODQXxozOBAOEkBLz+C3cU2sP0JR5Sis8vSTQhYUApMar2yvXXzkCEJQIUN9lBchWySY7QDjNbfNABj8lprRe4OlJJ+0PSGoHHA8gm6YCh8y/TKMKQ4YT3XwmnJaSWwsBhHlloBHr3PTBZn/9z3TRC8s4pfWCjNGDFgi+0bCpRsV7zoZxclsgI5dgjGOZfM4AXZXnE5gFGuYgGqoE1HWyPZ/WLUCGsk9pZehhjZE+/3V7aXyTyyxn9ufs9xSgzlogQBsiAiBtkrX5nqv+1sGs0NJXeBSAsk9pvbBgCcsD+d3ou3kf1/SgfltAd2dEO5tDwe4S8yHDFsavFgiKnwbRbKnU7Y2jyEZBlZnHlss3gBLtb2uAYBWb0moAhNzpgcdAXgBBCCrP8CDYyZgsfkixJ1KduAUS3b+5NuihIfihI+lT+2eEYO0ToJgprRoq8M2a1j/zcb3OAtCglmJqAH4T0qNeLfEdBpDF3oEGRr7+mADFTGkFHuwDXdhy3exeoNsCdN6woXEHQON41S3QGkTr9XJfI6SYGQk5qFuFPjeLubCtMX7qEqACYu0AR5CgvstwvxsLSNK91G6sCZBuyoDfNoEPqi52SH6HCRPgk3gdOkBXtbfGL+fPRKqly+USQKaCAVqkRBbaLefUCI9gmLKtOKhFkOUSm4wjVm8a0BSgBJD8BvNyDtzWfmh01lsEkA0gMwZSR9NE3DKzBd8DW38MjHBHGVTp9ytosxbBaLNT0ACoPJbDxz8IILtYO7TvHh6u0Aw7BJB8x/iXjwBkW1MBMg/sdmq5Z+l3zAKJ/p7ajiuWpRK0EUBeAtsxoL0o/nVeYYDkS9iXbzM06M0BYFjbggGEDz/YANLGYpeX3KgNUqQXA1EPicQyy/zelHwiAtAsexdcvWcIQHAHCSrNqXVIVjpyld7vBEhnYeS7x4gyVqB4S7mP0w2ob5tbD2UUW+Z32YNsI8hox/ZNOwDaJCX6pOzhvTN+1RLLxpgC/gGQS6wAwa6SF6ORwDf/kIhimcer/D4cIFfbH2xOtFjmly0/cxYzg+ItkKpt1Fx886ITL96kv9tj9o2elLa1Bng5rE1RLOH68QbpTYbLHncFkO6NCy7zq8+uDwQI1aj9zA8Q8ITQ5n6g4jlAkvuSmVFfaGO/czrTSHgp1/cEkBnPlVvmd51S5AJo6YuHhI8qQGqHTXASEYzKAE0qn1IdVoBWhodJAmhQxZou8yNuydXLApmfrCJAUH+n2DK/LPzZgiAEoICFC9cPMcl+QP7LlYoIBEi2HIMOkFLeCPX2OEBrGLZs1ym/TbNAHgANuiyfrDFAU6llfr0AYgq63VLfix/R/kbD+8QbxYD7UiZwm7MpZfFJTNfVtK6tsAAknn02/5B2YoGYCizz6+XCmLzvtMwGClBQifpbbBZoy3prJlO4sHGQyVkc2YYff/xRI1RkLRULJN6FYbWpaQxUcJlfryCayXm7oaxeIYDgmAwPovktXm7zyG/6NhtOKnorTf8bXl+rmJgWCDat8QAFr1SP98IKLPPr1Y1ncsY/doCu2QDaPNFVsXHS9EOoeNkCXdnFSnB3VcuIBgioekoAKHylekAFl/l1JRIDBAEkWwHjDREAXaU1D/gPs4ZRfbnVpgVPitGxAiS9TwWIv9qOwh2OWIDyrBNdcpnfi3sow1MOgLLoKqZJD6tLgpZ+BQG68kOjlkdQcs1uC7Se1RyVWlk+C+Ral3nyAwhWhWV+PTXqQSdXboDWUsEw3VErAJDOjFrBOKhxjFET/uHyAZTJAsGqsMxviGzzPfKKJ3LCsYWibwCgdb6uPg9SvwLNjJlHE2KgHCvVw6qwzG+IggbLkjTw+SOABbJju/TC/DKiRgkBFigjQCVXqi+gyHYg/epSAInB9qt5W91Jc582QRgGAGTq0BPKPFXPAvGi47D1aRN3YTKGxvtC1u4ggNyqDJD0yHtYrZ5tUhJXoGOsDFDCtt/1lNKOgrAE1mpvie99z+qO81sgy7bfDfUYAMWsC+UuuTOA1OIeAaA2Koet8/n5EBFApEYARQymNlQv7Xg4tR1Mrade2vFw6nIoo4B6acfDqfhgai+K+nZITpW2QKQHV+nBVNKDq+RgKukIigYoSA2sEVVZvUoCiKpMqpIAoiqTqiSAqMqkKgkgqjKpSgKIqkyqkgCiKpOqJICoyqQqCSCqMqlKGnsgJYkAIiWJACIliQAiJYkAIiWJACIliQAiJYkAIiWJACIliQAiJYkAIiWJACIliQAiJSk/QMq2k+oelKUk18KePHqyXp9F6y6bev11qqzzKZe1NMQTgPCnzA6Qslq8tnR8ISm1sD03ymvdZdOov06VVT7l59u8KRvHFPmUuQFS9qvQN68oI7WWkJXIE3Tb1rip8ymVKut8SmXzGuxT5gZIqVTfPqeM1FouFbzXtsumWX+VKit9SlYvszrYp8wOkLxnl76BVxmptZz/QfbbBbUBVOVTKlXW+5TLxm7zD+xT5gZI2TVQ30KwjJRaPl7m5/bPFb5b8V3W+ZRKlfU+pVhHA/uUjwbQeqimOWgAEPiyTJVyDF0DoOYujB3y2/onSU1dGKu4/Kfc1vGp5cKaB9HsUIVebu0gejIBKv4pL1ucVSuIbt2NXzd/rnk3a3XjDWaLf8qLtDlSrW5880Ti8hGrBtHVEolyL6zGp2Tb2IrK6yQSxbaTbHPdS5Ukv1Ll+RS2q1is1n1+631Kpcoan/LCliP78t32KWkwlaXyvmQAAAEqSURBVJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCiJQkAoiUJAKIlCQCKFqfvz4vz47XWWmuVxFA0Tp//dv0/m8/WjejsQigWK1Ldv1z63Y0FgEUK7ZYz8cf6qxr3q0IoFitAL0sq/T8d5XVzXsUARQrhg5bbG7F6IgigKJ1+/LL9Pk2L9g8/f0v9VaO70wEULz+519Pp3+a+fn8r88/HzUUIoAy6O/fp8tRs0EEUAb954/p418OGkYTQOn6v/+4//PrQcNoAihdbDncg4bRBBApSQQQKUkEEClJBBApSQQQKUn/D560kK6CBQLEAAAAAElFTkSuQmCC" alt="Two straightness indices (r, dots, and D/L, crosses) as a function of \sigma_{\Delta}, plotted for several different step sizes (linear axes)." />
<p class="caption"><em>Two straightness indices (r, dots, and D/L, crosses) as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>, plotted for several different step sizes (linear axes).</em></p>
</div>
</div>
<div id="sinuosity" class="section level4">
<h4>Sinuosity</h4>
<p>The sinuosity index defined by Benhamou (2004) may be an appropriate measure of the tortuosity of a random search path. Sinuosity is a function of the mean cosine of turning angles, and is a corrected form of the original sinuosity index defined by Bovet &amp; Benhamou (1988). The function <code>TrajSinuosity2</code> calculates the corrected form while <code>TrajSinuosity</code> calculates the original index. Sinuosity should be calculated for a trajectory with a constant step length, so trajectories may first require <a href="#resampling-trajectories">rediscretization</a>. In the absence of a biologically meaningful step size, rediscretizing to the mean step length of the trajectory will produce a trajectory with approximately the same shape and number of steps as the original.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate sinuosity for all of the rediscretized trajectories</span>
sins &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajSinuosity2</span>(rtrjs[[i]])))

<span class="co"># Plot sinuosity vs angular error</span>
<span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), sins,
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>,
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),
     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;Sinuosity&quot;</span>)

<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes), 
       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Sinuosity as a function of \sigma_{\Delta}, plotted for several different step sizes (linear axes)." />
<p class="caption"><em>Sinuosity as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>, plotted for several different step sizes (linear axes).</em></p>
</div>
</div>
<div id="emax" class="section level4">
<h4>E<sub>max</sub></h4>
<p><span class="math inline">\(E^{a}_{max}\)</span> is a dimensionless estimate of the maximum expected displacement of a trajectory. Larger <span class="math inline">\(E^{a}_{max}\)</span> values (approaching infinity) represent straighter paths (Cheung, Zhang, Stricker, &amp; Srinivasan, 2007). <span class="math inline">\(E^{b}_{max}\)</span> is <span class="math inline">\(E^{a}_{max}\)</span> multiplied by the mean step length, so gives the maximum possible displacement in spatial units. <code>TrajEmax</code> returns the value of <span class="math inline">\(E^{a}_{max}\)</span> for a trajectory, or <span class="math inline">\(E^{b}_{max}\)</span> if the argument <code>eMaxB</code> is <code>TRUE</code>. <code>TrajEmax</code> differentiates between random and directed walks; see <code>?TrajEmax</code> for details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate Emax for all of the rediscretized trajectories (from the previous example)</span>
emaxs &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajEmax</span>(rtrjs[[i]])))
emaxs[emaxs <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Avoid warnings when plotting on log axes</span>

<span class="co"># Plot Emax vs angular error on log axes</span>
<span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), emaxs,
     <span class="dt">log =</span> <span class="st">'xy'</span>,
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>, 
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),
     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="kw">expression</span>(E[max]))

<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), 
       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Emax as a function of \sigma_{\Delta} (logarithmic axes)." />
<p class="caption"><em>E<sub>max</sub> as a function of <span class="math inline">\(\sigma_{\Delta}\)</span> (logarithmic axes).</em></p>
</div>
</div>
<div id="fractal-dimension" class="section level4">
<h4>Fractal dimension</h4>
<p>Fractal dimension has been considered a promising measure of straightness or tortuosity, varying between 1 (straight line movement) and 2 (Brownian motion). However, several studies have found it inappropriate for use with animal trajectories, as animal trajectories are not fractal curves, and the fractal dimension of a non-fractal curve depends critically on the range of step sizes used to calculate it (Nams, 2006; Turchin, 1996). Nonetheless, fractal dimension continues to be used, and the <code>TrajFractalDimension</code> function, by default, calculates fractal dimension using the modified dividers method to account for truncation error (Nams, 2006). See <code>?TrajFractalDimension</code> and <code>?TrajFractalDimensionValues</code> for more information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use the same range of step sizes for all trajectories</span>
stepSizes &lt;-<span class="st"> </span><span class="kw">TrajLogSequence</span>(.<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">10</span>)

<span class="co"># Fractal dimension is a slow calculation, so just plot a subset </span>
<span class="co"># of trajectories from the previous example</span>
fn &lt;-<span class="st"> </span>n <span class="op">/</span><span class="st"> </span><span class="dv">4</span>
use &lt;-<span class="st"> </span><span class="kw">sample.int</span>(fn, <span class="dt">n =</span> <span class="kw">length</span>(angularErrorSd))
fangularErrorSd &lt;-<span class="st"> </span>angularErrorSd[use]

<span class="co"># Calculate fractal dimension for all of the rediscretized trajectories</span>
d &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="kw">sapply</span>(use, <span class="cf">function</span>(i) {
  <span class="kw">TrajFractalDimension</span>(rtrjs[[i]], stepSizes)
}))

<span class="co"># Plot fractal dimension vs angular error</span>
<span class="kw">plot</span>(<span class="kw">rep</span>(fangularErrorSd, <span class="dv">3</span>), d,
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>, 
     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, fn), <span class="kw">rep</span>(<span class="st">'blue'</span>, fn), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, fn)),
     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;Fractal dimension&quot;</span>)

<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), 
       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Fractal dimension as a function of \sigma_{\Delta}." />
<p class="caption"><em>Fractal dimension as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>.</em></p>
</div>
</div>
<div id="directional-change-dc-and-sddc" class="section level4">
<h4>Directional change (DC and SDDC)</h4>
<p>Directional change is defined as the change in direction over time, and has been used to assess locomotor mimicry in butterflies (Kitamura &amp; Imafuku, 2015). Directional change is defined for each pair of steps, so a trajectory (or a portion thereof) may be characterised by the mean (<code>DC</code>) and standard deviation (<code>SDDC</code>) of all directional changes. <code>DC</code> may be used as an index of nonlinearity, and <code>SDDC</code> as a measure of irregularity. The directional changes for a trajectory are calculated by the function <code>TrajDirectionalChange</code>, so <code>SD</code> may be calculated as <code>mean(TrajDirectionalChange(trj))</code>, and <code>SDDC</code> as <code>sd(TrajDirectionalChange(trj))</code>. Note that directional change cannot be calculated on rediscretized trajectories, as rediscretizing discards time information.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate DC and SDDC for all of the original trajectories (from above)</span>
dcs &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">mean</span>(<span class="kw">TrajDirectionalChange</span>(trjs[[i]])))
sddcs &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">sd</span>(<span class="kw">TrajDirectionalChange</span>(trjs[[i]])))

<span class="co"># Plot DC vs angular error</span>
<span class="kw">plot</span>(angularErrorSd, dcs,
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,
     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;DC&quot;</span>)
<span class="kw">points</span>(angularErrorSd, sddcs, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> .<span class="dv">8</span>, <span class="dt">col =</span> <span class="st">'red'</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;DC&quot;</span>, <span class="st">&quot;SDDC&quot;</span>), 
       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="DC and SDDC as a function of \sigma_{\Delta}." />
<p class="caption"><em>DC and SDDC as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>.</em></p>
</div>
</div>
<div id="direction-autocorrelation" class="section level4">
<h4>Direction autocorrelation</h4>
<p>The direction autocorrelation function was devised to detect and quantify regularities within trajectories, in the context of locomotor mimicry by ant-mimics (Shamble, Hoy, Cohen, &amp; Beatus, 2017). It detects wave-like periodicities, and provides an indication of their wavelength and amplitude, so can be used to detect, for example, the winding movements of trail-following ants. The function <span class="math inline">\(C(\Delta s)\)</span> is applied to a rediscretized trajectory, and calculates the differences in step angles at all steps separated by <span class="math inline">\(\Delta\)</span>, for a range of <span class="math inline">\(\Delta s\)</span>. The position of the first local minimum in <span class="math inline">\(C(\Delta s)\)</span> (i.e. the 2-dimensional position <span class="math inline">\((\Delta s, c(\Delta s))\)</span>) may be used to characterise the periodicity within a trajectory.</p>
<p>The function is calculated by <code>TrajDirectionAutocorrelations</code>, and the result may be plotted. The position of the first local minimum (or maximum) is calculated by <code>TrajDAFindFirstMinimum</code> (or <code>TrajDAFindFirstMaximum</code>). Some trajectories will not have a first local minimum (or maximum), which indicates that they do not contain regular changes in direction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">1000</span>)
corr &lt;-<span class="st"> </span><span class="kw">TrajDirectionAutocorrelations</span>(trj)
<span class="kw">plot</span>(corr)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Direction autocorrelation of a random trajectory with first local minimum indicated." />
<p class="caption"><em>Direction autocorrelation of a random trajectory with first local minimum indicated.</em></p>
</div>
</div>
</div>
</div>
<div id="working-with-multiple-trajectories" class="section level2">
<h2>Working with multiple trajectories</h2>
<div id="building-multiple-trajectories" class="section level3">
<h3>Building multiple trajectories</h3>
<p>As trajectory studies are likely to involve multiple trajectories per individual, per species, or trajectories for multiple species, <code>trajr</code> provides some functions to simplify the manipulation of multiple trajectories. <code>TrajsBuild</code> assumes that you have a set of trajectory files (such as CSV files), each of which may have a scale and a frames-per-second value. The function reads each of the files specified in a list of file names, optionally using a custom function, then passes the result to <code>TrajFromCoords</code>, which assumes that the first column is <code>x</code>, the second is <code>y</code>, and there is no time column. If these assumptions are incorrect, the <code>csvStruct</code> argument can be specified to identify the <code>x</code>, <code>y</code> and <code>time</code> columns (see the example below). <code>TrajsBuild</code> optionally scales the trajectories with the specified scale (by calling <code>TrajScale</code>), and optionally smooths them with the specified smoothing parameters (by calling <code>TrajSmoothSG</code>). The value returned is a list of <code>Trajectory</code> objects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tracks &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">rbind</span>(
  <span class="kw">c</span>(<span class="st">&quot;3527.csv&quot;</span>, <span class="st">&quot;Zodariid2 sp1&quot;</span>,     <span class="st">&quot;spider&quot;</span>,       <span class="st">&quot;red&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3530.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3534.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3537.csv&quot;</span>, <span class="st">&quot;M. erythrocephala&quot;</span>, <span class="st">&quot;mimic spider&quot;</span>, <span class="st">&quot;blue&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3542.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3543.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),
  <span class="kw">c</span>(<span class="st">&quot;3548.csv&quot;</span>, <span class="st">&quot;Crematogaster sp1&quot;</span>, <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>)
), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">colnames</span>(tracks) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;category&quot;</span>, <span class="st">&quot;col&quot;</span>)
<span class="co"># If your list is read from a CSV file which contains empty lines, </span>
<span class="co"># remove them like this:</span>
tracks &lt;-<span class="st"> </span><span class="kw">na.omit</span>(tracks)
<span class="co"># Order of columns in the CSV files is unknown so identify them by name</span>
csvStruct &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">time =</span> <span class="st">&quot;Time&quot;</span>)
trjs &lt;-<span class="st"> </span><span class="kw">TrajsBuild</span>(tracks<span class="op">$</span>filename, <span class="dt">scale =</span> .<span class="dv">220</span> <span class="op">/</span><span class="st"> </span><span class="dv">720</span>, 
                   <span class="dt">spatialUnits =</span> <span class="st">&quot;m&quot;</span>, <span class="dt">timeUnits =</span> <span class="st">&quot;s&quot;</span>, 
                   <span class="dt">csvStruct =</span> csvStruct, <span class="dt">rootDir =</span> <span class="st">&quot;..&quot;</span>)</code></pre></div>
</div>
<div id="characterising-multiple-trajectories" class="section level3">
<h3>Characterising multiple trajectories</h3>
<p><code>TrajsMergeStats</code> simplifies the construction of a data frame of values, with one row per trajectory. To use it, you need a list of trajectories (which you will probably obtain from a call to <code>TrajsBuild</code>), and a function which calculates statistics for a single trajectory. The following example demonstrates how you might write and use such a function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define a function which calculates some statistics</span>
<span class="co"># of interest for a single trajectory</span>
characteriseTrajectory &lt;-<span class="st"> </span><span class="cf">function</span>(trj) {
  <span class="co"># Measures of speed</span>
  derivs &lt;-<span class="st"> </span><span class="kw">TrajDerivatives</span>(trj)
  mean_speed &lt;-<span class="st"> </span><span class="kw">mean</span>(derivs<span class="op">$</span>speed)
  sd_speed &lt;-<span class="st"> </span><span class="kw">sd</span>(derivs<span class="op">$</span>speed)

  <span class="co"># Measures of straightness</span>
  sinuosity &lt;-<span class="st"> </span><span class="kw">TrajSinuosity</span>(trj)
  resampled &lt;-<span class="st"> </span><span class="kw">TrajRediscretize</span>(trj, .<span class="dv">001</span>)
  Emax &lt;-<span class="st"> </span><span class="kw">TrajEmax</span>(resampled)

  <span class="co"># Periodicity</span>
  corr &lt;-<span class="st"> </span><span class="kw">TrajDirectionAutocorrelations</span>(resampled, <span class="dv">60</span>)
  first_min &lt;-<span class="st"> </span><span class="kw">TrajDAFindFirstMinimum</span>(corr)

  <span class="co"># Return a list with all of the statistics for this trajectory</span>
  <span class="kw">list</span>(<span class="dt">mean_speed =</span> mean_speed,
       <span class="dt">sd_speed =</span> sd_speed,
       <span class="dt">sinuosity =</span> sinuosity,
       <span class="dt">Emax =</span> Emax,
       <span class="dt">min_deltaS =</span> first_min[<span class="dv">1</span>],
       <span class="dt">min_C =</span> first_min[<span class="dv">2</span>]
  )
}

<span class="co"># Calculate all stats for trajectories in the list</span>
<span class="co"># which was built in the previous example</span>
stats &lt;-<span class="st"> </span><span class="kw">TrajsMergeStats</span>(trjs, characteriseTrajectory)
<span class="kw">print</span>(stats)</code></pre></div>
<pre><code>#&gt;         mean_speed    sd_speed  sinuosity       Emax min_deltaS
#&gt; deltaS 0.061296301 0.009069424  0.9833243 3180.72321         33
#&gt; 2      0.010573501 0.005718966 20.1799859  100.43632         50
#&gt; 3      0.014175447 0.005206138 10.5781944  692.21342         NA
#&gt; 4      0.006245555 0.003005911  6.3442130   67.52479          7
#&gt; 5      0.005344287 0.007936181 60.5565802   14.90601         NA
#&gt; 6      0.019378799 0.005363627  3.3069095   74.33277         35
#&gt; 7      0.014796829 0.002573456  2.4142475  112.93798         NA
#&gt;              min_C
#&gt; deltaS 0.899013229
#&gt; 2      0.303049396
#&gt; 3               NA
#&gt; 4      0.930992488
#&gt; 5               NA
#&gt; 6      0.002917922
#&gt; 7               NA</code></pre>
</div>
<div id="pca-analysis-of-multiple-trajectories" class="section level3">
<h3>PCA analysis of multiple trajectories</h3>
<p>Principal components analysis (PCA) is a commonly used statistical technique which can be used to visualise similarities and differences between groups of trajectories. In R, the function <code>prcomp</code> is usually used to perform a PCA. <code>Prcomp</code> will not process data containing <code>NA</code>s (in R, the value <code>NA</code> is used to indicate a ‘<code>N</code>ot <code>A</code>vailable’, or missing, value). However, <code>NA</code>s can be potentially informative, especially when using the first local minimum of the direction autocorrelation function - in this case, an <code>NA</code> indicates that there was no periodicity detected in the trajectory. To avoid discarding this information, <code>Trajr</code> provides a utility function, <code>TrajsStatsReplaceNAs</code>. It is used to replace <code>NA</code> values with some other value, and optionally adds an additional column to the data which flags trajectories which originally contained <code>NA</code> values. It operates on a single column at a time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#---</span>
<span class="co"># Custom PCA plotting function</span>
customPcaPlot &lt;-<span class="st"> </span><span class="cf">function</span>(x, xlabs, xcols, <span class="dt">choices =</span> 1L<span class="op">:</span>2L, <span class="dt">ycol =</span> <span class="st">&quot;#ff2222aa&quot;</span>, ...) {
  <span class="co"># Draw points</span>
  pts &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(x<span class="op">$</span>x[, choices]))
  <span class="kw">plot</span>(pts, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, 
       <span class="dt">xlim =</span> <span class="kw">extendrange</span>(pts[, 1L]), <span class="dt">ylim =</span> <span class="kw">extendrange</span>(pts[, 2L]), 
       <span class="dt">asp =</span> <span class="dv">1</span>,
       <span class="dt">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;PC2&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> xcols, ...)
  <span class="kw">text</span>(pts, <span class="dt">labels =</span> xlabs, <span class="dt">pos =</span> <span class="dv">1</span>, ...)
  
  <span class="co"># Draw arrows</span>
  axs &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(x<span class="op">$</span>rotation[, choices])) <span class="op">*</span><span class="st"> </span><span class="fl">3.5</span>
  <span class="kw">text</span>(axs, <span class="dt">labels =</span> <span class="kw">dimnames</span>(axs)[[1L]], <span class="dt">col =</span> ycol, ...)
  <span class="kw">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, axs[, 1L] <span class="op">*</span><span class="st"> </span>.<span class="dv">8</span>, axs[, 2L] <span class="op">*</span><span class="st"> </span>.<span class="dv">8</span>, <span class="dt">length =</span> .<span class="dv">1</span>, <span class="dt">col =</span> ycol)
}
<span class="co"># ---</span>

<span class="co"># Here we are operating on the statistics from the previous example</span>

<span class="co"># Get rid of NAs in stats because prcomp can't handle them.</span>
<span class="co"># First fix min_deltaS, and add an extra column which flags non-periodic trajectories</span>
pcaStats &lt;-<span class="st"> </span><span class="kw">TrajsStatsReplaceNAs</span>(stats, <span class="st">&quot;min_deltaS&quot;</span>, 
                                 <span class="dt">replacementValue =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(stats<span class="op">$</span>min_deltaS, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
                                 <span class="dt">flagColumn =</span> <span class="st">&quot;no_first_min&quot;</span>)
<span class="co"># Also get rid of NAs in min_C - no need to add another column since it would duplicate no_first_min</span>
pcaStats &lt;-<span class="st"> </span><span class="kw">TrajsStatsReplaceNAs</span>(pcaStats, <span class="st">&quot;min_C&quot;</span>,
                                 <span class="dt">replacementValue =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(stats<span class="op">$</span>min_C, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))
<span class="co"># Perform the PCA</span>
PCA &lt;-<span class="st"> </span><span class="kw">prcomp</span>(pcaStats, <span class="dt">scale. =</span> <span class="ot">TRUE</span>)
<span class="co"># Plot it using custom plotting function. Could just call biplot instead</span>
<span class="kw">customPcaPlot</span>(PCA, tracks<span class="op">$</span>category, tracks<span class="op">$</span>col, <span class="dt">cex =</span> .<span class="dv">8</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Spider&quot;</span>, <span class="st">&quot;Mimic&quot;</span>, <span class="st">&quot;Ant&quot;</span>), <span class="dt">pch =</span> <span class="dv">16</span>, 
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">'red'</span>, <span class="st">'blue'</span>, <span class="st">'black'</span>), <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, .<span class="dv">02</span>))</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="PCA of trajectory characterisations." />
<p class="caption"><em>PCA of trajectory characterisations.</em></p>
</div>
<p>The plot above shows that the trajectory of the non-mimetic spider (red dot) seems quite different from the trajectories of ant mimicking bugs, ant-mimicking spiders (blue dots) and ants (black dots). The arrows indicate the importance and direction of the parameters that separate the trajectories. From the plot, it seems that the non-mimetic spider varies mainly in speed, (it is faster and more variable) and E<sub>max</sub> (it walks in a straighter path). While these trajectories have been digitised from videos of walking animals, clearly this example does not contain enough data to be meaningful.</p>
</div>
<div id="other-operations" class="section level3">
<h3>Other operations</h3>
<p>The function <code>TrajsStepLengths</code> returns a vector containing all of the step lengths in a list of trajectories.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">TrajsStepLengths</span>(trjs))</code></pre></div>
<pre><code>#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#&gt; 1.000e-10 7.813e-05 2.266e-04 2.266e-04 3.243e-04 1.550e-03</code></pre>
<p><code>TrajConvertTime</code> is a convenience function that converts a delimited time string to a numeric value. This may be useful if your data contains times which are formatted as strings with millisecond accuracy. In general, the base R function <code>strptime</code> should be used to convert strings to times, but it does not handle milliseconds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="st">&quot;0:00:00:029&quot;</span>, <span class="st">&quot;0:01:00:216&quot;</span>, <span class="st">&quot;0:02:01:062&quot;</span>, <span class="st">&quot;1:00:02:195&quot;</span>, <span class="st">&quot;1:06:03:949&quot;</span>, <span class="st">&quot;1:42:04:087&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
t<span class="op">$</span>seconds &lt;-<span class="st"> </span><span class="kw">TrajConvertTime</span>(t<span class="op">$</span>time)
t</code></pre></div>
<pre><code>#&gt;          time  seconds
#&gt; 1 0:00:00:029    0.029
#&gt; 2 0:01:00:216   60.216
#&gt; 3 0:02:01:062  121.062
#&gt; 4 1:00:02:195 3602.195
#&gt; 5 1:06:03:949 3963.949
#&gt; 6 1:42:04:087 6124.087</code></pre>
</div>
</div>
<div id="random-trajectory-generation" class="section level2">
<h2>Random trajectory generation</h2>
<p><code>Trajr</code> allows you to generate random trajectories with the <code>TrajGenerate</code> function. Random trajectories may be used in simulation studies, or simply for experimenting with trajectory analysis, and it has been used to generate the majority of trajectories in this document. By default, <code>TrajGenerate</code> returns a correlated random walk, however, by specifying different arguments, a variety of trajectory types can be created.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correlated random walk</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">200</span>)
<span class="co"># Plot it</span>
<span class="kw">plot</span>(trj)
<span class="kw">mtext</span>(<span class="st">&quot;a)&quot;</span>, <span class="dv">3</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="dt">adj =</span> .<span class="dv">05</span>)

<span class="co"># Directed walk</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">random =</span> <span class="ot">FALSE</span>)
<span class="kw">plot</span>(trj)
<span class="kw">mtext</span>(<span class="st">&quot;b)&quot;</span>, <span class="dv">3</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="dt">adj =</span> .<span class="dv">05</span>)

<span class="co"># Brownian motion</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">angularErrorDist =</span> <span class="cf">function</span>(n) stats<span class="op">::</span><span class="kw">runif</span>(n, <span class="op">-</span>pi, pi))
<span class="kw">plot</span>(trj)
<span class="kw">mtext</span>(<span class="st">&quot;c)&quot;</span>, <span class="dv">3</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="dt">adj =</span> .<span class="dv">05</span>)

<span class="co"># Levy walk - path lengths follow a cauchy distribution</span>
trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">linearErrorDist =</span> stats<span class="op">::</span>rcauchy)
<span class="kw">plot</span>(trj)
<span class="kw">mtext</span>(<span class="st">&quot;d)&quot;</span>, <span class="dv">3</span>, <span class="op">-</span><span class="fl">1.3</span>, <span class="dt">adj =</span> .<span class="dv">05</span>)</code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt="Some generated trajectories. a) correlated walk, b) directed walk, c) brownian motion, d) Levy walk." />
<p class="caption"><em>Some generated trajectories. a) correlated walk, b) directed walk, c) brownian motion, d) Levy walk.</em></p>
</div>
</div>
<div id="performance" class="section level2">
<h2>Performance</h2>
<p>Processing time can be a problem when operating on large numbers of large trajectories.</p>
<ul>
<li>Use an appropriate step length for <em>rediscretization</em>. Too small a step length will result in trajectories with an excessive number of steps and will take a long time to process.</li>
<li>Some steps, such as calculating directional autocorrelations, may be amenable to <a href="http://en.wikipedia.org/wiki/Memoization">memoisation</a>.</li>
</ul>
</div>
<div id="and-finally" class="section level2">
<h2>And finally…</h2>
<p><code>Trajr</code> is open source, with the source available on <a href="https://github.com/JimMcL/trajr">Github</a>. If you have any problems or suggestions, email <a href="mailto:jim_mclean@optusnet.com.au">jim_mclean@optusnet.com.au</a>.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Batschelet, E. (1981). Circular statistics in biology. ACADEMIC PRESS, 111 FIFTH AVE., NEW YORK, NY 10003, 1981, 388.</p>
<p>Benhamou, S. (2004). How to reliably estimate the tortuosity of an animal’s path. Journal of Theoretical Biology, 229(2), 209-220. </p>
<p>Benhamou, S. (2006). Detecting an orientation component in animal paths when the preferred direction is individual-dependent. Ecology, 87(2), 518-528. </p>
<p>Bovet, P., &amp; Benhamou, S. (1988). Spatial analysis of animals’ movements using a correlated random walk model. Journal of Theoretical Biology, 131(4), 419-433. </p>
<p>Cheung, A., Zhang, S., Stricker, C., &amp; Srinivasan, M. V. (2007). Animal navigation: the difficulty of moving in a straight line. Biological Cybernetics, 97(1), 47-61. </p>
<p>Kitamura, T., &amp; Imafuku, M. (2015). Behavioural mimicry in flight path of Batesian intraspecific polymorphic butterfly Papilio polytes. Proceedings of the Royal Society B: Biological Sciences, 282(1809). </p>
<p>Nams, V. O. (2006). Improving Accuracy and Precision in Estimating Fractal Dimension of Animal movement paths. Acta Biotheoretica, 54(1), 1-11. </p>
<p>Shamble, P. S., Hoy, R. R., Cohen, I., &amp; Beatus, T. (2017). Walking like an ant: a quantitative and experimental approach to understanding locomotor mimicry in the jumping spider Myrmarachne formicaria. Proceedings of the Royal Society B: Biological Sciences, 284(1858). </p>
<p>Turchin, P. (1996). Fractal Analyses of Animal Movement: A Critique. Ecology, 77(7), 2086-2090. </p>
<p>Turchin, P. (1998). Quantitative analysis of movement. Sunderland (Mass.): Sinauer assoc.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
