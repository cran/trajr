<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jim McLean" />

<meta name="date" content="2018-01-05" />

<title>Animal trajectory analysis with trajr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Animal trajectory analysis with trajr</h1>
<h4 class="author"><em>Jim McLean</em></h4>
<h4 class="date"><em>2018-01-05</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#installation-and-setup">Installation and setup</a></li>
</ul></li>
<li><a href="#trajectories-in-trajr">Trajectories in <code>trajr</code></a><ul>
<li><a href="#creating-trajectories">Creating Trajectories</a></li>
<li><a href="#scaling-trajectories">Scaling Trajectories</a></li>
<li><a href="#smoothing-trajectories">Smoothing trajectories</a></li>
<li><a href="#resampling-trajectories">Resampling trajectories</a></li>
<li><a href="#other-trajectory-operations">Other trajectory operations</a></li>
</ul></li>
<li><a href="#trajectory-analysis">Trajectory analysis</a><ul>
<li><a href="#analysing-speed">Analysing speed</a></li>
<li><a href="#analysing-straightness">Analysing straightness</a><ul>
<li><a href="#straightness-index">Straightness index</a></li>
<li><a href="#sinuosity">Sinuosity</a></li>
<li><a href="#emax">E<sub>max</sub></a></li>
<li><a href="#fractal-dimension">Fractal dimension</a></li>
<li><a href="#directional-change-dc-and-sddc">Directional change (DC and SDDC)</a></li>
<li><a href="#direction-autocorrelation">Direction autocorrelation</a></li>
</ul></li>
</ul></li>
<li><a href="#working-with-multiple-trajectories">Working with multiple trajectories</a><ul>
<li><a href="#building-multiple-trajectories">Building multiple trajectories</a></li>
<li><a href="#characterising-multiple-trajectories">Characterising multiple trajectories</a></li>
<li><a href="#pca-analysis-of-multiple-trajectories">PCA analysis of multiple trajectories</a></li>
<li><a href="#other-operations">Other operations</a></li>
</ul></li>
<li><a href="#random-trajectory-generation">Random trajectory generation</a></li>
<li><a href="#and-finally">And finally…</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<section id="introduction" class="level2">
<h2>Introduction</h2>
<p>The <code>trajr</code> R package is a toolkit for calculating parameters and statistical analysis of the trajectories of moving animals. Trajectory analysis is applicable in fields as diverse as optimal foraging theory, studies of migration, and behavioural mimicry (verifying similarity in locomotion). A <em>trajectory</em> is simply a record of the path followed by a moving animal. <code>Trajr</code> operates on trajectories in the form of a series of locations (as x, y coordinates) with times. Trajectories may be obtained by any method which provides this information, including manual tracking, radio telemetry, GPS tracking, and motion tracking from videos.</p>
<p>The goal of this package (and this document) is to aid biological researchers, who may not have extensive experience with R, to analyse trajectories without being handicapped by a limited knowledge of R or programming. However, a basic understanding of R is required.</p>
<p>Within this document, the plots are generated by running the code examples immediately before them. For that reason, most code examples start with a call to <code>TrajGenerate</code>, which generates a random trajectory to be plotted. These calls would not occur in an analysis of real animal trajectories.</p>
<section id="installation-and-setup" class="level3">
<h3>Installation and setup</h3>
<p>Before using any R package, it is first necessary to install and load it. To install the latest released version of <code>trajr</code>, simply run:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;trajr&quot;</span>)</a></code></pre></div>
<p>To install the latest development version, which is available on <a href="https://github.com/JimMcL/trajr">GitHub</a>, run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;JimMcL/trajr&quot;</span>)</a></code></pre></div>
<p>Once the package has been installed, you must load it, then it’s ready for use:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;trajr&quot;</span>)</a></code></pre></div>
<p>Packages only need to be installed once, but they must be loaded in every session before they can be used.</p>
<p>Once the <code>trajr</code> package has been installed and loaded, you have access to the set of R functions it provides. All <code>trajr</code> functions (other than the generic functions <code>plot</code>, <code>lines</code> and <code>points</code>) start with the prefix <code>Traj</code>. Several of the functions provided by <code>trajr</code> do not provide additional analytic functionality, rather they make it easier to work with multiple trajectories. These convenience functions are prefixed with <code>Trajs</code>.</p>
</section>
</section>
<section id="trajectories-in-trajr" class="level2">
<h2>Trajectories in <code>trajr</code></h2>
<p><code>Trajr</code> works with trajectories, where a trajectory is a simplification of a real path travelled by an animal, and is a set of 2-dimensional spatial coordinates with a third temporal dimension. A trajectory can also be thought of as a series of steps, each comprised of a length (L<sub>i</sub>), a turning angle (<span class="math inline">\(\Delta\)</span><sub>i</sub>), and a time. Trajectories have been modelled in various ways; <code>trajr</code> works with two models: <em>correlated random walks</em> in which the angle of each step is the angle of the previous step ± some error; and <em>directed walks</em>, or compass-based navigation, in which the angular errors at each step are added to the “ideal” or compass direction. <code>Trajr</code> generally assumes random walks, but provides some support for directed walks.</p>
<figure>
<img src="data:image/png;base64,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" alt="A random walk with 5 steps" /><figcaption><em>A random walk with 5 steps</em></figcaption>
</figure>
<figure>
<img src="data:image/png;base64,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" alt="A directed walk with 5 steps" /><figcaption><em>A directed walk with 5 steps</em></figcaption>
</figure>
<p>Within <code>trajr</code>, trajectories are represented by R objects with class <code>Trajectory</code>. The <code>TrajFromCoords</code> function is used to create a <code>Trajectory</code> object from a set of x-y coordinates, with optional times.</p>
<!-- NOTE the echo=-1 removes the first line of code from the output, as I want it to run to make the plot look pretty, but it's not relevant to a reader -->
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Define x, y, and time coordinates</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">coords &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="dv">4</span>), </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                     <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                     <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co"># Create a trajectory from the coordinates</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># Plot it</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">plot</span>(trj)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Trajectory created from coordinates" /><figcaption><em>Trajectory created from coordinates</em></figcaption>
</figure>
<section id="creating-trajectories" class="level3">
<h3>Creating Trajectories</h3>
<p>In practice, trajectory coordinates are typically read from a data file such as a CSV file, and then passed in to the <code>TrajFromCoords</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;mycoords.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords)</a></code></pre></div>
<p><code>TrajFromCoords</code> assumes that the first column in <code>coords</code> contains x values, the second contains y values, and the third contains time values. The help page for <code>TrajFromCoords</code> describes how to alter these defaults - run <code>?TrajFromCoords</code> to access the help page. Many functions (including <code>TrajFromCoords</code>) contain code examples as part of their help information. You can also display and run an example by calling the <code>example</code> function: i.e. <code>example(&quot;TrajFromCoords&quot;)</code>.</p>
</section>
<section id="scaling-trajectories" class="level3">
<h3>Scaling Trajectories</h3>
<p>Trajectories may need to be scaled before analysis. For instance, when a trajectory is digitised from video, the spatial units will be pixels, and require conversion to more meaningful units such as metres. Trajectories are scaled by calling <code>TrajScale</code>, specifying the scale factor and the abbreviation of the transformed units. In the case of a trajectory digitised from a video, you can calculate scale as <span class="math inline">\(width^{m}/width^{p}\)</span>, where <span class="math inline">\(width^{m}\)</span> is the width of an object in metres, and <span class="math inline">\(width^{p}\)</span> is the width of the same object in pixels, as measured from the video.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Example 1</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;H.pahangensis_096xypts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">trj &lt;-<span class="st"> </span><span class="kw">TrajFromCoords</span>(coords, <span class="dt">spatialUnits =</span> <span class="st">&quot;pixels&quot;</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># A 10 mm (= .01 m) object had length 47 pixels in the video, scale to metres</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">trj &lt;-<span class="st"> </span><span class="kw">TrajScale</span>(trj, <span class="fl">.01</span> <span class="op">/</span><span class="st"> </span><span class="dv">47</span>, <span class="st">&quot;m&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># Example 2</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">coords &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;A.argentifasciata_C0139xypts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co"># In this video, a 20 cm (= .2 m) object had length 1800 pixels, scale to metres</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">trj &lt;-<span class="st"> </span><span class="kw">TrajScale</span>(trj, <span class="fl">.2</span> <span class="op">/</span><span class="st"> </span><span class="dv">1800</span>, <span class="st">&quot;m&quot;</span>)</a></code></pre></div>
</section>
<section id="smoothing-trajectories" class="level3">
<h3>Smoothing trajectories</h3>
<p>Many trajectories will suffer from noise which will bias the results of some analyses. The <code>TrajSmoothSG</code> function reduces high frequency noise while preserving the shape of the trajectory, by applying a Savitzky-Golay smoothing filter. It requires two arguments (in addition to the trajectory), <code>n</code>, the filter order, and <code>m</code>, the filter length (which must be odd). Refer to the help for the function <code>sgolayfilt</code> (run <code>?signal::sgolayfilt</code>) for details of the filter function.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">200</span>, <span class="dt">random =</span> <span class="ot">TRUE</span>, <span class="dt">angularErrorSd =</span> <span class="fl">.25</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># Plot original trajectory</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="kw">plot</span>(trj, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co"># Create a smoothed trajectory, filter order 3, length 31</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">smoothed &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dt">p =</span> <span class="dv">3</span>, <span class="dt">n =</span> <span class="dv">31</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co"># Plot it in slightly transparent red</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw">lines</span>(smoothed, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Smoothed&quot;</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Effect of smoothing a trajectory" /><figcaption><em>Effect of smoothing a trajectory</em></figcaption>
</figure>
</section>
<section id="resampling-trajectories" class="level3">
<h3>Resampling trajectories</h3>
<p>Some functions require a <code>Trajectory</code> with a fixed step length. The process of resampling a trajectory to a fixed step length is called <em>rediscretization</em>. The function <code>TrajRediscretize</code> implements trajectory resampling using the algorithm described by Bovet &amp; Benhamou (1988). There are no clear guidelines for choosing a suitable step length for rediscretization: too small a step length leads to oversampling, leading to high autocorrelation between steps and high variability; too large a step length results in undersampling and loss of information. See Turchin (1998) section 5.2.2 for a discussion.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">10</span>, <span class="dt">stepLength =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co"># Plot original trajectory with dots at trajectory coordinates</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="kw">plot</span>(trj, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">points</span>(trj, <span class="dt">draw.start.pt =</span> <span class="ot">FALSE</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co"># Resample to step length 1</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">resampled &lt;-<span class="st"> </span><span class="kw">TrajRediscretize</span>(trj, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co"># Plot rediscretized trajectory in red</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw">lines</span>(resampled, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="kw">points</span>(resampled, <span class="dt">type =</span> <span class="st">'p'</span>, <span class="dt">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Rediscretized&quot;</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </a>
<a class="sourceLine" id="cb8-14" data-line-number="14">       <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Rediscretization of trajectory with \mu_{L} = 2 to step length 1" /><figcaption><em>Rediscretization of trajectory with <span class="math inline">\(\mu_{L} = 2\)</span> to step length <span class="math inline">\(1\)</span></em></figcaption>
</figure>
</section>
<section id="other-trajectory-operations" class="level3">
<h3>Other trajectory operations</h3>
<p>This table lists trajectory operations not otherwise addressed by this document. Refer to the help for each function for information.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>TrajRotate</code></td>
<td style="text-align: left;">Rotates a trajectory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajReverse</code></td>
<td style="text-align: left;">Reverses a trajectory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TrajGetFPS</code></td>
<td style="text-align: left;">Returns the frames-per-second of a trajectory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajGetNCoords</code></td>
<td style="text-align: left;">Returns the number of coordinates of a trajectory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TrajGetUnits</code></td>
<td style="text-align: left;">Returns the spatial units of a trajectory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajGetTimeUnits</code></td>
<td style="text-align: left;">Returns the temporal units of a trajectory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TrajStepLengths</code></td>
<td style="text-align: left;">Returns the lengths of each step within the trajectory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajLength</code></td>
<td style="text-align: left;">Returns the total length of the trajectory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TrajDistance</code></td>
<td style="text-align: left;">Returns the straight-line distance from the start to the end of the trajectory</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajAngles</code></td>
<td style="text-align: left;">Returns the turning angles (radians) of a trajectory</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TrajMeanVectorOfTurningAngles</code></td>
<td style="text-align: left;">Returns the mean vector of the turning angles</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>TrajExpectedSquareDisplacement</code></td>
<td style="text-align: left;">Returns the expected square displacement of a correlated random walk</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="trajectory-analysis" class="level2">
<h2>Trajectory analysis</h2>
<p>Once you have obtained a correctly scaled <code>Trajectory</code> object, you may call various functions to analyse the trajectory. Broadly speaking, analysis may be divided into measures of speed or acceleration, and measures of straightness or tortuosity.</p>
<section id="analysing-speed" class="level3">
<h3>Analysing speed</h3>
<p>The <code>TrajDerivatives</code> function calculates linear speed and acceleration along a <code>Trajectory</code>. If the trajectory is noisy, it should be smoothed before the derivatives are calculated (see <a href="#smoothing-trajectories">Smoothing trajectories</a>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co"># Smooth before calculating derivatives</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">smoothed &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">101</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co"># Calculate speed and acceleration</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">derivs &lt;-<span class="st"> </span><span class="kw">TrajDerivatives</span>(smoothed)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co"># Plot acceleration and speed</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw">plot</span>(derivs<span class="op">$</span>acceleration <span class="op">~</span><span class="st"> </span>derivs<span class="op">$</span>accelerationTimes, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">'red'</span>, </a>
<a class="sourceLine" id="cb9-11" data-line-number="11">     <span class="dt">yaxt =</span> <span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">     <span class="dt">xlab =</span> <span class="st">'Time (s)'</span>,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">     <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">'Acceleration ('</span>, m<span class="op">/</span>s<span class="op">^</span><span class="dv">2</span>, <span class="st">')'</span>)))</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="kw">lines</span>(derivs<span class="op">$</span>speed <span class="op">~</span><span class="st"> </span>derivs<span class="op">$</span>speedTimes, <span class="dt">col =</span> <span class="st">'blue'</span>)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="kw">mtext</span>(<span class="st">'Speed (m/s)'</span>, <span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">line =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">'lightGrey'</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAbFBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmAGZmOjpmtrZmtv+QOgCQOjqQOmaQ2/+2ZgC2Zma2/7a2///T09PbkDrb2//b////AAD/tmb/25D//7b//9v///9AmpDHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAc/UlEQVR4nO2dC5vjqHJAPVvTvZtM35tMJ+PcTWfoB///P8YSAhXiVbwkZNf5vp11I1RgcYwQlsVFMkwFl6MrwJwbFoipggViqmCBmCpYIKYKFoipggViqmCBmCpKBfp6vcz88XfT6jB7U9uQhQK9XX6oF+/6BXNKqhuyTKCvV1Pa2/ffRSGYEahvyDKBPl9+6pfvfBI7MfUNyT3QQ3NUD3Q7dS7m8hjo3FQ3ZOlV2OeLGrxz/3NyahuS54GYKlggpgqeSHxweCKRqYEnEpkahptIFCsXZiBghdSQZLr1QKIoMNMJ8CcPPJHIAg0FBNLHnUhkgYYCQhuGnUhkgYYCegVmgR4D6BW4SqD3y+Xbr8A2FmgoILo11pAJSgW6Xi4/Pv79N74OtGGBhgJCG5INmaBQoOttzHWdpeXL+FMAgfR0QyaomEj8+HMqNzT/xAINBfiTCQ2ZoFSgadLg6//kED0Qu5oG/MmEhkxQOpGodVU18MACORxZTwikpxsyQekg+k2N2t8voaEXC+QwokDphkxwD/NALFAa6BWYBdoPFigHFsiBBcphv6MlWKA00CswC7QfLFAOLJADC5QDC+TAAuXAAjmwQDmwQA4sUA4skAMLlAML5MAC5bDb0RIsEAHoFZgF2g8WKAcWyIEFyoEFcmCBcmCBHFigHFggBxYoh/0E4ts5CECvwCzQfrBAObBADixQDiyQAwuUQ4+j5Y3JAlGAXoFZoP1ggXJggRxYoBxYIAcWKIcOR8s/Y8gCUYBege9BoLMYxALlwAI5sECI5BILLJDDkAINu1YGC+QwokDjrpXBAjkMKNBwa2WssEAOAwr0WGtlnFqgg6sJ/uTHWiuDBYoETwCB9IdaK4MFigRPAKENj7RWBgsUCZ4AehXNAu0EC2Qz1kTiCQwaVSCeSAwINJpTgwrEE4lxgcbRaEyBhptIRIvuFgWOwgJFgifgRXclCxQNngD8yQ82kegNygLxRCIRFigSPAGENjzUROLZBepWm3Rk6FU0C7QTLJDN263Xm8+ebzveznFugTre/V8hULIhE5QOor/9up09nyLlskA2gwqUbsgENZfxX6+3kRcLRGNMgQgNmaBuIvH6/TcLRGNMgQgNmaByIvH6xAKREGMKRGjIBJWL7n6+hL7GZYEsBhWI0JAJyq/CVN/39bqbQIGpOBao8ios0ZAJTjQPdGaBxLAC1cIC7QILlA0LhGGBsjm5QI2rP/nDAmXBAlnhWKBcWCArHAuUy8ECCRbIAnoVzQIFC2vJ4wj0ru5Pu/z05s6ABbLCPYZAny+XJ/Xq67X4l2YLewkkWKBhBPr859/Bv7LZUyBPujqk5fcAskBETj8GOlwgUk4WKBsWyMp09wJ9PE/Dn8rTFoYFsjLdu0Bfrz+n37bek0BCskAr0KvoRaDZnM9//osFWgtrmXN/gTYp0Kto3QP916/bv5//8RcLZAprmfPuBbqNgaapw8InNPjYSaBlrONJ908Q0aqV09YsUB9YILs6jyLQ58uP6ceKpT+1Xzm3QBnnPhbI4vr998fzk7w+1QYmH6ycjPkCbbewQI3ZCDT90Oz98rPBYGgMgZwtLFBjPAJdb/IU/soMcY8C+RMpIWsFSuw5jkC3c9fny/ff6uf2VewlUCDGQwnkibxNgOKiE7iD6Mu3X1+v1f6wQNtMDyJQM84rkHfwHd45S6BShVigrIz+fVmgYBXuXyCgZgwlyQKBhGcPikCCBaJjBLo0VmkUgYQvfxQWKAekzXQvPXm/3MVWIBjpXAL5SkqHbCZQqF7lAjVebIXqUPZiKxAMNZZAYt2VWgOqQN6GJtJNoA6LrVA6ovylDiAYi9wkuQJJFmgF/HF7LXWQkih/1WYIxtpZoEQT3olATjbwx+252EpMoRP3QHUC+b4zOLNAJ1psBUKhsgRyTkjnEUiOKBB9sZXQT5Z3W2wFQpEOEyjoyCMJRFtsJfKT5d1mooGasZFAkgXCQGHBM7GfLHu+TK2aFjB0EkhskhaB7HX4ZJVAkgXKYCPQ/NB7CvmrNgM1Y45Ay9/blRxV1PsTKFwvf/4VCEVuPJGILuuiFKzaDIFQYvP/hEDWNiOQE/6xBXJzQSAweSIxdLO80wOR5iOL1kwFfyx9TCoF2oTvIZC4P4Hol/Ghm+W3Y6CPP3/FwiwUrdoM/lgNBALhhMcCCWsPK4unMp5i0EYnnSbF8QJVrtocvFneEeiZckocrAcC4cSnCOQp5n4F8scl90DBm+WdUxjtZtaiVZvBn7G/QALvES3m0QSiTySGbpYvHEQXrdoM/oxnEEjojaUCZeQN799BIPKqzaGb5csG0QT2EEiwQP64wjnYmz/bUTaIJuB7p+DNmCGQjAlkhR9VIIjni+9/lECfL+EhsXMKu3SaiZ4BN5eZTC4TSEUNCyT7C0QxSAvkTHgSiQrkVqF5DzR54Vdi36e0gpvrwQSaLqjT2QP7UwWa/tqUUlLoBr9EZc+JNh1VuK/yH1XYZCIJhM5xwpahg0Dqup8s0DJNsHlfbtzl3ylfiUG9BCI05CZ/ah6I+KT69AKJRIHEHgKhJusjUPLMtLxHlW2Zz0vsIvExFPogUQXaBg8VVrrSpaH0do7khFGgXwc7U1OBcHAsEKChayeBUt2KFkjvDp7vf0N7qWp5zuAoW7FA5Jm/0G0axfcDvSc6qdDAAKxMpxPI+dZ/7uG27wtXG70GHJfg0B4CJRtSEbxNY/efNlvHrIlAIKMC3VpJrFuqBXL60KVY14WEQNJ3F0ogQk+BaARnmPf/bTzgTG0FQrGNQLcWF6tAokwgkRbId4W5eQ2eU2DUoK1Aoa9YXIGcqLFiKARnmA94uAKgTJZA+mA2FkjGBbIKSwkE27ZRaZu3ZVV7fe0TKGqQRyBf7j0ECs4wHyEQrJmwQObD7W29QoFA4F6iXCCxdEDbs4MSSEiSQN5TUOQ85hPIk9kVyM0TKoJM6DaNrUC1dzgawgIhg8R6ZTO96SWdLBDuY5bQuPjdBNJjeRuiQJE5AFcgEP7Blv0mPLqEiqASvFhzHnHX6lHjEYFwM8+NOx0TdCkTE0jWCCQkPgcsV1QpgYy3yhVpn3WmgJUCeXZddvAK5Bq0h0DUQfR052sbYgKtQ5J1XBERSJ/kZFogFHkZ+4h1LDTrsX7e8wXy9DX7CqQFth1yBPJ0aW5KHtRBNPl+oCREgaQahAK+JSMqEB5BFQiERsHL9FAzgZxp9s1rkGGBYJviEUhogabsVi/oCOQpwVtuBsRBdIvHayqiApkhyfxxWc5iZiS6udawBAL08RLm5JQlkM6zuOQXaP2UJwQCWSoQ3u47LbkCAdrf+iD1Fyh4m4b7XVijLigukD5Zze92OVirQHYXvRFIoqZFoxsrbo5AVmGrQLiOi0Cgq4J3AIJAIimQ//xnRn8egewrTkvWbSxf/Gbsez/QCuhMXoHs2Ub0cVz6Kb23KxDq23wCgTCjUFimh8Bqi0UgMJXxCYR3AKQFrnWmQKiw9YUtEIAgCeS9qPOlNeGwp7TCkgkJpG0A+zrCFQjpFxcITGDVfrBeRsEiEOqSpE8gERcIhN5JdhZoOsnr/dGnSOWyBJIevIlUcn4b3wyqQCCxQEufsB0r64AgsgRaxjhIINPUoF6C9kiXhQUywyuVCvJAgeZv9CyB1rO1LZC3A6rsgXKezjHPOH6rvzE6X6DlKIPqZgBFcgRa+6+YQNIWCKR1DlimsYXAhS0CgXEuJhCobowoEMiQQPZnAqVhgQRRIADvkQdfYg7U5wOpnwe91Q+lUwItjQtyIxBYF2RqS45AVkuo6KjXkVuBZEwg1WnIZf5IrALpH3piv2SdQJuryeXMqf9QHSZBoOXgOYAvsQWBn/UUPu8MUSiQNJbAGikmEGxLQwlLLtMsIiQQungzo50lwGKIaph1HlOP89chkpSbZvIIJIsF0hdiYt0KKKupFgSOPPgSWxCYSNxjvTCQy5zpRiA9ZADrT9UGRwg0fwEC0hbIepsUgUDXwN2uO0iJ5pDDAq0bYM1q+tjQgQdvagOO64HWiy2/QLhRlwyLQKKNQLjxUVliHZchgQRRINhu0kWBroG9Hb0Aib6kUAItfyp/kgIBoGgbwJvagOPGQBUCCZpA+hVBoHXsbQ+XYZ4LEMv5yxHIjqGG1fYR2AiE998KpC4JFwv0dMP8p/InKpCQnhIQ4E1twGFXYXPjwJrVFWidL1QHDQukx07lAunPrRYIZYZVFZg7hfn7LopA0/dr6NRr/hFEgUzG5bpPLMN1gkB2sQ7gTW3Akcs9QUKgtU/2CqQ6ebc0vZPZRBEI24YEkqpT0BdASYGQuFSBcEwsEICeTBDCLxA6LVrfEPoAbyqR2K/HDhUIUFafQPhqvZlAwrxWsawBsCOQ1A23EUhYNY0JpAoB97CEBAKpexR90Z4WCM3+dOqB1Njm3Tk3HbrgnED/E7hRzM5g5NFK2AL5Tvwg19yytUBWnYkCiSyBlpMmCLJAUurOanMktgelAn2bhnN1Zf02/uXHbl+m4jxUgUDnU62E2souDdbc0hZIpgUyI+ZygdAwTGQJtM5IzqOhNXpAoPWzInoLFJzfOVMPBDpfU4HkpjFiAll1RrlKBRLSL5B6pWtOEsg22wH8yWT0/M411gPd+PyHOsftMZEYEkjgnUH10OAXCPylrbllWCATq71A6+zEsud+AoUOOwTSyagbxd5SYyAtkPMsxWyaCjTfddNEIBkUSPd2YKmhBNqIZ6qLuzO8WdfUCOSraGOBzGH0AoF0OvPoxp1ftgS6rldr1ffW5wikG9P8ZQu0/Ad6H311GxUIbcoWSLoCSY9AIiiQHu7nCiQzBdLl7CFQgEAPVM8eAkGgNKgQCMxeunJ+gRYz0DvAm2EJERRo7cHIAqHcG4FADiNQO0oFErZA89yuOY1JmkCrbtJSJEcg1JQFAi3fhiyg265NVUQrgYQWSArnOOAjUsvtFPb999U5M+22Wk8kT0ogGRAIgqUVCbT0dHqvlEAiKpCa9NQCudsbCaTc0QKtF/MOENpA5f3br7fpOdFbg5xfpn7//fYkP553+DJV2g2bEAh/M6Y2rx/rAoGMtLZAaK8igVALTh3n0v+IfIGkUSYpkNQCxYDE9hTTZfw0iZh6Uv1k2PuUb4fbOWgCmfEomLxaoHBpgM9uaDgj5Z4CgTp7ARqF0QQSlkAiJpD+XW9vgaaJxEmK1ETilO/jr7/n/+poJpBA/0ks0DYTIkMgvC9EBELlm+S1Z/EIpH6cKFBPssmYIZA8XCDdA6UmEqd805XYGAIJtDEukGMQrFvoAlnaUQSy3oEJa9IA9x1ORoJA0hZIegWCTbleILE9iRoDuTeKbcdA0znu+mOQU9juAgm0l86XJ5DEaeY0lxAI72GiEAVaJhO7C6Qur9wbxZzL+OvTlLX+IS+ZAhlt2ghkqVAikDYoXyCsgwwJJOICCUsgGRVIyE2CF0hsL2aEeSBpjpQcTyBZJ5B8MIHIq/XkL7obydNCoE15gwm0KUGUC4TfBDpIxQKRH0lHm0jsuOhuJM9DCqR7JlcgsaNA5EV3qROJtPs4ipa8DOcx3bPcCITlOa1Adm303kmBZFSgTcRSgchLXtInEkl3JBIW3f1fZijAQGpIX4tTJhKJnLQHWuPr7gWF24R0eiA7S8MeyL7wX8tcO0mxVkN3Tkf1QKmJRCpFi+4G8+wtkDhYIEEQSOYJJBNAIJ286C51IjE02PZky150N5jHEch8UGUTgSTaoa1AzjvxC4R3F6tA5j+0N/of7o16CURedJc6kRgabGdzdoFkE4GcimmBZI5AqBrNBarFMw/kHWxn00ug9UNNFEimBNqeYKyIpQKJkEDm2uo+BQoOtrPJEUiiK+WdBMJbSgXy7OgKtDkQSCApNgKt79QRSB4vEOWm+shgO5umAklht5FbwrgCbeq1EUicRSD1o+bkz3qCg+1s+gkkjhbIVDMh0LZOEu93MoG+XpUR6cv4wGA7GxYoVyB0wjYxhhEo+IvTIb6NzxQI+yDX1FDxowlkBtckgYQtkNnPLnq3Hij6cIWm3LNA+jruMIHk7gLpnzanJxJbMZ5AOiZRIL0TCzQRfMbUhZKphGKBUJveoUCylUDo2G0r7gNSGUoZrweqEsg+rOblEQIJR+q1fBkTSLBAE2cTSKxBcAixNuEarZ1AskAgcYBAH88/5tUOCDfVE79MTUIQCB//0wmEq+QTSOQJJIYWaP6l8jSMdn+yfOSXqVGBhMTj6YYCSRYom+v0gMR5PebrdkXLI79MbSnQNq23QNs3IMwbSQgkSwXSFVrOnnsKNPcn6jGblJ827/ZlqnP8DxRINBPItHOxQNISSFp11UrtLNBPvaB3SqBdv0w9gUBCdhBI6Leho59CIDX8Sc5E7/llalIg6wRzlEAyLBBKrRTIOEEXyBwP91h4gFSGKNPIZ/4i3l3V+8gvU48TyG6UkQTSfe828LEC3bqVz5ep77k6Q5sj54F2FEigHIMIJKsEkrsKNE0B3fz5eE7eUNaO4FsSvlc9BdLxsUAmE0mgTSpBIFEnEHof9idBh0Za7yJQGPfpHNM1WP1TfoNvaTuDsSSaBJJAnoN2tEB29FqB7Jrbb3FsgdTl1+fLdqyUTVAgidtPv0oKhFq9uUDrSc4rkNymNhPIZKQJZPYfWKDua6bitzuAQGavHQWy+tRVIFEjUBIg5SogtGZqJ4GsZu4hkNu7meR9BMJexNoWCyTRtxPCU3NfUYMKtNxyNn/5WkdUoE13gRL0cdUfzXUP1LmkBdqUXifQthwWCLHzmqnWmz5KIBzJlFsn0LYPNQObIESBfCWNLVAregrkObMcLRB+S6JEIEEWSBfyiAIJ60VMIMECed/J+AJ1nQcaXSAnYn+B5J0J1HceSFivBhdoLX2b6BfIRHhkgTrPA92BQFI0E2itzv0I1Hke6C4EwhMBODMSSLQTKFCQ1PkHE6jzPJCwXkYEkixQeEdLIJo/dzIPJOzX7QUK9etJgURrgeyCwpQIJNdCBhSISNGT6oMCoZ6gt0Cyk0CojBKBZK5AspFA5CfVBwgI9PXf8XhlT6oX9h+FAunszQXaVvkRBCI/qT6EV6C3lJCFz4lmgdy9jhWI/JzoIK5A74QxEOEB575DvPkrKpDcCGQdWK9AorlAIVHuRyDyk+qDeJc6SHZmZT3QDgJJIdcYaCNOOrlAa3m+cVsI8Cc37oGuN3meJOV3zUVPqicKpLdigeT5BKK5cLBA9CfVh7CfD/RT/Y8QquRJ9V0FWiQhCCS9AnmseASB6E+qD2D1QO/kHijN3QokgwLhE66ngl6QQPIQgWpxvkwljYEIsEAZAqEB09kFUn1aeia6ZCLxTgSSdyVQl4nE92S8oonEHIGkI5ATKSSQcBv+RAJRjWg2iO4xkXjjf9pPJG4bNSmQbCaQp1PCVQgKFOgOUgLRLThaoB4TiRSKJhILBFozVQvkc2EIgbb1yxIo1Ec6gD+5+UQikb16oIMFCg1I7kego3qgoonEgQVSLVEvEBpdEakViDrmhkB604nEHALzT2LF2SUmkMmxq0A68XiBZHeB/Ks2N55IbEmJQFZaQqDAQHn5J08gtYuT464EolYol8EEwsfDEkhSBBLlAkkWqIyBBbIzsUBueQ8uUOhKxt7He4D2Echfx1CtWKAMCOv6sEAkDhaofoGmwh7o6zVVnPPGnDZlgbxFZQpEzA2B9HRDJij/VUbix88sUB4HCZRuyATFY6D3xLPIOwsUmuvJFAj9v1YgeU6Bkg2ZYL9B9D0JFOrO8r1xqrK7QJXcp0DUK/LzC0QND7n1oVIlEPoqzoEFyuNQgWINmWA3gTyt49mpjUBuwxcKFGigHgIlivRWggVykqoEEsUCecsOM4xA9PIguvV+BQqcRFggFqiXQMIvUKDNo2UHYYFWdrsKO1agUJsnc3i5O4EquCuB5KEC5USIBadXggVykjyDF3/wgwUKJLNA7WCBCmGBFAcJJFkgL1BUFwIsENqdSleB6JV4dIF8O3UTiDIPRKlhLCsL1BIR/TO0E10g31zPQwmUN20AvWoxmkCJMCaVBWKBfDs1EEgEBEpVkgUqggUKlx2uZiCZBWpIV4GkYIFYoPRO4f0aCbTZnUoo5+4C0YFetbgvgeQ+AnUM0as06FULFsjevQoWqCFFAiXDmGQWiAUqCWOSWaAHE6hxGBZI5h1i6FUJFsjevQoWqCHHClRQHxaoCBbI3r0KFqghnQXytNYAAlVH6Ab0CrzrorsF7ChQdt16hOgFhDZ0WnQ3RdmiuwWUCdSwpJ1D9AIC6d3WyohTuOhuO7y9DAsUBvzJp1oroyUsUCbgTz7VWhktYYEyAX/yqdbKaAkLlAkE0kdbK2OFBRoKCG040VoZjaOHvq1o/LXtziF6Ab0Cs0D23lWwQHT2mkgMwwLlAKEN9z6RmAMLFAYC6Y86kRgpkgXyAf7kh51IjBTJAvkAf/LDTiRGijxQoIEBf/LDTiRGimSBfEAgfbSJRLFSGLgCFijM+Rbd7RY4zH0rUMf52pkFGorh2vnt1uvNZ8+3wOCdBRqKYHMkG7I0cJy3b79uZ8+nSLks0FCEmiPdkIWB46irv6/X28iLBToFgeYgNGRZ4AR6/un6/TcLdAoCzUFoyLLACcz80/VpIIGYMNEeSMYasixwCl3a50voa1wWaCiCY6BkQxYGTqFnMIPrjrNAQxG5Cks0ZGngWligoRiznWPrlLFAQxFvjhFXLGSBhoIFYqpggZgqWCCmijEFOiQwU8L52vnCDEW3du4VeL9iur6F0wbf6wzAAt1pcBZoiNjnDc4CDRH7vMFZoCFinzc4CzRE7PMGZ4GGiH3e4CzQELHPG5wFGiL2eYPfmUDMvcICMVWwQEwVLBBTBQvEVMECMVWwQEwVLBBTBQvEVMECMVWwQEwVLBBTBQvEVLGHQO+Xy7dffUKrpxw/dYn98df8vJM+tVfBO1R/Xn1n/plgx8OO2EGg99vbeO/0Vj7+7HaIPl/mB+b0qf0SvH31v15vdX2bnOx52BH9BVI/m7326SUKVwihRFZLaPWp/RK8Q/U/nqfnRb398XfXw47oL5B5Sz2Cv/U6QO+XH3Prdqm9Dt6t+reep+thR+wg0NxNd+oqrv+mz/jtUQJ1qr2K2Kv61z/+7nrYEf0FUufhPmfjz5dpjZBrH4Pmg9+r9nPwXtWfVt7pedgx5xZoKaHPx6y/QM7LRrH1GPo+BOrfl6rTfXN2OIXNtK6+Wvnrfk5h/Udzna7l+w2ipS1Q2+ovy+jezyC65/WkOko9T2G9ao/sbFv99bnP93IZ33VGaz5APQfRvWq/XIU1r/7Hs452NxOJ85JU3d7I9XK5dBkBmZ6hT+2X4M2r/6aeRzbVuOdhX+EvU5kqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFYqpggZgqWCCmChaIqYIFUo/avfHHv17iP1P/ejXbP//R/1fn54AFmqA9ogc/EvN9ejgdwwIpSAJ94g4K9UaPDQs0oQSaDPl4/s/bKe3Hx7N67Mobeorq8kyo5YEsb9wFzbBAE1ig+UnvN1emp8O93f4wj2yangY1P1PsfTJoh2c3nQIWaAIL9EPqf35+vkzuLM+Cmv9YH0fX6cmep4MFmsAC/ZTmH9XLLKrMQ6BljQu5+MSwQDMhgZYL/Fkg5dG8GM5PyQJpWKCJaA+0sF6EXadkFkjBAk0EBLIu3Fdj5mQeAylYoImAQPNVmOpwpLoKm/uk9R+GBZoJCTTPA+lhs1o7Y3mGLs8DLbBAZDYnND6DzbBAdPi7MA8sEB3+Nt4DC8RUwQIxVfw/gjoanz9zPB4AAAAASUVORK5CYII=" alt="Speed and acceleration over time" /><figcaption><em>Speed and acceleration over time</em></figcaption>
</figure>
<p>Once the trajectory speed and acceleration have been obtained, it is simple to calculate values such as mean, maximum, minimum or standard deviation of speed (or acceleration): <code>mean(derivs$speed)</code>, <code>max(derivs$speed)</code>, <code>min(derivs$speed)</code>, or <code>sd(derivs$speed)</code>. Similarly, calculations excluding periods when speed drops below (or above) some value are also straightforward, for example: <code>mean(derivs$speed[deriv$speed &gt; STOPPED_SPEED])</code>. In addition, the function <code>TrajSpeedIntervals</code> allows you to determine the time intervals within the trajectory that satisfy a speed constraint, either slower than some speed, faster than a speed, or both. This may be useful, for example, when testing how often, or for how long, a flying insect hovers, or a running insect stops, i.e. when its speed drops below some threshold. The object returned by a call to <code>TrajSpeedIntervals</code> can be plotted.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Simulate a flying bee</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">100</span>, <span class="dt">angularErrorSd =</span> <span class="fl">0.3</span>, <span class="dt">stepLength =</span> <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co"># Smooth the trajectory</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">trj &lt;-<span class="st"> </span><span class="kw">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">51</span>)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># Calculate hovering intervals</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">intervals &lt;-<span class="st"> </span><span class="kw">TrajSpeedIntervals</span>(trj, <span class="dt">slowerThan =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw">print</span>(intervals)</a></code></pre></div>
<pre><code>#&gt;   startFrame startTime stopFrame  stopTime  duration
#&gt; 1         11 0.2337088        27 0.5488033 0.3150945
#&gt; 2         85 1.7073675        94 1.8866781 0.1793107</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Plot speed over time with hovering intervals highlighted</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">plot</span>(intervals)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Speed over time, hovering intervals (speed &lt; 2 m/s) highlighted" /><figcaption><em>Speed over time, hovering intervals (speed &lt; 2 m/s) highlighted</em></figcaption>
</figure>
</section>
<section id="analysing-straightness" class="level3">
<h3>Analysing straightness</h3>
<section id="straightness-index" class="level4">
<h4>Straightness index</h4>
<p>Various methods to measure the straightness, or conversely, tortuosity, of trajectories are available within <code>trajr</code>. The simplest is <span class="math inline">\(D/L\)</span>, where <span class="math inline">\(D\)</span> is the distance from the start to the end of the trajectory, and <span class="math inline">\(L\)</span> is the length of the trajectory. This straightness index is calculated by the function <code>TrajStraightness</code>, and is a number ranging from 0 to 1, where 1 indicates a straight line. Benhamou (2004) considers the straightness index to be a reliable measure of the efficiency of a directed walk, but inapplicable to random trajectories. Batschelet (1981) considers this straightness index to be an approximation of <em>r</em>, which is the length of the mean vector of turning angles after rediscretizing to a constant step length. <em>r</em> can be calculated by calling <code>Mod(TrajMeanVectorOfTurningAngles(trj))</code>, assuming <code>trj</code> is a Trajectory with constant step length.</p>
<p>Within this section, most of the figures show the appropriate statistic plotted for multiple randomly generated correlated random walks which vary in the standard deviations of angular errors.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Generate some trajectories for use in examples</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co"># Random magnitude of angular errors</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">angularErrorSd &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># Generate some trajectories with varying angular errors</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">trjs &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajGenerate</span>(<span class="dv">500</span>, <span class="dt">stepLength =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb13-8" data-line-number="8">                                             <span class="dt">angularErrorSd =</span> angularErrorSd[i]))</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co"># Rediscretize each trajectory to a range of step sizes</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">stepSizes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">reds &lt;-<span class="st"> </span><span class="kw">lapply</span>(stepSizes, <span class="cf">function</span>(ss) <span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajRediscretize</span>(trjs[[i]], ss)))</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Calculate straightness (D/L) for all of the rediscretized trajectories</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">ds &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(trjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajStraightness</span>(trjs[[i]])))</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co"># Calculate alternate straightness (r) for all of the rediscretized trajectories</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">rs &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(trjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">Mod</span>(<span class="kw">TrajMeanVectorOfTurningAngles</span>(trjs[[i]]))))</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co"># Plot both indices on the same graph</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), rs,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;Straightness&quot;</span>,</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">     <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(ds, rs)))</a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="kw">points</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), ds,</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">     <span class="dt">pch =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)))</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(r)), <span class="st">&quot;D/L&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes)), </a>
<a class="sourceLine" id="cb14-17" data-line-number="17">       <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">16</span>, <span class="dv">16</span>), </a>
<a class="sourceLine" id="cb14-18" data-line-number="18">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Two straightness indices (r, dots, and D/L, crosses) as a function of angular error, plotted for several different step sizes (linear axes)" /><figcaption><em>Two straightness indices (r, dots, and D/L, crosses) as a function of angular error, plotted for several different step sizes (linear axes)</em></figcaption>
</figure>
</section>
<section id="sinuosity" class="level4">
<h4>Sinuosity</h4>
<p>The sinuosity index defined by Benhamou (2004) may be an appropriate measure of the tortuosity of a random search path. Sinuosity is a function of the mean cosine of turning angles, and is a corrected form of the original sinuosity index defined by Bovet &amp; Benhamou (1988). The function <code>TrajSinuosity2</code> calculates the corrected form while <code>TrajSinuosity</code> calculates the original index. Sinuosity should be calculated for a trajectory with a constant step length, so trajectories may first require <a href="#resampling-trajectories">rediscretization</a>. In the absence of a biologically meaningful step size, rediscretizing to the mean step length of the trajectory will produce a trajectory with approximately the same shape and number of steps as the original.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Calculate sinuosity for all of the rediscretized trajectories</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">sins &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(trjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajSinuosity2</span>(trjs[[i]])))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co"># Plot sinuosity vs angular error</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), sins,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;Sinuosity&quot;</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes), </a>
<a class="sourceLine" id="cb15-11" data-line-number="11">       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAApVBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZAAAZmYAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmZgBmZrZmkJBmtrZmtttmtv+QOgCQOjqQkDqQkGaQtpCQ2/+2ZgC2Zjq2tma225C22/+2///bkDrbtmbbtpDb25Db/7bb////AAD/tmb/25D//7b//9v///+wG9bUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARrklEQVR4nO2dh3rjuBVG6VVixZpJtTabKqVYKaMka1Hl/R8tBEBSLABI4gIgyn++3Vlb1AAsZ9GJWzwAIFCsfQIgbiAQIAGBAAkIBEhAIEACAgESEAiQgECABAQCJCAQIGFZoALkgEOB7CYHggQCARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICgflcLqOPIBCYDwQCtoFAgAQEAjIklZUcc4HuRzGd/923GUmDyHAv0Ll4Fz+UzQ+6pEHwzFamj6lA92Orzfn1czJpEDiXi2eBbvtD82OpqMQgUEQY6oMSCBAhtIHqIghtoKwx74Xd9qIXpih/IFAeYBwIkIBAgIQFgc7ohWWM/RJI+soZiIzNZuYXUYXliH7Uh8kjF0jyKQTKkWmB5N+EQGAhkyPUEAiQMJ8LezaW0QuLkEHRMrvRPMS4BLoflQuBTJIDnqkFajzyL1Bl0Nv8pEGgGM/CNxDaQGVx0B6HQGFiXNhIQSM6OyAQCAgIBEhAoGQht49nAYGSpSeQM5sgUB5oBKoPGbatIVDqDMUYvb8DgUCHkQcygarPbHXmIVBijMSQVV6bzWWmQJNfg0CJMfJF3vqZ26iGQMAtEChpJgsaclMIAiWHekXqxJeNgEDJ0XXC7sSpDAiUNBAIzKetr/zMggkgUDrME8hyoQSB0qFVQ+sIBAIK5gk0+yvzgEB5AoFAGECg5JA2oZ315yFQciwViOYWBMoeCJQ37fOvSh6fI4g1ECh2IBAgscoExhMIlAbrFD8PCJQKEnvcz8QzIFCyQCAQARAoJfwUOj0gUEpAIGDEOh0wjrlAp6J444F3VRvdQSBvcIFWKH4eBIFYnMJT8cY2/EXAOV+oBg25O3EJxENeli8fD4S89IhWoHUw32j80ITbRdDdMEAJBKbwuVp+JvQ2UCd+szppQOBZXy1ZNu8J9MLCR2JLCgItShoQmGPLakZBoIgQlkhdiVkgBN31hUag1bBfAiHoblagCouLFWe95ECguEhIIN6FVwe8hEBmNC0cxZBPWA2gB2UgsajHD8sCA4kWyUWgzvgzpjIMCU4GE0iTqQJMphqi3lR+0UarFdutrXNaDEqggGCujNaGJSpQ1QaqiyC0gazCfQmur6XGvBd224temKL8gUB5gHGgIBj1vaIBAgXBQKCIPIJAQSAaPQGuF5sEAgVE+3JFFo3oRUmDeYhwlBDIRXJZEJE5NRAIkIBAgRJLWQSBPNLrXKl6WrU5MoFWnLFQAoE8MhBocTxlCAS6xFJLaYFAgAQEAiQgUEqs0EiCQGvhogUEgTIiiSY0BAJEIBAgAYHcE9HqnuVAIPdAIHrSWZNIc1kOBAIkIJBHUiyKIJBHfAjkeywRAiUGBAKOsasYBLJEPH11DwLd9mwLeptJp088AnGsWaQogc5Fodp0wyhpEBiuBXpYcChzgUItkiy3snVtoLNuC81lSWdINALVHxiKpRSo5GFU7kfl9j+LkgbhskAgyXfkArHNo4Q5qg0QH49TdeS6KwoeM0xG5gKlOOw8V6DbXmlFC/fny0dvu0110hmySKAQ3/iah1yg74U/6uJHhNo98c4+Ntmk41Agx25qBVLF4XmIcqfeqRXb/AaNf4FOz3g7mm48K33OKIGyR1sC6bjtv/vWibw7kXRWhNqBdwJhLqwUpZRy0iMvgTptZrsCOaqCbCWLyVRLOOu1RydQ1b9q9hCnjEPnJpCGFfvok1mTz81CCYSYqRMsekjTX16SXBQCDVPMPmYqqTazK5B7VFMZ72wq1XwebJh0umzGTWZjgcJSYx5ygU6vn9fdWz3SbCPpdNlY3F4+GYHYMHNZHHRTGYiZOmC7tdR7H1sUtFdKgdhkqWYqAzFTByx+yqq/kIJAVd11279+3vbqKgwRC2ueVdjCpo8tLZ7prCKacj3Qy8f9qGkCIWZqjbFAtghSoGlQAj0JuooxZPY1GY8D5R4ztdNkhkDjn9laVfViVU7mMVPDnXIn+7woAblAolRpCxkz0hYoXAIQqGngqFo3y5NOl6rpnOLy+dkox4EY2oHERUmny4Wx9knQMS62UAIZ0bnfLprQ/pvldgVCG2iK5AQyxrwXtijp1OgE+/JZgQUoFpa0GqGKFucYCJQFAT5md+ek2mAKa6LNoT8s+4/br0A1tF58vgLRCbEMU6CtwrAicUi4ExhroRUIA4lDrApkuZxZp9jSCqRbkbgs6dSw0gcjPHHZXw1PIN2KxIVJx8O8x7D27IVqnzr/aHthOb7Wo38Sa4ujRHLaVpyaTATjQDpGTZ5gBZKgefbz3YJAJDRt5oh62mMsnrxcoMl3vpYmnQiJr2M1QfFaD20IcZx0zHSscT4MFJ+WikY0NczBMOl42Uhefu9h9ZknIxBpIZAk6Xjp6aMdfrH78GNRSbEi0UKwnhQE4p2uuYvHIFB3RaKFIigBgfhTNHyUsRhABMs5dFQSXC76NpDSk5A3trMIxoEm6AkkGUcMsaCBQCtS6yK3Zv2B6OB8hUADWoFag9a3pkMEAmGbXz72E6hAwYESSEJ/8FAvUHBFgmcgkMyABYUOBBr/fN2980gYebxYKDGAbZgQnxjBrEi87g5iKJH/YCfpuIBA85EIxN/F4PPxM97K0EgWp0Ci9lJtuUF7SPFJOY20F9bMhmlDXj5DGiS1yWYjUPP7dtt97BBoiEygQ7OgQ/daT701YnIl0JC+QGCIQiDhhXZ/ILaTdAoC4V1BEoo20Jn1wKZWdZyqLyUpEMqc+UgEKl8+ROkyubD1XLzHL9BjLAwEmo9sHKjkb4Rdd9OvhV13P4leoKoEgjDmEEei70f10rMYBKrsQRuIROZTGZU9mCslYUGgaGOmqisv1GmzsV8CxRMztRVoVAhBoNnkXIW1mqAWMycrgQYFC18yD3tomAsUYczUgUDCHghEwligNGKmwh4qpgJFHrEQgz+2MBUo8pipEMgWmZZAU6AfPxdCGyjlmKkQaC7mvbCoY6ai8WyLrMaBnkwKhCJoJpkK1BDi3hpxAYEAiawEQufdPhAIkMhKIGAfCIRmEImsBJJ23iEQCQgESGQlELBPogJN1Uuot2yRukCKnjsEskWiArXewBTHQCBAIlGB2v4WOl6OSVogVvxg+sItiQokgEDuSVGgXhcMdZhbkhaIAYHckqJALZDHPSkK1O4axQRCP94tSQvEgEBuSVGg1HdMKEKBn0z3xCxfp93k5pO0PY8QGpeCZAVKnVBuLASKlFBubMoCJd10hkDugUAeSFmgpAnlxqYiUNKljQwIZBcItBKpCJTdgg0IZIm66IFAK0EU6FwUYpe71WJl1ALx/+RkURoCsZiGtz0Labh2sBUe1RQC+YckkNil9X58/VxPoFqaC4vxnlNLOgmBmn2iT6+fawuUXdDBJARq94k+va0mUOqz7iombizfPpc/k1IVTbKzTbyE6q8Nv3D9KnnGxDZQrU11uhDIL/0bexnchpJ3bU68iWokEDs4+MJtL3vG5F6YyON+XEGgnGqsEb0be7kMDDrxWO0sZLs1gUp5TKaYx4EgUM3lMjCImSO47vgu8Gy4pWpuXL/8fVc0QQW4H/WB2/5PezEgcyqKl7+9sK+9/rj/467oxCKQxkOJWaCceu0jtAJVj7sxSGhS1WXX3TvT6VBXb+JIc+C2r35gv5wqScri5UOUQPWHTaIuBVp7HCg79ALxkoc/EmECK3Sq589caQPjVEfaA/yH6+5Q/fPgbaf2r4lPOD5LoP6aa2AffRuIcT8WdSO65KVI64f4lR1pD/Byin0gOm6NQIfpkF4xV2FZo++F1ZxY2cIqLcHh+oUJ0xGoOdC4ck5boKxbzQO0N7apd2oTyqYdMxKoObBaCeQ36C4EeqK9sU0vrBQlUCuBaAOdOm2g+kDjijDv7E0gz0F3s+52DdDf2JJHcGNPhbeEeVeqahpfd9UPw15Y02bmHzx7Ye8eBEo85GXQzJnK4BXUqRkHqh7/ddcZ2WnHgaoDT1dO1e//rD45sXEg1wL5Drqb67SFDKMb2+mT61A9TOV5xFICQaAnbgTiXxCjQ0vOg9AGSjnobtA4KoF4x35WMdU9D/NeWNRBd6MmlBsb1TgQeBLKjYVAkRLKjYVAkRLKjY1AoO0WA4hjfC9p5XMOkp4SBIqU/o3dDG6R9SWt9yNbG9SuMhqcR9gCbTaYAxvTu7GbzcAg60ta60my8QhjBALxV77AgO6N3WwGBjlY0sopn8sTe+cRukD0NNJDK5CbJa18fZH0PMIWCMjQC+RkSat0viFogVD2qNG3gRj2l7RK2tBhC4Telxp9L6zG6pJW+Xxn0AKh8azG+5LWs3y+HAJFiu8lrWfFHH2wAkEePZ6XtAr1VOcBgeLD85LWs2gsxTAOBHNmkcSS1rnpLwICzSKNJa0z018E+u6zSGRJ67z0F4HRw1mEMsQfnkBgFqHc2JAEQutnARCoi1AHAi0AAnWBOovxvaT10e7SWvaGg8IQCGsOFzM1Eu1sl1Y2f9ZZWAaBIqV/Y7eDG+hul1bxOvupXdgRhkBgMb0bu932DXK4S+twcTQEipTujd1uhwa526W1XhECgWJHL5C7XVpF8+fZCIJAkTIh0MPVLq0QKBG0baAGB7u0ogpLBG0vzOEurWhEJ4LvJa2PWiDL3Xi/2/yCJ56XtPJE7Q8ket7mFzzxvKSVUTd8zvamMow32cTAM5kklrQab/MLgcgksaQVG42vRxpLWg22+UXhY4dQ/s8k9sKWb/MLgeyQiEDz0gf2CeXGQqBICeXG2hIIMVM9E8qNdVQCIWaqa0K5sajCIiWUGwuBIiWUG4vJ1EgJ5cZiMjVSilDgJ9M9sQUXgakMwPE+mQrSwmUJBHLAUKAZk6k9mZYkbQdk6T1Ly5Op5klbAVl6z9LhyQR1ncjSUZYQCFmSsoRAyJKUJQRClqQsIRCyJGUJgZAlKUsIhCxJWWLuAZCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACfsC9SLc9cPduaKbi1j3/6b9vhXqgH7D/P1k6ecq+Zvs7fs38qu0LlBvY+rBLtWO6OUitvd3Tx3Qb5S/nyy9XOX9yOI/NZoqrtK2QL2t8Yf75Luhn8uSTY8JlM8dJvxcZS9LP1fZi5OhukrbAvUyHUbqcEM/l7OH2usZ0G+cv5csPV2lyFeUOqqrtC5QNzzQMFaQG/q5nH7erbcd8hTIy1X2svR3lTyGFPuP6iptC9QLUDaMVuaGXi63PXtr9uTh3rb30s9V9rL0d5XtW+yqq0xNoPojn8XBCgJJf3WTZbcN7UOg1asw8dG8KCMkVq3CRMbur/K5i4avKmz1RrT4yEMv13cj+jEWyPlVnp/tLF+N6LW78XWcWZ9P01c3fuSs86s8d+Kw+OrGrz6QyC/RayPa20Bitxfm4ypFxMw2cz8DiW2EOxHH8+xlkL+X5alYFsDIlDqkqL+r7GXp4yrPYjOolw/dVWIyFZCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQIAEBAIkIBAgAYEACQgESEAgQAICARIQCJCAQFru/9jxtzP97OUUIxBIy+n134/rHz7XPo2AgUA66k1xfrP2eQQMBNIhtsO4fe9n5+AogUA6aoH26n0wrr/MvH6DQDqEOrqt5CDQ2icQNuXLnx/3I9sS9cwiC1x/tWebTpbFd389VOrc//JR/SmO/OIHXlqVzS//Yh+cWf+tOZQmEEjPf38oil9/8pLm9ttv16/fqj+rNlFVNDUC/U8cEfsVsgLpdGC/8H+/su/6Cr6wDhBoJtdd8fLRljrMkubn5gj7VskHjdgv7N+yKq34F9c+eYdAoHlUzWlWmPQF4p/8pznCv8Y3oYRAYEjlQtmUQHUV9pXVW5VAzRH2teqT+/HQCFRXYRAIsABdP2vaPawR/fvD41T89HeVHT82R/j3RCO6Foi1vA+Jd9QgkBFMI8CAQMth4QIxu1oDgQAJCARIQCBAAgIBEhAIkPg/WnZdydsdr6MAAAAASUVORK5CYII=" alt="Sinuosity as a function of angular error, plotted for several different step sizes (linear axes)" /><figcaption><em>Sinuosity as a function of angular error, plotted for several different step sizes (linear axes)</em></figcaption>
</figure>
</section>
<section id="emax" class="level4">
<h4>E<sub>max</sub></h4>
<p><span class="math inline">\(E^{a}_{max}\)</span> is a dimensionless estimate of the maximum expected displacement of a trajectory: the greater the value (approaching infinity), the straighter the path (Cheung, Zhang, Stricker, &amp; Srinivasan, 2007). <span class="math inline">\(E^{b}_{max}\)</span> is <span class="math inline">\(E^{a}_{max}\)</span> multiplied by the mean step length, so gives the maximum possible displacement in spatial units. <code>TrajEmax</code> returns the value of <span class="math inline">\(E^{a}_{max}\)</span> for a trajectory, or <span class="math inline">\(E^{b}_{max}\)</span> if the argument <code>eMaxB</code> is <code>TRUE</code>. <code>TrajEmax</code> differentiates between random and directed walks; see <code>?TrajEmax</code> for details.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Calculate Emax for all of the rediscretized trajectories (from the previous example)</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">emaxs &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(trjs) <span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">TrajEmax</span>(trjs[[i]])))</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">emaxs[emaxs <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># Avoid warnings when plotting on log axes</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co"># Plot Emax vs angular error on log axes</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw">plot</span>(<span class="kw">rep</span>(angularErrorSd, <span class="dv">3</span>), emaxs,</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">     <span class="dt">log =</span> <span class="st">'xy'</span>,</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.2</span>, </a>
<a class="sourceLine" id="cb16-9" data-line-number="9">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, n), <span class="kw">rep</span>(<span class="st">'blue'</span>, n), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, n)),</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="kw">expression</span>(E[max]))</a>
<a class="sourceLine" id="cb16-11" data-line-number="11"></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), </a>
<a class="sourceLine" id="cb16-13" data-line-number="13">       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Emax as a function of angular error (logarithmic axes)" /><figcaption><em>E<sub>max</sub> as a function of angular error (logarithmic axes)</em></figcaption>
</figure>
</section>
<section id="fractal-dimension" class="level4">
<h4>Fractal dimension</h4>
<p>Fractal dimension has been considered a promising measure of straightness or tortuosity, varying between 1 (straight line movement) and 2 (Brownian motion). However, several studies have found it inappropriate for use with animal trajectories, as animal trajectories are not fractal curves, and the fractal dimension of a non-fractal curve depends critically on the range of step sizes used to calculate it (Nams, 2006; Turchin, 1996). Nonetheless, fractal dimension continues to be used, and the <code>TrajFractalDimension</code> function, by default, calculates fractal dimension using the modified dividers method to account for truncation error (Nams, 2006). See <code>?TrajFractalDimension</code> and <code>?TrajFractalDimensionValues</code> for more information.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Use the same range of step sizes for all trajectories</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">stepSizes &lt;-<span class="st"> </span><span class="kw">TrajLogSequence</span>(.<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="co"># Fractal dimension is a slow calculation, so just plot a subset </span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co"># of trajectories from the previous example</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">fn &lt;-<span class="st"> </span>n <span class="op">/</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7">use &lt;-<span class="st"> </span><span class="kw">sample.int</span>(fn, <span class="dt">n =</span> <span class="kw">length</span>(angularErrorSd))</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">fangularErrorSd &lt;-<span class="st"> </span>angularErrorSd[use]</a>
<a class="sourceLine" id="cb17-9" data-line-number="9"></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co"># Calculate fractal dimension for all of the rediscretized trajectories</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11">d &lt;-<span class="st"> </span><span class="kw">sapply</span>(reds, <span class="cf">function</span>(trjs) <span class="kw">sapply</span>(use, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb17-12" data-line-number="12">  <span class="kw">TrajFractalDimension</span>(trjs[[i]], stepSizes)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">}))</a>
<a class="sourceLine" id="cb17-14" data-line-number="14"></a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co"># Plot fractal dimension vs angular error</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="kw">plot</span>(<span class="kw">rep</span>(fangularErrorSd, <span class="dv">3</span>), d,</a>
<a class="sourceLine" id="cb17-17" data-line-number="17">     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.5</span>, </a>
<a class="sourceLine" id="cb17-18" data-line-number="18">     <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">'red'</span>, fn), <span class="kw">rep</span>(<span class="st">'blue'</span>, fn), <span class="kw">rep</span>(<span class="st">'darkgreen'</span>, fn)),</a>
<a class="sourceLine" id="cb17-19" data-line-number="19">     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="kw">expression</span>(E[max]))</a>
<a class="sourceLine" id="cb17-20" data-line-number="20"></a>
<a class="sourceLine" id="cb17-21" data-line-number="21"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), </a>
<a class="sourceLine" id="cb17-22" data-line-number="22">       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Fractal dimension as a function of angular error" /><figcaption><em>Fractal dimension as a function of angular error</em></figcaption>
</figure>
</section>
<section id="directional-change-dc-and-sddc" class="level4">
<h4>Directional change (DC and SDDC)</h4>
<p>Directional change is defined as the change in direction over time, and has been used to assess locomotor mimicry in butterflies (Kitamura &amp; Imafuku, 2015). Directional change is defined for each pair of steps, so a trajectory (or a portion thereof) may be characterised by the mean (<code>DC</code>) and standard deviation (<code>SDDC</code>) of all directional changes. <code>DC</code> may be used as an index of nonlinearity, and <code>SDDC</code> as a measure of irregularity. The directional changes for a trajectory are calculated by the function <code>TrajDirectionalChange</code>, so <code>SD</code> may be calculated as <code>mean(TrajDirectionalChange(trj))</code>, and <code>SDDC</code> as <code>sd(TrajDirectionalChange(trj))</code>. Note that directional change cannot be calculated on rediscretized trajectories, as rediscretizing discards time information.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Calculate DC and SDDC for all of the original trajectories (from above)</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">dcs &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">mean</span>(<span class="kw">TrajDirectionalChange</span>(trjs[[i]])))</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">sddcs &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="cf">function</span>(i) <span class="kw">sd</span>(<span class="kw">TrajDirectionalChange</span>(trjs[[i]])))</a>
<a class="sourceLine" id="cb18-4" data-line-number="4"></a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co"># Plot DC vs angular error</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="kw">plot</span>(angularErrorSd, dcs,</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">     <span class="dt">xlab =</span> <span class="kw">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="dt">ylab =</span> <span class="st">&quot;DC&quot;</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="kw">points</span>(angularErrorSd, sddcs, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">.2</span>, <span class="dt">col =</span> <span class="st">'red'</span>)</a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;DC&quot;</span>, <span class="st">&quot;SDDC&quot;</span>), </a>
<a class="sourceLine" id="cb18-11" data-line-number="11">       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">inset =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="DC and SDDC as a function of angular error" /><figcaption><em>DC and SDDC as a function of angular error</em></figcaption>
</figure>
</section>
<section id="direction-autocorrelation" class="level4">
<h4>Direction autocorrelation</h4>
<p>The direction autocorrelation function was devised to detect and quantify regularities within trajectories, in the context of locomotor mimicry of ant-mimics (Shamble, Hoy, Cohen, &amp; Beatus, 2017). It detects wave-like periodicities, and provides an indication of their wavelength and amplitude, so can be used to detect, for example, the winding movements of trail-following ants. The function <span class="math inline">\(C(\Delta s)\)</span> is applied to a rediscretized trajectory, and calculates the differences in step angles at all steps separated by <span class="math inline">\(\Delta\)</span>, for a range of <span class="math inline">\(\Delta s\)</span>. The position of the first local minimum in <span class="math inline">\(C(\Delta s)\)</span> (i.e. the 2-dimensional position <span class="math inline">\((\Delta s, c(\Delta s))\)</span>) may be used to characterise the periodicity within a trajectory.</p>
<p>The function is calculated by <code>TrajDirectionAutocorrelations</code>, and the result may be plotted. The position of the first local minimum (or maximum) is calculated by <code>TrajDAFindFirstMinimum</code> (or <code>TrajDAFindFirstMaximum</code>). Some trajectories will not have a first local minimum (or maximum), which indicates that they do not contain regular changes in direction.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">corr &lt;-<span class="st"> </span><span class="kw">TrajDirectionAutocorrelations</span>(trj)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">plot</span>(corr)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAnFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6ZmY6ZrY6kNtmAABmAGZmOgBmOjpmOmZmZrZmkLZmkNtmtrZmtttmtv+QOgCQZjqQZmaQttuQ2/+2ZgC2Zjq2Zma2kGa2kJC2///bkDrbtmbbtpDbtrbb27bb2//b////AAD/tmb/25D/27b/29v//7b//9v///95960NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAORElEQVR4nO2diXrjthVGMdOOnXQZdW/jNlbTWt0cuZX0/u9WiZTkRVzA+1+QAHnO98VjWcQFRJ2AWEggHAAEwtQFgLJBIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBAIJBwFijAEkgokG84yBIEAgkEAgkEAgkEAgkEAgkEAgkEAgkEAgkEAolRBUKp+YFAIIFAIIFAIIFAIIFAIIFAIDHuOBAGzQ67QOsQ7vYPIYTvIkKbcoACMAu0+fJ8dOjucNitvvaHtuQAJWAVaP9w1Gb76fFQq9QX2pADFIFVoN3qeOXafn46XH52hzbkAEVADQQSehuoUqkvtCUHKAF6YSDBOBBIIBBIOAi0oRe2YPxroMbH7l1zgIzgEgYSCAQSdoGqLvyRlhZQczgMmhv2gcRwHj/chviBRASaHdJURs2AqQwEmh3SZGrNgMlUBJod1EAgIbSBzlUQbaBFY++F7VZ1L6yl/kGgZTDy4goINDcQCCQQCCQQCCQQCCRGFgiD5gYCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgQQCgcTYAmHQzEAgkEAgkEAgkEAgkEAgkEAgkEAgkEAgkEAgkBhdIAyaFwgEEggEEggEEggEEggEEggEEnaB1p+fDi/3IVR7hvWFNucCmWMWqPLnm8d3y222h7bmArljFajaand9d/p1yCKbA3OB7LEL9N1lpdYhy/wOzQZyx34JO9Y+G0sNhECzwizQbvX56c3Ouz2hY/4OJSJ047f1Mr93MaFj/g4lMv44EALNCgQCCQeBBuyZqmQDWeJfA3XtmeqYDeQBlzCQQCCQsAtk2jN1eDaQN2aBbHumDs4GMscqkHHHwsH5QOYok6lnhk6mItCcoAYCCaENZNkzdXg+kDf2Xphpz1RDPpA1E4wDIdCcQCCQQCCQQCCQQCCQmEIgDJoRCAQSCAQSCAQSCAQSCAQSCAQSCAQSkwiEQfMBgUACgUACgUACgUACgUBiGoEwaDYgEEggEEggEEggEEhMJBAGzQUEAgkEAgkEAgkEAompBMKgmYBAIKEK9HLfsl8hAi0Dq0CX5aU6FvpFoCVgroHOK9tRAy0c+yVstzotbodAC0dpA60/PdoFwqB5IDWiN+ErAi2cBoHOW1mGVjNeebn/CQItm48CHXtX501Q9w/t+6hcOR6EQIvmg0C7X7115v0rJfTwt6EMHEaih255KWYHWeE/ldG75aVvdjAtDQLtVl+P/av2LQwsoS3vQwk0CLT+8vxyf3dY3zmGtrwPJXAr0GknsO2xb9W2DdgF85aXse9DCTQLtD5a0dY2PmPf8jL+AMifpkvY3Wmaa7fqvIQpG85FHwD509iIDp8e9w/dTSBly8voAyB/rN14aiCoaBdo/6/Ofryw5WX0AZA/bQL99899M2H2LS+jD4D8aRbon78On37xrTIRdkCgZdAg0P/+eh9++r04k3pAoGVwI9Cp8vnlfw7qVPwhxg8MKp8bgfZ/+/n31SsEggia2kD/+O2fDggEUTQ3ov/9m98/IxBE0N6NT98LQ6AZ0DGQ+HcEgl4mW1whQYYwAdPdVB95COSN+FhPbGj7IZA32oOF0aHth0DeTNoGQqDyQSCQuJ3KqG5FfLlvucnHGFo5BnLmthFd399z+dcptHIM5MxHgdYXb06PF/qFVo6BnPkgUMStzqbQyjGQMx8HEvsftjCFVo6BnLkR6LUGGkMgDCqdmzbQ9XGw9RiXMAQqnY8CXdc87Fj80BBaOwjy5WYc6PyY16btaS9baO0gyJfbkeh61Q11bZdDrBsYVDbTTmX4Zwojg0AggUAgMblAGFQ2CAQSCAQSCAQSdoE2l9umrSvVm3KFzDALtPn0eKgX4kSgJWMVqL5xaP/w5VkVCIOKxirQ5cah9ZdnBFoyWg10ON3/gUBLxt4GOmuzW9m2/TZmC5mh9MLqi9j+AYEWzPTjQBhUNAgEEg4CqY1oBCoZ/xooestLj3zjM4E05HAJs2ccUGhqihYoSKnBA7tA8paX1ow/pkOgKbEPJOpbXtoyvk2GQRMiT2UIG86ZMm5IhkATok6mHoQtL00ZN6XCoOnIogayGYBAOSC0geQtL405N6TBoMmwfw36lpfWnBvSYNBUZDEOZMk5dLyC8chDIEPWofMljEWpAn1MUL0eMP8GTmQi0OC8mwSq/sOhcSlToAZLwjUGBo1JLgLJF7w3VQ8GjchsBDJnDBIlCtR7KAaNRzYCeU6dIdB4FChQRD8Lg0ajOIGiuukINBr5CBR3fKxmA/MGK4UJFBsTgcYCgUAiI4EiEiS/SxaGgkAggUAgkZNAvSnS3mEEFhAIJLISqCdJutlZMINAIIFAIJGXQJ1pks3ug8B8BcKgUUAgkMhMoI5EhlEBFErPnAWiEhqBYgTyiIZP/sxboPcfL3BR8yc3gdpSWcsWPvyGQc7MXaDqgcNTxXMJgEG+FCKQVLTwrkOGQa7YBXJc5rc/meO3HnXnbPWg9OUHynVgFshzmd/eZK5fYeR9a5U39Q/P3Mdm0KYTlvgtv/fhu8jm+3S3H9n3DPQNd9+8X65BIXnXwSqQ6zK/LYkvJnn/H9QRLjQvMFSqQSP0HDKsgS6pB+/6MyD2wHcKFWiMnoPQBnJc5rcxeQg//vhjkut3W8z2zMo0KDT+miyPgZl4LvPbmPzkTxqBGlo5fVVdmmKM175NNgif3TjQm/TJaqCbokV2zHzLEF47e0kY/iHVXLITKF0XNHS8iknhWYRUBhUjkLxnahsJhzBC64v2JMnGEpK42bwOqT/+NdDwPVOnIBgmN1INZ3qfqJaxiFIEShXOnXP5BoieakJlrHHS1D3aBQo0rJ4sQqDOYVJ/7AKlmkwdj+FX2deGrzpG0flSiNtdsARfiTCQmGgyNWteu97yRE3Xa6+4Q98Xs8xqKiNXru7YK6F0HaTeMGmnhYZETz2Zmi1Bvo41pnI5WZOMhxqjL7YGen/GDJ+xOclIAiUcDx0aPPlkahkM/5AtKTzO1hQj6vZeWOrJ1DIY/CFbE+inK3JEXcmhu/W2sHEgH8wjAWogawQhn77hbQQy4CaQw9yh41HRKRFIJB+BUk/p9bf+EcjCsI/ZdbTv6LZ7NgiUhlwESj0nHNF7RCATYcitqemmqhCoWML1R89xfaKNJJAtHwRKjMc8lHMXu/1gt/FPBHLDZSLTuY/tmBECJafn80adDvsM/1THI5Af3R847TCf35TKwKMRyBGHPrrxpLndFdB4ZFeTCYE8cXg22rWP3ZfE4bKKQL5EdHZNAZIkClEJEWhU+gf8TQH801Sp9KEFBPJGXV8oaXNmeNK+AxDIn5sPnvrhM+VMq4MPCJSA0PlyYOoECeIT94dGoBSEjlcDE6dIEJ16YBMJgdx4e9FKLYR4niPHeGKOQSBHrgr5zVv6HB6ffvAoEQK5Yl9hdtjMuiGDuAAINDXmNZIi0wWjoLdhBvy54ygEyocYMby2r0KgWSIP8ak5IVDZDBkCTpGT4fYBBMqKniE+x9PbGAqBSqdrNNJ3BVMEmidvByNDym+qKV5sFvZibY6d1GqFl2TrRC+d8P630PCGW1Y3VVpygTafHg+71d0BgdLxYTA7fPx7kswG5mEVqF6hbP/w5RmB0nEeKXwvUDa7P9wcOKRglzUS11+eESgd4d1g84crmXtelhlgrQY6sr5DoNEIac/qmAJdL1y7VdtS4wjkz1gbjMXnovTC6ovY/gGB5oKhmc44ELxiaKYjELxh+C1MDgLRiJ4RgxtZ1EAggUAg4S9QGVteghN2gcrfcA4csA8kLnLDOfiIPJWxuO2e4B3qZOphaRvOwXuogUBCaAOx4RwovTA2nIND2oFEWAKaQG+aQv1CDQ8/fegSI09WaASaR2QEGkyJX/MMTwcCzSMyAg2mxK95hqcjcb97hmcsz8gIlFHoEiMjUEahS4yMQBmFLjHyXAWCuYNAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIJFSoG0Inx7do9bPpt25x3/5tnpa+xrUL3od2b/c1Vop1d2h3oW+Ru4vdEKBtscMt/4GvXzzmCL+blU97n8N6hf9HNm93PuHY5DN6dv1LvRr5P5CpxOovnV6fecd97Kug2/8bb3o0TWoX/RzZP9yv9yfHjTffH5yL/Q1ckSh0wn0WgpfNncJ4m/D1+pcXYO6Rb9ETlPuqmrwL/QlckShEwpU1X5t68DYWf+svj57x68FugT1jF5HSVTu9Zuy+oY+Ro4odDqB6iumeyNotzqt7LD+6h6/OjvXoJ7Rq8iJyn1aJyVJoavIEYUuTqBz8M9PhQl0/dX5W75LVehwbfB0Frq8S1gd/P670i5hFc7lrtdpSlHotytAdRa6vEZ0HfybR+/4iRrRh/cCuZb7vOhpgkJv3q4g1lno4rrx9UfZvum8OrFN1I1/p6ZruV/3TvIu9CVyRKHLG0isPsWxXecdf5tqIPHSC/Mu98v9pZbwLvRr5P5Cp5zK2CSZyjisw2XraNf45wvNNahf9HNk73Jv6tXCTqGcC/0mcm+hmUwFCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQS2H0/dQmmB4EENqcVBBcOAtnZP9Qrn7zcX9ZAWSAIZGf7x4fT+kvVMl7bpRqEQGb2f3naVMuCpVkGshAQyMzLHw671dfrXhgLBYHM/PBUr+Ze722z0CsYApk5VkCXZUyPrNMsqJ4/CGTlh5Mx+4dzT363WmgVhEBGdr+r/rlsMJBoS4f8QSAj56VwT9v5bUOa9YyLAIFAAoFAAoFAAoFAAoFA4v+e1mmGr13jAAAAAABJRU5ErkJggg==" alt="Direction autocorrelation of a random trajectory with first local minimum" /><figcaption><em>Direction autocorrelation of a random trajectory with first local minimum</em></figcaption>
</figure>
</section>
</section>
</section>
<section id="working-with-multiple-trajectories" class="level2">
<h2>Working with multiple trajectories</h2>
<section id="building-multiple-trajectories" class="level3">
<h3>Building multiple trajectories</h3>
<p>As trajectory studies are likely to involve multiple trajectories, <code>trajr</code> provides some functions to simplify this process. <code>TrajsBuild</code> assumes that you have a set of trajectory files (such as CSV files), each of which may have a scale and a frames-per-second value. The function reads each of the files specified in a list of file names, optionally using a custom function, then passes the result to <code>TrajFromCoords</code>, which assumes that the first column is <code>x</code>, the second is <code>y</code>, and there is no time column. If these settings are incorrect, the <code>csvStruct</code> argument can be specified to identify the <code>x</code>, <code>y</code> and <code>time</code> columns (see the example below). <code>TrajsBuild</code> optionally scales the trajectories with the specified scale (by calling <code>TrajScale</code>), and optionally smooths them with the specified smoothing parameters (by calling <code>TrajSmoothSG</code>). The value returned is a list of <code>Trajectory</code> objects.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">tracks &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">  <span class="kw">c</span>(<span class="st">&quot;3527.csv&quot;</span>, <span class="st">&quot;Zodariid2 sp1&quot;</span>,     <span class="st">&quot;spider&quot;</span>,       <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">  <span class="kw">c</span>(<span class="st">&quot;3530.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">  <span class="kw">c</span>(<span class="st">&quot;3534.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">  <span class="kw">c</span>(<span class="st">&quot;3537.csv&quot;</span>, <span class="st">&quot;M. erythrocephala&quot;</span>, <span class="st">&quot;mimic spider&quot;</span>, <span class="st">&quot;blue&quot;</span>),</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">  <span class="kw">c</span>(<span class="st">&quot;3542.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">  <span class="kw">c</span>(<span class="st">&quot;3543.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">  <span class="kw">c</span>(<span class="st">&quot;3548.csv&quot;</span>, <span class="st">&quot;Crematogaster sp1&quot;</span>, <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb20-10" data-line-number="10"><span class="kw">colnames</span>(tracks) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;category&quot;</span>, <span class="st">&quot;col&quot;</span>)</a>
<a class="sourceLine" id="cb20-11" data-line-number="11"><span class="co"># If your list is read from a CSV file which contains empty lines, </span></a>
<a class="sourceLine" id="cb20-12" data-line-number="12"><span class="co"># remove them like this:</span></a>
<a class="sourceLine" id="cb20-13" data-line-number="13">tracks &lt;-<span class="st"> </span><span class="kw">na.omit</span>(tracks)</a>
<a class="sourceLine" id="cb20-14" data-line-number="14"><span class="co"># Order of columns in the CSV files is unknown so identify them by name</span></a>
<a class="sourceLine" id="cb20-15" data-line-number="15">csvStruct &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">time =</span> <span class="st">&quot;Time&quot;</span>)</a>
<a class="sourceLine" id="cb20-16" data-line-number="16">trjs &lt;-<span class="st"> </span><span class="kw">TrajsBuild</span>(tracks<span class="op">$</span>filename, <span class="dt">scale =</span> <span class="fl">.220</span> <span class="op">/</span><span class="st"> </span><span class="dv">720</span>, </a>
<a class="sourceLine" id="cb20-17" data-line-number="17">                   <span class="dt">spatialUnits =</span> <span class="st">&quot;m&quot;</span>, <span class="dt">timeUnits =</span> <span class="st">&quot;s&quot;</span>, </a>
<a class="sourceLine" id="cb20-18" data-line-number="18">                   <span class="dt">csvStruct =</span> csvStruct, <span class="dt">rootDir =</span> <span class="st">&quot;..&quot;</span>)</a></code></pre></div>
</section>
<section id="characterising-multiple-trajectories" class="level3">
<h3>Characterising multiple trajectories</h3>
<p><code>TrajsMergeStats</code> simplifies the construction of a data frame of values, with one row per trajectory. To use it, you need a list of trajectories (which you will probably obtain from a call to <code>TrajsBuild</code>), and a function which calculates statistics for a single trajectory. The following example demonstrates how you might write and use such a function.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># Define a function which calculates some statistics</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># of interest for a single trajectory</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3">characteriseTrajectory &lt;-<span class="st"> </span><span class="cf">function</span>(trj) {</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="co"># Measures of speed</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  derivs &lt;-<span class="st"> </span><span class="kw">TrajDerivatives</span>(trj)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  mean_speed &lt;-<span class="st"> </span><span class="kw">mean</span>(derivs<span class="op">$</span>speed)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">  sd_speed &lt;-<span class="st"> </span><span class="kw">sd</span>(derivs<span class="op">$</span>speed)</a>
<a class="sourceLine" id="cb21-8" data-line-number="8"></a>
<a class="sourceLine" id="cb21-9" data-line-number="9">  <span class="co"># Measures of straightness</span></a>
<a class="sourceLine" id="cb21-10" data-line-number="10">  sinuosity &lt;-<span class="st"> </span><span class="kw">TrajSinuosity</span>(trj)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">  resampled &lt;-<span class="st"> </span><span class="kw">TrajRediscretize</span>(trj, <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">  Emax &lt;-<span class="st"> </span><span class="kw">TrajEmax</span>(resampled)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"></a>
<a class="sourceLine" id="cb21-14" data-line-number="14">  <span class="co"># Periodicity</span></a>
<a class="sourceLine" id="cb21-15" data-line-number="15">  corr &lt;-<span class="st"> </span><span class="kw">TrajDirectionAutocorrelations</span>(resampled, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">  first_min &lt;-<span class="st"> </span><span class="kw">TrajDAFindFirstMinimum</span>(corr)</a>
<a class="sourceLine" id="cb21-17" data-line-number="17"></a>
<a class="sourceLine" id="cb21-18" data-line-number="18">  <span class="co"># Return a list with all of the statistics for this trajectory</span></a>
<a class="sourceLine" id="cb21-19" data-line-number="19">  <span class="kw">list</span>(<span class="dt">mean_speed =</span> mean_speed,</a>
<a class="sourceLine" id="cb21-20" data-line-number="20">       <span class="dt">sd_speed =</span> sd_speed,</a>
<a class="sourceLine" id="cb21-21" data-line-number="21">       <span class="dt">sinuosity =</span> sinuosity,</a>
<a class="sourceLine" id="cb21-22" data-line-number="22">       <span class="dt">Emax =</span> Emax,</a>
<a class="sourceLine" id="cb21-23" data-line-number="23">       <span class="dt">min_deltaS =</span> first_min[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb21-24" data-line-number="24">       <span class="dt">min_C =</span> first_min[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb21-25" data-line-number="25">  )</a>
<a class="sourceLine" id="cb21-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb21-27" data-line-number="27"></a>
<a class="sourceLine" id="cb21-28" data-line-number="28"><span class="co"># Calculate all stats for trajectories in the list</span></a>
<a class="sourceLine" id="cb21-29" data-line-number="29"><span class="co"># which was built in the previous example</span></a>
<a class="sourceLine" id="cb21-30" data-line-number="30">stats &lt;-<span class="st"> </span><span class="kw">TrajsMergeStats</span>(trjs, characteriseTrajectory)</a>
<a class="sourceLine" id="cb21-31" data-line-number="31"><span class="kw">print</span>(stats)</a></code></pre></div>
<pre><code>#&gt;         mean_speed    sd_speed  sinuosity       Emax min_deltaS
#&gt; deltaS 0.061296301 0.009069424  0.9833243 3180.72322         33
#&gt; 2      0.010573501 0.005718966 20.1799815  100.43632         50
#&gt; 3      0.014175447 0.005206138 10.5781943  692.21342         NA
#&gt; 4      0.006245555 0.003005911  6.3442130   67.52479          7
#&gt; 5      0.005344287 0.007936181 60.5580878   14.90601         NA
#&gt; 6      0.019378799 0.005363627  3.3069095   74.33277         35
#&gt; 7      0.014796829 0.002573456  2.4142475  112.93798         NA
#&gt;              min_C
#&gt; deltaS 0.899013229
#&gt; 2      0.303049396
#&gt; 3               NA
#&gt; 4      0.930992488
#&gt; 5               NA
#&gt; 6      0.002917922
#&gt; 7               NA</code></pre>
</section>
<section id="pca-analysis-of-multiple-trajectories" class="level3">
<h3>PCA analysis of multiple trajectories</h3>
<p>Principal components analysis (PCA) is a commonly used statistical technique which can be used to visualise similarities and differences between groups of trajectories. In R, the function <code>prcomp</code> is usually used to perform a PCA. <code>Prcomp</code> will not process data containing <code>NA</code>s (in R, the value <code>NA</code> is used to indicate a ‘<code>N</code>ot <code>A</code>vailable’, or missing, value). However, <code>NA</code>s can be potentially informative, especially when using the first local minimum of the direction autocorrelation function - in this case, an <code>NA</code> indicates that there was no periodicity detected in the trajectory. To avoid discarding this information, <code>Trajr</code> provides a utility function, <code>TrajsStatsReplaceNAs</code>. It is used to replace <code>NA</code> values with some other value, and optionally adds an additional column to the data which flags trajectories which originally contained <code>NA</code> values. It operates on a single column at a time.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co">#---</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co"># Custom PCA plotting function</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">customPcaPlot &lt;-<span class="st"> </span><span class="cf">function</span>(x, xlabs, xcols, <span class="dt">choices =</span> 1L<span class="op">:</span>2L, <span class="dt">ycol =</span> <span class="st">&quot;#ff2222aa&quot;</span>, ...) {</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">  <span class="co"># Draw points</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">  pts &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(x<span class="op">$</span>x[, choices]))</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">  <span class="kw">plot</span>(pts, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, </a>
<a class="sourceLine" id="cb23-7" data-line-number="7">       <span class="dt">xlim =</span> <span class="kw">extendrange</span>(pts[, 1L]), <span class="dt">ylim =</span> <span class="kw">extendrange</span>(pts[, 2L]), </a>
<a class="sourceLine" id="cb23-8" data-line-number="8">       <span class="dt">asp =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb23-9" data-line-number="9">       <span class="dt">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;PC2&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> xcols, ...)</a>
<a class="sourceLine" id="cb23-10" data-line-number="10">  <span class="kw">text</span>(pts, <span class="dt">labels =</span> xlabs, <span class="dt">pos =</span> <span class="dv">1</span>, ...)</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb23-12" data-line-number="12">  <span class="co"># Draw arrows</span></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">  axs &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(x<span class="op">$</span>rotation[, choices])) <span class="op">*</span><span class="st"> </span><span class="fl">3.5</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14">  <span class="kw">text</span>(axs, <span class="dt">labels =</span> <span class="kw">dimnames</span>(axs)[[1L]], <span class="dt">col =</span> ycol, ...)</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">  <span class="kw">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, axs[, 1L] <span class="op">*</span><span class="st"> </span><span class="fl">.8</span>, axs[, 2L] <span class="op">*</span><span class="st"> </span><span class="fl">.8</span>, <span class="dt">length =</span> <span class="fl">.1</span>, <span class="dt">col =</span> ycol)</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="co"># ---</span></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"></a>
<a class="sourceLine" id="cb23-19" data-line-number="19"><span class="co"># Here we are operating on the statistics from the previous example</span></a>
<a class="sourceLine" id="cb23-20" data-line-number="20"></a>
<a class="sourceLine" id="cb23-21" data-line-number="21"><span class="co"># Get rid of NAs in stats because prcomp can't handle them.</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22"><span class="co"># First fix min_deltaS, and add an extra column which flags non-periodic trajectories</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23">pcaStats &lt;-<span class="st"> </span><span class="kw">TrajsStatsReplaceNAs</span>(stats, <span class="st">&quot;min_deltaS&quot;</span>, </a>
<a class="sourceLine" id="cb23-24" data-line-number="24">                                 <span class="dt">replacementValue =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(stats<span class="op">$</span>min_deltaS, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb23-25" data-line-number="25">                                 <span class="dt">flagColumn =</span> <span class="st">&quot;no_first_min&quot;</span>)</a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="co"># Also get rid of NAs in min_C - no need to add another column since it would duplicate no_first_min</span></a>
<a class="sourceLine" id="cb23-27" data-line-number="27">pcaStats &lt;-<span class="st"> </span><span class="kw">TrajsStatsReplaceNAs</span>(pcaStats, <span class="st">&quot;min_C&quot;</span>,</a>
<a class="sourceLine" id="cb23-28" data-line-number="28">                                 <span class="dt">replacementValue =</span> <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(stats<span class="op">$</span>min_C, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb23-29" data-line-number="29"><span class="co"># Perform the PCA</span></a>
<a class="sourceLine" id="cb23-30" data-line-number="30">PCA &lt;-<span class="st"> </span><span class="kw">prcomp</span>(pcaStats, <span class="dt">scale. =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb23-31" data-line-number="31"><span class="co"># Plot it using custom plotting function. Could just call biplot instead</span></a>
<a class="sourceLine" id="cb23-32" data-line-number="32"><span class="kw">customPcaPlot</span>(PCA, tracks<span class="op">$</span>category, tracks<span class="op">$</span>col, <span class="dt">cex =</span> <span class="fl">.8</span>)</a>
<a class="sourceLine" id="cb23-33" data-line-number="33"><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Spider&quot;</span>, <span class="st">&quot;Mimic&quot;</span>, <span class="st">&quot;Ant&quot;</span>), <span class="dt">pch =</span> <span class="dv">16</span>, </a>
<a class="sourceLine" id="cb23-34" data-line-number="34">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">'red'</span>, <span class="st">'blue'</span>, <span class="st">'black'</span>), <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">.02</span>))</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="PCA of trajectory characterisations" /><figcaption><em>PCA of trajectory characterisations</em></figcaption>
</figure>
<p>The plot above shows that the trajectory of the non-mimetic spider (red dot) seems quite different from the trajectories of ant mimicking bugs, ant-mimicking spiders (blue dots) and ants (black dots). The arrows indicate the importance and direction of the parameters that separate the trajectories. From the plot, it seems that the non-mimetic spider varies mainly in speed, (it is faster and more variable) and E<sub>max</sub> (it walks in a straighter path). While these trajectories have been digitised from videos of walking animals, clearly this example does not contain enough data to be meaningful.</p>
</section>
<section id="other-operations" class="level3">
<h3>Other operations</h3>
<p>The function <code>TrajsStepLengths</code> returns a vector containing all of the step lengths in a list of trajectories.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">summary</span>(<span class="kw">TrajsStepLengths</span>(trjs))</a></code></pre></div>
<pre><code>#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#&gt; 1.000e-10 7.813e-05 2.266e-04 2.266e-04 3.243e-04 1.550e-03</code></pre>
</section>
</section>
<section id="random-trajectory-generation" class="level2">
<h2>Random trajectory generation</h2>
<p><code>Trajr</code> allows you to generate random trajectories with the <code>TrajGenerate</code> function. Random trajectories may be used in simulation studies, or simply for experimenting with trajectory analysis, and it has been used to generate the majority of trajectories in this document. By default, <code>TrajGenerate</code> returns a random correlated walk, however, by specifying different arguments, a variety of trajectory types can be created.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Random correlated walk</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co"># Plot it</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="kw">plot</span>(trj)</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw">mtext</span>(<span class="st">&quot;a)&quot;</span>, <span class="dv">3</span>, <span class="fl">-1.3</span>, <span class="dt">adj =</span> <span class="fl">.05</span>)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6"></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co"># Directed walk</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">random =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="kw">plot</span>(trj)</a>
<a class="sourceLine" id="cb26-10" data-line-number="10"><span class="kw">mtext</span>(<span class="st">&quot;b)&quot;</span>, <span class="dv">3</span>, <span class="fl">-1.3</span>, <span class="dt">adj =</span> <span class="fl">.05</span>)</a>
<a class="sourceLine" id="cb26-11" data-line-number="11"></a>
<a class="sourceLine" id="cb26-12" data-line-number="12"><span class="co"># Brownian motion</span></a>
<a class="sourceLine" id="cb26-13" data-line-number="13">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">angularErrorDist =</span> <span class="cf">function</span>(n) stats<span class="op">::</span><span class="kw">runif</span>(n, <span class="op">-</span>pi, pi))</a>
<a class="sourceLine" id="cb26-14" data-line-number="14"><span class="kw">plot</span>(trj)</a>
<a class="sourceLine" id="cb26-15" data-line-number="15"><span class="kw">mtext</span>(<span class="st">&quot;c)&quot;</span>, <span class="dv">3</span>, <span class="fl">-1.3</span>, <span class="dt">adj =</span> <span class="fl">.05</span>)</a>
<a class="sourceLine" id="cb26-16" data-line-number="16"></a>
<a class="sourceLine" id="cb26-17" data-line-number="17"><span class="co"># Levy walk - path lengths follow a cauchy distribution</span></a>
<a class="sourceLine" id="cb26-18" data-line-number="18">trj &lt;-<span class="st"> </span><span class="kw">TrajGenerate</span>(<span class="dt">linearErrorDist =</span> stats<span class="op">::</span>rcauchy)</a>
<a class="sourceLine" id="cb26-19" data-line-number="19"><span class="kw">plot</span>(trj)</a>
<a class="sourceLine" id="cb26-20" data-line-number="20"><span class="kw">mtext</span>(<span class="st">&quot;d)&quot;</span>, <span class="dv">3</span>, <span class="fl">-1.3</span>, <span class="dt">adj =</span> <span class="fl">.05</span>)</a></code></pre></div>
<figure>
<img src="data:image/png;base64,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" alt="Some generated trajectories. a) correlated walk, b) directed walk, c) brownian motion, d) Levy walk." /><figcaption><em>Some generated trajectories. a) correlated walk, b) directed walk, c) brownian motion, d) Levy walk.</em></figcaption>
</figure>
</section>
<section id="and-finally" class="level2">
<h2>And finally…</h2>
<p><code>Trajr</code> is open source, with the source available on <a href="https://github.com/JimMcL/trajr">Github</a>. If you have any problems or suggestions, email <a href="mailto:jim_mclean@optusnet.com.au">jim_mclean@optusnet.com.au</a>.</p>
</section>
<section id="references" class="level2">
<h2>References</h2>
<p>Batschelet, E. (1981). Circular statistics in biology. ACADEMIC PRESS, 111 FIFTH AVE., NEW YORK, NY 10003, 1981, 388.</p>
<p>Benhamou, S. (2004). How to reliably estimate the tortuosity of an animal’s path. Journal of Theoretical Biology, 229(2), 209-220. </p>
<p>Benhamou, S. (2006). Detecting an orientation component in animal paths when the preferred direction is individual-dependent. Ecology, 87(2), 518-528. </p>
<p>Bovet, P., &amp; Benhamou, S. (1988). Spatial analysis of animals’ movements using a correlated random walk model. Journal of Theoretical Biology, 131(4), 419-433. </p>
<p>Cheung, A., Zhang, S., Stricker, C., &amp; Srinivasan, M. V. (2007). Animal navigation: the difficulty of moving in a straight line. Biological Cybernetics, 97(1), 47-61. </p>
<p>Kitamura, T., &amp; Imafuku, M. (2015). Behavioural mimicry in flight path of Batesian intraspecific polymorphic butterfly Papilio polytes. Proceedings of the Royal Society B: Biological Sciences, 282(1809). </p>
<p>Nams, V. O. (2006). Improving Accuracy and Precision in Estimating Fractal Dimension of Animal movement paths. Acta Biotheoretica, 54(1), 1-11. </p>
<p>Shamble, P. S., Hoy, R. R., Cohen, I., &amp; Beatus, T. (2017). Walking like an ant: a quantitative and experimental approach to understanding locomotor mimicry in the jumping spider Myrmarachne formicaria. Proceedings of the Royal Society B: Biological Sciences, 284(1858). </p>
<p>Turchin, P. (1996). Fractal Analyses of Animal Movement: A Critique. Ecology, 77(7), 2086-2090. </p>
<p>Turchin, P. (1998). Quantitative analysis of movement. Sunderland (Mass.): Sinauer assoc.</p>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
