<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jim McLean" />

<meta name="date" content="2023-11-28" />

<title>Animal trajectory analysis with trajr</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Animal trajectory analysis with trajr</h1>
<h4 class="author">Jim McLean</h4>
<h4 class="date">2023-11-28</h4>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#installation-and-setup" id="toc-installation-and-setup">Installation and setup</a></li>
</ul></li>
<li><a href="#trajectories-in-trajr" id="toc-trajectories-in-trajr">Trajectories in <code>trajr</code></a>
<ul>
<li><a href="#creating-trajectories" id="toc-creating-trajectories">Creating Trajectories</a></li>
<li><a href="#scaling-trajectories" id="toc-scaling-trajectories">Scaling Trajectories</a></li>
<li><a href="#smoothing-trajectories" id="toc-smoothing-trajectories">Smoothing trajectories</a></li>
<li><a href="#resampling-trajectories" id="toc-resampling-trajectories">Resampling trajectories</a></li>
<li><a href="#other-trajectory-operations" id="toc-other-trajectory-operations">Other trajectory
operations</a></li>
</ul></li>
<li><a href="#trajectory-analysis" id="toc-trajectory-analysis">Trajectory analysis</a>
<ul>
<li><a href="#analysing-speed" id="toc-analysing-speed">Analysing
speed</a></li>
<li><a href="#analysing-straightness" id="toc-analysing-straightness">Analysing straightness</a>
<ul>
<li><a href="#straightness-index" id="toc-straightness-index">Straightness index</a></li>
<li><a href="#sinuosity" id="toc-sinuosity">Sinuosity</a></li>
<li><a href="#emax" id="toc-emax">E<sub>max</sub></a></li>
<li><a href="#fractal-dimension" id="toc-fractal-dimension">Fractal
dimension</a></li>
<li><a href="#directional-change-dc-and-sddc" id="toc-directional-change-dc-and-sddc">Directional change (DC and
SDDC)</a></li>
<li><a href="#direction-autocorrelation" id="toc-direction-autocorrelation">Direction autocorrelation</a></li>
</ul></li>
</ul></li>
<li><a href="#working-with-multiple-trajectories" id="toc-working-with-multiple-trajectories">Working with multiple
trajectories</a>
<ul>
<li><a href="#building-multiple-trajectories" id="toc-building-multiple-trajectories">Building multiple
trajectories</a></li>
<li><a href="#characterising-multiple-trajectories" id="toc-characterising-multiple-trajectories">Characterising multiple
trajectories</a></li>
<li><a href="#pca-analysis-of-multiple-trajectories" id="toc-pca-analysis-of-multiple-trajectories">PCA analysis of multiple
trajectories</a></li>
<li><a href="#other-operations" id="toc-other-operations">Other
operations</a></li>
</ul></li>
<li><a href="#random-trajectory-generation" id="toc-random-trajectory-generation">Random trajectory
generation</a></li>
<li><a href="#three-dimensional-trajectories" id="toc-three-dimensional-trajectories">Three dimensional
trajectories</a></li>
<li><a href="#performance" id="toc-performance">Performance</a></li>
<li><a href="#and-finally" id="toc-and-finally">And finally…</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>trajr</code> R package is a toolkit for the numerical
characterisation and analysis of the trajectories of moving animals.
Trajectory analysis is applicable in fields as diverse as optimal
foraging theory, migration, and behavioural mimicry (e.g. for verifying
similarities in locomotion). A <em>trajectory</em> is simply a record of
the path followed by a moving animal. <code>Trajr</code> operates on
trajectories in the form of a series of locations (as x, y coordinates)
with times. Trajectories may be obtained by any method which provides
this information, including manual tracking, radio telemetry, GPS
tracking, and motion tracking from videos.</p>
<p>The goal of this package (and this document) is to aid biological
researchers, who may not have extensive experience with R, to analyse
trajectories without being handicapped by a limited knowledge of R or
programming. However, a basic understanding of R is required.</p>
<p>Within this document, the plots are generated by running the code
examples immediately before them. For that reason, most code examples
start with a call to <code>TrajGenerate</code>, which generates a random
trajectory to be plotted. These calls would not occur in an analysis of
real animal trajectories.</p>
<p>If you use <code>trajr</code> in your publications, please cite <a href="http://dx.doi.org/10.1111/eth.12739">McLean DJ, Skowron Volponi
MA. trajr: An R package for characterisation of animal trajectories.
Ethology. 2018;00:1–9. https://doi.org/10.1111/eth.12739</a>.</p>
<div id="installation-and-setup" class="section level3">
<h3>Installation and setup</h3>
<p>Before using any R package, it is first necessary to install and load
it. To install the latest released version of <code>trajr</code>, simply
run:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;trajr&quot;</span>)</span></code></pre></div>
<p>To install the latest development version, which is available on <a href="https://github.com/JimMcL/trajr">GitHub</a>, run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;JimMcL/trajr&quot;</span>)</span></code></pre></div>
<p>Once the package has been installed, you must load it, then it’s
ready for use:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;trajr&quot;</span>)</span></code></pre></div>
<p>Packages only need to be installed once, but they must be loaded in
every session before they can be used.</p>
<p>Once the <code>trajr</code> package has been installed and loaded,
you have access to the set of R functions it provides. All
<code>trajr</code> functions (other than the generic functions
<code>plot</code>, <code>lines</code> and <code>points</code>) start
with the prefix <code>Traj</code>. Several of the functions provided by
<code>trajr</code> do not provide additional analytic functionality,
rather they make it easier to work with multiple trajectories. These
convenience functions are prefixed with <code>Trajs</code>.</p>
</div>
</div>
<div id="trajectories-in-trajr" class="section level2">
<h2>Trajectories in <code>trajr</code></h2>
<p><code>Trajr</code> works with trajectories, where a trajectory is a
simplification of a real path travelled by an animal, and is a set of
2-dimensional spatial coordinates with a third temporal dimension. A
trajectory can also be thought of as a series of steps, each comprised
of a length (L<sub>i</sub>), a turning angle (<span class="math inline">\(\Delta\)</span><sub>i</sub>), and a time. While
trajectories have been modelled in various ways, <code>trajr</code>
works with two theoretical models: <em>correlated random walks</em> in
which the turning angle of each step is the direction of the previous
step ± some error; and <em>directed walks</em>, or compass-based
navigation, in which the angular errors at each step are added to the
“ideal” or compass direction. <code>Trajr</code> generally assumes
correlated random walks, but provides some support for directed
walks.</p>
<p>As of version 1.5.0, <code>trajr</code> provides limited
functionality for characterising 3-dimensional trajectories. See the
section <a href="#three-dimensional-trajectories">Three dimensional
trajectories</a> below.</p>
<div class="float">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAflBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmZjpmZmZmZrZmkNtmtrZmtv+QOgCQOjqQOmaQZgCQZmaQttuQ2/+pqam2ZgC2Zma2/7a2///bkDrb2//b/9vb////tmb/25D/29v//7b//9v///9OV0deAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANoklEQVR4nO2de4ObNhZHSTozaTPtbpu4u23sZNgdvDbf/wsuDwN+CFvwk0CCc/6YOJ4xwrqHK/G6JDmAQDL3CkDcIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIIBBIOBYogTXgUSC3i4MgQSCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCCQQCDowS5+CAQ9IBBITCPQ/uWrtgIQKJbhGyvQ4bV7XsvHN2UNIEw8C5RnyefyHzLQUvEtUJGDnt5NAhmfJAXR4V2gPN99+EYGWiwTCJSnyWcEWipTCFTkn58QaJnYRk/cjT9uEgRaJBMJ5GIVIEQQCCQQCCQQCBSsg4dAYAKBQAKBQAKBQAKBQAKBQME+dggEBhAIJBAIJBAIJBAIJBAIFAaEDoHgFgQCCQQCCQQCCQQChSGRQyC4AYFAAoFAAoFAAoFAAoFAYVDgEAiuQSCQQCCQQCCQQCBQGBY3BIIrEAgkEAgkEAgkEAgkEAgUBoYNgeASBAIJBAIJBAKJaQXKkuTDNzdrAkEwNGrjBdolyef9L+/54bXnaRkIFCOTCbR7eq8eGJbnafngOQerAiEwlUBV3tl/KgXKLp+ZyhMLo2Y6gcpHph7/k5OBlsVkQ1ja5J1aJQerAiEw3SQ6rXe/st4nziFQhAwOGseB4BwEAgkEAgkEAgkEAgkEAoXhMUMgOAOBQAKBQAKBQAKBQGFEyBAIOhAIJBAIJBAIJBAIJEZch4xA0FJGbKhDCAQtp4gNUgiBoKWNmL1C263p825AoNg4i5ilQlsyEHRcRMxGoS1D2Eo5/G148zpgVlkIgVaJ8WbQ24BZhBCB1shxY7qbzxCw/iTUzJ4RaI1kXzbPt+8aA2ZWqNv5QqAVcvzrLTWUdTIHzPTu1vxrBFoJ+z+MFQ16AnY/jgi0Qr6/5fmuLI6xS5KuNk9vvO7ujSHQ+igSUPHj5Wt+/PN8HLsTr/Nfbft/1b3OTiWi+gpvWIFAgfK91Oa4eXrf/3xeGsxKoO2291ft68NrcpqiF3t7l9XHBoFAYXL4vfon+/At++kl6fbGbAaqa31MAh1+O3fm8n+DQKAwSZsShM/5/97ztB1l7sar/uWtP8yB1k7a7I09CFffrxFoxWTF+NVmoEfhstjJ714X06AKYQaEQBFQ1vpuXt8P183k2fSx9nU5Q5dWzGKNIDDuhqtPnx6BeovPDwKBouJeuPr96ctAPZV7B4FAUTEyXOY5UF2CXgSBYqL/ug37z50J9MIkemX0RKt38mz63NkQZrhaZDAIFBPmaD3Sh0k0nDBfNzbsc0yiV8zYaDGJhgqnAjUHou9OotPmco+0568QKCJugvVw9mz44KCIlxfVHl7LyTYCLYCrYNnqM16geppUnfNAoAVwGSxrfcZfD9TsqO2e3lMeeRk/o4M19orEdkdt90wGWgAuBcqtrolutCl0Q6DoOYvVgOHr6pMDI56e9DpuECh62ljZz56vP5k7jzgCxUP/RfO2n7x+7QAEiodTrIb7g0BQMj5WCAR5FasR2ef0SeNrByBQNCTDJ8/dRw2vuyNBCggUDclYfXozUHmmVL2kA4GiYbw/d4Yw2SEEigTppNO9OVCqXRWNQHGgxalXoKw6k6HcYohAMaCe8+6/tbk2JxufghAoAuQg9eyFGUowSouGIHFwyQ3HgdaLkyu2EGi1uIkPAq0UVxeMItA6cRYcBFojDq9XR6AV4jIyCLQ63N4ug0Brw2OUEWj5OL9bD4FWhfuYINCK8HGzMAKtBy8BQaC14KlWAQKtA2+lLhBoFfiLBQKtAJ+VdhBo+XgNBAItHc+FvhBo4fiOAgItGv91BhFoyUwQAgRaLpOUOUWgxTJN/yPQQpmqyjICLZPJOh+B4uHwt+1fTljkHYHiIbUsdDHpMwIQKBqOm3uF3zum7XcEiobsi82TSKd+RAkCxcLxr7f0cdGUyTsdgWJh/0d+eH1Qc3CGJyQhUCx8f8vz3f1yX3P0OAJFQpGAih8v9UNGjYlonge0jRWofaxqfyFOBHLJ93L6U5es3L+YBJqpu0dnoP6nPPHEQg8cfq/+yYpp9PHPf9wKNFtvjx/Cjo92KhHIIWmzVT4XA9jtEDZfXwtzoOzBcS0E8sL+l/drgYaln9GPxTDCJDo2qlx0YVAyqKud6oNAUXKRgar0Y9XXW7e559R8z2vHiwaXnAl0Gr0s+tqHPTkCRU5y88KAl8xjahiBIuNs8tzf2T7tyREoZpLe/9R4zTymdhEoJq723W96ewp7cgSKlpvePXtjIndu1gOBosFw6LB9Z0p9EChOTF3bvDepPggUI+YzF8k0k+bbZs2vHS8a3NHTr9t5+huBIsOQfmbJPA0IFBcmfWZYjQ4EionL9DNr5mlAoHi41meu9bgAgaKh689A3KlAoEjo0k9I+iBQLJylnxnXwgACxUCdfoKYNF+DQBFw0mfu1TCCQB6wrwRlQxJk5mlAIA/YVoKyIQnZnjxYgdxuwxNjWwnqITHc3huoQC634cmxqwT1iAjkKQlTIGfb8BzYVYK6TyT25KEK5GYb9s52a5rf2lSCukcMA1dHkAK52IZ9YhanwaISVD9RyVMSpEDqNuyL++Kc6CpB7ZJhA3FcqedEkAJ12/Dht5FbslOsxGloK0Flz0NWP0Z5SkIUqNuGD69jhwInDBLnxFklKHv/Y7UnD1Ogdhs+/uvHLBloux1/+O6sElTx2mIIi3Lg6ghQoPNteNohrMs4rrpi98CguOUpCVCg8214GoFuhypXXWGup3pqI3578iAFOsevQP1zHBfrXkyi+zPQIuQpWaVAjyfHTrpid1WKrlv6UuzJVyRQOWDY71X5C/AyBq6OwAVSuS1abVfC2tO6L0yekkUK9LjW+SONfKz7Au3JFyXQ8BL5/X/tet2rdpbozwIEkp+sYPq003Vvl75Eg2IVyPkTOa5mSo6WejlnRqDRi3a1SN8PcmkW7mb51+uJQKMXLS7JszY97ckLuXlLW2KQjBfouKm7ufd8ud3iHu0pnUVynln52E8a39dWKERGC5Q2R1mznsOtdou76eo7o9Q83T9Yo3tHDxysT2CMFei4abXpu4PCZnHtnMNmlJqz+y01CvgbeGKsQIfX9jRhdjmIDZroJt35hcf/JpZ/N/QqMPub0O5/r8dfGYFaHGWgIE4NDb0JzaiR1feY/au6R5gDnVKQNgea72GfLSNvQjvTyHormP27umf8Xljz3ObezTeW3pJuQqvGYPu/Ht1OsERxHMgrDm5CayZfD/8wki4ZAgI5vAnt4ew9ki4ZAgI1N6GVB0ad3E99Zzcwki4ZwuoFam9CS58Lh1yWdDBYFEeXDGL1ArU3oZX/uXcTxQhu5kZxdMkg1i7QqBtJh+L6brOQWLtAaXPYvLwJ7VevFUGU+13DZe0CnbH/NE1FmWVZhEAN+58nu4va+rhRBCBQw64cyKYtShR0/V5LEGh2xhSRCQcECoY4LUKggIhxboRAARLTkIZAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIIFAIOFTIFgD/gSy9WwhbdAIAtGI1ggC0YjUCALRiNQIAtGI1AgC0YjUCALRiNQIAtGI1AgC0YjUCOceQAKBQAKBQAKBQAKBQAKBQAKBQAKBQAKBQAKBQAKBQAKBQAKBQGIGgbIk+fDNbxPHTTLN47x3T++eW9i/JMmz5zbytOiur+M+Or1AWWFP5teg46ZYfuq/34ttwbdAWdHA4dXzN0nLkIw0aHKBjpsyM+y8dsn+peyM9OObz0YKDq++Bap7y/M3OW7KaIwMyeQCTRXc3HeaK0if/u1ZoP0n398hj06gqkuyCQTa+W6j+Cq+50DZxx+v/mdzUQ1hdV7wnx2KHvHc7+Xw4lugNCm2gjpD+ETYr1msQJn3OXRayONdoA9T5OsyV+9fxm1vSx3CvOef+ot4F6jqp3re6A1pWrrQSXTq/yhQeip14jW29YbmeSotDQqL3I0vgus1rB2+M9DhtfwinvN1vU2PbGSRBxLHjufD8X4kupxo1ducR6KaA1W53/MU+jS6+N/Tm+BURjbFSZnd+EY4mQoSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCAQSCKRw3FxWATn8OkFJw7BAIIX0ukpN5r3YQmggkEBdveec65S0fBBoIGVttcNrXQslq+rqfCnrqJYF5avSa2tLQQg0kLLaU2NJWWdt/1JVxS9Uqsr2TVB+NiwQaCjZxx+nqXKViKrKXqcfX73XwwwPBBrMrikgXE2BOm2qH83othoQaDBtTfcrdxAIbDhu/nmqZ0oGyhFoOOnTf09VU09zoFuL1gQCDaRMO01J5Xov7MId9sLgPruqcHM9ja6PA10IxHEgsOf2SPTtO0sHgRQ4F4ZAEpyNRyDQQCCQ+D9xQH/kOiGzowAAAABJRU5ErkJggg==" alt="A correlated random walk with 5 steps. The direction of step i is the direction of step (i - 1) + \Deltai." />
<div class="figcaption"><em>A correlated random walk with 5 steps. The
direction of step <span class="math inline">\(i\)</span> is the
direction of step <span class="math inline">\((i - 1) +
\Delta\)</span><sub>i</sub>.</em></div>
</div>
<div class="float">
<img src="data:image/png;base64,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" alt="A directed walk with 5 steps. The direction of step i is the compass direction (here 0^\circ) + \Deltai." />
<div class="figcaption"><em>A directed walk with 5 steps. The direction
of step <span class="math inline">\(i\)</span> is the compass direction
(here 0<span class="math inline">\(^\circ\)</span>) + <span class="math inline">\(\Delta\)</span><sub>i</sub>.</em></div>
</div>
<p>Within <code>trajr</code>, trajectories are represented by R objects
with class <code>Trajectory</code>. The <code>TrajFromCoords</code>
function is used to create a <code>Trajectory</code> object from a set
of x-y coordinates, with optional times.</p>
<!-- NOTE the echo=-1 removes the first line of code from the output, as I want it to run to make the plot look pretty, but it's not relevant to a reader -->
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Define x, y, and time coordinates</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="dv">4</span>), </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                     <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># Create a trajectory from the coordinates</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajFromCoords</span>(coords)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">plot</span>(trj)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Trajectory created from coordinates." />
<div class="figcaption"><em>Trajectory created from
coordinates.</em></div>
</div>
<div id="creating-trajectories" class="section level3">
<h3>Creating Trajectories</h3>
<p>In practice, trajectory coordinates are typically read from a data
file such as a CSV file, and then passed in to the
<code>TrajFromCoords</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;mycoords.csv&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajFromCoords</span>(coords)</span></code></pre></div>
<p><code>TrajFromCoords</code> assumes that the first column in
<code>coords</code> contains x values, the second contains y values, and
that points were sampled at a constant sampling frequency of 50
points/second. The help page for <code>TrajFromCoords</code> describes
how to alter these defaults - run <code>?TrajFromCoords</code> to access
the help page. Many functions (including <code>TrajFromCoords</code>)
contain code examples as part of their help information. You can also
display and run an example by calling the <code>example</code> function:
i.e. <code>example(&quot;TrajFromCoords&quot;)</code>.</p>
</div>
<div id="scaling-trajectories" class="section level3">
<h3>Scaling Trajectories</h3>
<p>Trajectories may need to be scaled before analysis. For instance,
when a trajectory is digitised from video, the spatial units will be
pixels, and require conversion to more meaningful units such as metres.
Trajectories are scaled by calling <code>TrajScale</code>, specifying
the scale factor and the abbreviation of the transformed units. In the
case of a trajectory digitised from a video, you can calculate scale as
<span class="math inline">\(width^{m}/width^{p}\)</span>, where <span class="math inline">\(width^{m}\)</span> is the width of an object in
metres, and <span class="math inline">\(width^{p}\)</span> is the width
of the same object in pixels, as measured from the video. A commonly
used method to determine the scale is to include a measuring tape in the
video, then measure the number of pixels in a length of the tape.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Example 1</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;H. pahangensis.csv&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajFromCoords</span>(coords, <span class="at">spatialUnits =</span> <span class="st">&quot;pixels&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># A 10 mm (= .01 m) object had length 47 pixels in the video, scale to metres</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajScale</span>(trj, .<span class="dv">01</span> <span class="sc">/</span> <span class="dv">47</span>, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># Example 2</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;A. argentifasciata.csv&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># In this video, a 20 cm (= .2 m) object had length 1800 pixels, scale to metres</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajScale</span>(trj, .<span class="dv">2</span> <span class="sc">/</span> <span class="dv">1800</span>, <span class="st">&quot;m&quot;</span>)</span></code></pre></div>
</div>
<div id="smoothing-trajectories" class="section level3">
<h3>Smoothing trajectories</h3>
<p>Many trajectories will suffer from noise which may bias the results
of some analyses. The <code>TrajSmoothSG</code> function reduces high
frequency noise while preserving the shape of the trajectory, by
applying a Savitzky-Golay smoothing filter. It requires two arguments
(in addition to the trajectory), <code>n</code>, the filter order, and
<code>m</code>, the filter length (which must be odd). Refer to the help
for the function <code>sgolayfilt</code> (run
<code>?signal::sgolayfilt</code>) for details of the filter
function.</p>
<p>There are some issues which should be considered when deciding
whether to smooth and by how much. If duplicate points are omitted from
a trajectory (i.e. multiple points representing the same stopped
location are not explicitly specified), smoothing is likely to result in
a segment spanning the gap which is decreasing in velocity, but not
stopped. Similarly, smoothing (or too much smoothing) may eliminate
short periods of zero (or near-zero) velocity.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="dv">200</span>, <span class="at">random =</span> <span class="cn">TRUE</span>, <span class="at">angularErrorSd =</span> .<span class="dv">25</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Plot original trajectory</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">plot</span>(trj, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Create a smoothed trajectory, filter order 3, length 31</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span> <span class="fu">TrajSmoothSG</span>(trj, <span class="at">p =</span> <span class="dv">3</span>, <span class="at">n =</span> <span class="dv">31</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Plot it in slightly transparent red</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">lines</span>(smoothed, <span class="at">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Smoothed&quot;</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Effect of smoothing a trajectory." />
<div class="figcaption"><em>Effect of smoothing a trajectory.</em></div>
</div>
</div>
<div id="resampling-trajectories" class="section level3">
<h3>Resampling trajectories</h3>
<p><code>trajr</code> provides functions to resample a trajectory to a
fixed step length or a fixed step time.</p>
<p>Some functions require a <code>Trajectory</code> with a fixed step
length. The process of resampling a trajectory to a fixed step length is
called <em>rediscretization</em>. The function
<code>TrajRediscretize</code> implements trajectory resampling using the
algorithm described by Bovet &amp; Benhamou (1988). There are no clear
guidelines for choosing a suitable step length for rediscretization: too
small a step length leads to oversampling, leading to high
autocorrelation between steps and high variability; too large a step
length results in undersampling and loss of information. See Turchin
(1998) section 5.2.2 for a discussion. By default, rediscretization
discards time (and hence speed) information, however setting
<code>simConstantSpeed = TRUE</code> simulates a constant speed
trajectory with (approximately) the same duration (and hence average
speed) as the original trajectory.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="dv">10</span>, <span class="at">stepLength =</span> <span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># Plot original trajectory with dots at trajectory coordinates</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">plot</span>(trj, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">points</span>(trj, <span class="at">draw.start.pt =</span> <span class="cn">FALSE</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># Resample to step length 1</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>resampled <span class="ot">&lt;-</span> <span class="fu">TrajRediscretize</span>(trj, <span class="dv">1</span>)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># Plot rediscretized trajectory in red</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="fu">lines</span>(resampled, <span class="at">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="fu">points</span>(resampled, <span class="at">type =</span> <span class="st">&#39;p&#39;</span>, <span class="at">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Rediscretized&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Rediscretization of trajectory with \mu_{L} = 2 to step length 1." />
<div class="figcaption"><em>Rediscretization of trajectory with <span class="math inline">\(\mu_{L} = 2\)</span> to step length <span class="math inline">\(1\)</span>.</em></div>
</div>
<p>The function <code>TrajResampleTime</code> linearly interpolates
points along a trajectory to create a new trajectory with fixed step
time intervals.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Generate trajectory with a point every 2 hours and highly variable speed (which equates to step length)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="dv">10</span>, <span class="at">stepLength =</span> <span class="dv">1</span>, <span class="at">fps =</span> .<span class="dv">5</span>, <span class="at">timeUnits =</span> <span class="st">&quot;hours&quot;</span>, <span class="at">linearErrorSd =</span> .<span class="dv">8</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># Plot original trajectory with dots at trajectory coordinates</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">plot</span>(trj, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">points</span>(trj, <span class="at">draw.start.pt =</span> <span class="cn">FALSE</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># Resample to 1 hourly steps</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>resampled <span class="ot">&lt;-</span> <span class="fu">TrajResampleTime</span>(trj, <span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Plot rediscretized trajectory in red</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="fu">lines</span>(resampled, <span class="at">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">points</span>(resampled, <span class="at">type =</span> <span class="st">&#39;p&#39;</span>, <span class="at">col =</span> <span class="st">&quot;#FF0000A0&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Original&quot;</span>, <span class="st">&quot;Resampled&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">inset =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.02</span>))</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Resampling of trajectory with step duration 1 hour." />
<div class="figcaption"><em>Resampling of trajectory with step duration
<span class="math inline">\(1\)</span> hour.</em></div>
</div>
</div>
<div id="other-trajectory-operations" class="section level3">
<h3>Other trajectory operations</h3>
<p>This table lists trajectory operations not otherwise addressed by
this document. Refer to the help for each function for information.</p>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>TrajRotate</code></td>
<td align="left">Rotates a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajTranslate</code></td>
<td align="left">Translates a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajReverse</code></td>
<td align="left">Reverses a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajGetFPS</code></td>
<td align="left">Returns the frames-per-second of a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajGetNCoords</code></td>
<td align="left">Returns the number of coordinates of a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajGetUnits</code></td>
<td align="left">Returns the spatial units of a trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajGetTimeUnits</code></td>
<td align="left">Returns the temporal units of a trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajStepLengths</code></td>
<td align="left">Returns the lengths of each step within the
trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajLength</code></td>
<td align="left">Returns the total length of the trajectory (or a
portion)</td>
</tr>
<tr class="even">
<td align="left"><code>TrajDistance</code></td>
<td align="left">Returns the straight-line distance from the start to
the end of the trajectory (or a portion)</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajDuration</code></td>
<td align="left">Returns the temporal duration of the trajectory (or a
portion)</td>
</tr>
<tr class="even">
<td align="left"><code>TrajMeanVelocity</code></td>
<td align="left">Returns the mean velocity vector of the trajectory (or
a portion)</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajAngles</code></td>
<td align="left">Returns the turning angles (radians) of a
trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>TrajMeanVectorOfTurningAngles</code></td>
<td align="left">Returns the mean vector of the turning angles</td>
</tr>
<tr class="odd">
<td align="left"><code>TrajExpectedSquareDisplacement</code></td>
<td align="left">Returns the expected square displacement of a
correlated random walk</td>
</tr>
<tr class="even">
<td align="left"><code>TrajFromTrjPoints</code></td>
<td align="left">Creates a trajectory from a subset of the points in
another trajectory</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="trajectory-analysis" class="section level2">
<h2>Trajectory analysis</h2>
<p>Once you have obtained a correctly scaled <code>Trajectory</code>
object, you may call various functions to analyse the trajectory.
Broadly speaking, analysis may be divided into measures of speed or
acceleration, and measures of straightness or tortuosity.</p>
<div id="analysing-speed" class="section level3">
<h3>Analysing speed</h3>
<p>The functions <code>TrajVelocity</code> and
<code>TrajAcceleration</code> estimate velocity and acceleration as
vectors at each point along a trajectory. Velocity is calculated using
first-order finite differences, and acceleration uses second-order
finite differences. The <code>TrajDerivatives</code> function calculates
speed and change in speed along a <code>Trajectory</code>. If the
trajectory is noisy, it should be smoothed before the derivatives are
calculated (see <a href="#smoothing-trajectories">Smoothing
trajectories</a>, but take note of the caveats described there).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># Smooth before calculating derivatives</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>smoothed <span class="ot">&lt;-</span> <span class="fu">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">101</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># Calculate speed and acceleration</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>derivs <span class="ot">&lt;-</span> <span class="fu">TrajDerivatives</span>(smoothed)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># Plot change-in-speed and speed</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">plot</span>(derivs<span class="sc">$</span>acceleration <span class="sc">~</span> derivs<span class="sc">$</span>accelerationTimes, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Time (s)&#39;</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&#39;Change in speed (&#39;</span>, m<span class="sc">/</span>s<span class="sc">^</span><span class="dv">2</span>, <span class="st">&#39;)&#39;</span>)))</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">lines</span>(derivs<span class="sc">$</span>speed <span class="sc">~</span> derivs<span class="sc">$</span>speedTimes, <span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;Speed (m/s)&#39;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&#39;lightGrey&#39;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Speed and acceleration over time." />
<div class="figcaption"><em>Speed and acceleration over time.</em></div>
</div>
<p>Once the trajectory speed has been obtained, it is simple to
calculate values such as mean, maximum, minimum or standard deviation of
speed: <code>mean(derivs$speed)</code>, <code>max(derivs$speed)</code>,
<code>min(derivs$speed)</code>, or <code>sd(derivs$speed)</code>.
Similarly, calculations excluding periods when speed drops below (or
above) some value are also straightforward, for example:
<code>mean(derivs$speed[deriv$speed &gt; STOPPED_SPEED])</code>. In
addition, the function <code>TrajSpeedIntervals</code> allows you to
determine the time intervals within the trajectory that satisfy a speed
constraint, either slower than some speed, faster than a speed, or both.
This may be useful, for example, when testing how often, or for how
long, a flying insect hovers, or a running insect stops, i.e. when its
speed drops below some threshold. The object returned by a call to
<code>TrajSpeedIntervals</code> can be plotted.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Simulate a flying bee</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="dv">100</span>, <span class="at">angularErrorSd =</span> <span class="fl">0.3</span>, <span class="at">stepLength =</span> <span class="fl">0.001</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co"># Smooth the trajectory</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajSmoothSG</span>(trj, <span class="dv">3</span>, <span class="dv">51</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co"># Calculate hovering intervals</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">TrajSpeedIntervals</span>(trj, <span class="at">slowerThan =</span> <span class="dv">2</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="fu">print</span>(intervals)</span></code></pre></div>
<pre><code>#&gt;   startFrame startTime stopFrame  stopTime  duration
#&gt; 1         11 0.2337088        27 0.5488033 0.3150945
#&gt; 2         85 1.7073675        94 1.8866781 0.1793107</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Plot speed over time with hovering intervals highlighted</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(intervals)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Speed over time, hovering intervals (speed &lt; 2 m/s) highlighted." />
<div class="figcaption"><em>Speed over time, hovering intervals (speed
&lt; 2 m/s) highlighted.</em></div>
</div>
</div>
<div id="analysing-straightness" class="section level3">
<h3>Analysing straightness</h3>
<div id="straightness-index" class="section level4">
<h4>Straightness index</h4>
<p>Various methods to measure the straightness, or conversely,
tortuosity, of trajectories are available within <code>trajr</code>. The
simplest is <span class="math inline">\(D/L\)</span>, where <span class="math inline">\(D\)</span> is the distance from the start to the
end of the trajectory, and <span class="math inline">\(L\)</span> is the
length of the trajectory. This straightness index is calculated by the
function <code>TrajStraightness</code>, and is a number ranging from 0
to 1, where 1 indicates a straight line. Benhamou (2004) considers the
straightness index to be a reliable measure of the efficiency of a
directed walk, but inapplicable to random trajectories. Batschelet
(1981) considers this straightness index to be an approximation of
<em>r</em>, which is the length of the mean vector of turning angles
after rediscretizing to a constant step length. <em>r</em> can be
calculated by calling
<code>Mod(TrajMeanVectorOfTurningAngles(trj))</code>, assuming
<code>trj</code> is a Trajectory with constant step length.</p>
<p>Within this section, most of the figures show the appropriate
statistic plotted for multiple randomly generated correlated random
walks which vary in the standard deviations of angular errors, <span class="math inline">\(\sigma_{\Delta}\)</span> (higher values of <span class="math inline">\(\sigma_{\Delta}\)</span> produce more tortuous
trajectories).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Generate some trajectories for use in examples</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Random magnitude of angular errors</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>angularErrorSd <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co"># Generate some trajectories with varying angular errors</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>trjs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">TrajGenerate</span>(<span class="dv">500</span>, <span class="at">stepLength =</span> <span class="dv">2</span>, </span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>                                             <span class="at">angularErrorSd =</span> angularErrorSd[i]))</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co"># Rediscretize each trajectory to a range of step sizes</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>stepSizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>reds <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stepSizes, <span class="cf">function</span>(ss) <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">TrajRediscretize</span>(trjs[[i]], ss)))</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Calculate straightness (D/L) for all of the rediscretized trajectories</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">TrajStraightness</span>(rtrjs[[i]])))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co"># Calculate alternate straightness (r) for all of the rediscretized trajectories</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">Mod</span>(<span class="fu">TrajMeanVectorOfTurningAngles</span>(rtrjs[[i]]))))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co"># Plot both indices on the same graph</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rep</span>(angularErrorSd, <span class="dv">3</span>), rs,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;darkgreen&#39;</span>, n)),</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[Delta]), <span class="at">ylab =</span> <span class="st">&quot;Straightness&quot;</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">range</span>(<span class="fu">c</span>(ds, rs)))</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">rep</span>(angularErrorSd, <span class="dv">3</span>), ds,</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">3</span>, <span class="at">cex =</span> .<span class="dv">8</span>,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;darkgreen&#39;</span>, n)))</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">italic</span>(r)), <span class="st">&quot;D/L&quot;</span>, <span class="fu">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes)), </span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">16</span>, <span class="dv">16</span>), </span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Two straightness indices (r, dots, and D/L, crosses) as a function of \sigma_{\Delta}, plotted for several different step sizes (linear axes)." />
<div class="figcaption"><em>Two straightness indices (r, dots, and D/L,
crosses) as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>, plotted for several
different step sizes (linear axes).</em></div>
</div>
</div>
<div id="sinuosity" class="section level4">
<h4>Sinuosity</h4>
<p>The sinuosity index defined by Benhamou (2004) may be an appropriate
measure of the tortuosity of a random search path. Sinuosity is a
function of the mean cosine of turning angles, and is a corrected form
of the original sinuosity index defined by Bovet &amp; Benhamou (1988).
The function <code>TrajSinuosity2</code> calculates the corrected form
while <code>TrajSinuosity</code> calculates the original index. In
general, <code>TrajSinuosity2</code> should be used rather than
<code>TrajSinuosity</code>. The uncorrected form of sinuosity
(<code>TrajSinuosity1</code>) should be calculated for a trajectory with
a constant step length, so trajectories may first require <a href="#resampling-trajectories">rediscretization</a>. In the absence of
a biologically meaningful step size, rediscretizing to the mean step
length of the trajectory will produce a trajectory with approximately
the same shape and number of steps as the original.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Calculate sinuosity for all of the rediscretized trajectories</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>sins <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">TrajSinuosity2</span>(rtrjs[[i]])))</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># Plot sinuosity vs angular error</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rep</span>(angularErrorSd, <span class="dv">3</span>), sins,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;darkgreen&#39;</span>, n)),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="at">ylab =</span> <span class="st">&quot;Sinuosity&quot;</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">paste</span>(<span class="st">&quot;Step length&quot;</span>, stepSizes), </span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Sinuosity as a function of \sigma_{\Delta}, plotted for several different step sizes (linear axes)." />
<div class="figcaption"><em>Sinuosity as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>, plotted for several
different step sizes (linear axes).</em></div>
</div>
</div>
<div id="emax" class="section level4">
<h4>E<sub>max</sub></h4>
<p><span class="math inline">\(E^{a}_{max}\)</span> is a dimensionless
estimate of the maximum expected displacement of a trajectory. Larger
<span class="math inline">\(E^{a}_{max}\)</span> values (approaching
infinity) represent straighter paths (Cheung, Zhang, Stricker, &amp;
Srinivasan, 2007). <span class="math inline">\(E^{b}_{max}\)</span> is
<span class="math inline">\(E^{a}_{max}\)</span> multiplied by the mean
step length, so gives the maximum possible displacement in spatial
units. <code>TrajEmax</code> returns the value of <span class="math inline">\(E^{a}_{max}\)</span> for a trajectory, or <span class="math inline">\(E^{b}_{max}\)</span> if the argument
<code>eMaxB</code> is <code>TRUE</code>. <code>TrajEmax</code>
differentiates between random and directed walks; see
<code>?TrajEmax</code> for details.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Calculate Emax for all of the rediscretized trajectories (from the previous example)</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>emaxs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">TrajEmax</span>(rtrjs[[i]])))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>emaxs[emaxs <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># Avoid warnings when plotting on log axes</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># Plot Emax vs angular error on log axes</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rep</span>(angularErrorSd, <span class="dv">3</span>), emaxs,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>     <span class="at">log =</span> <span class="st">&#39;xy&#39;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>, </span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, n), <span class="fu">rep</span>(<span class="st">&#39;darkgreen&#39;</span>, n)),</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="at">ylab =</span> <span class="fu">expression</span>(E[max]))</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Emax as a function of \sigma_{\Delta} (logarithmic axes)." />
<div class="figcaption"><em>E<sub>max</sub> as a function of <span class="math inline">\(\sigma_{\Delta}\)</span> (logarithmic
axes).</em></div>
</div>
</div>
<div id="fractal-dimension" class="section level4">
<h4>Fractal dimension</h4>
<p>Fractal dimension has been considered a promising measure of
straightness or tortuosity, varying between 1 (straight line movement)
and 2 (Brownian motion). However, several studies have found it
inappropriate for use with animal trajectories, as animal trajectories
are not fractal curves, and the fractal dimension of a non-fractal curve
depends critically on the range of step sizes used to calculate it
(Nams, 2006; Turchin, 1996). Nonetheless, fractal dimension continues to
be used, and the <code>TrajFractalDimension</code> function, by default,
calculates fractal dimension using the modified dividers method to
account for truncation error (Nams, 2006). See
<code>?TrajFractalDimension</code> and
<code>?TrajFractalDimensionValues</code> for more information.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Use the same range of step sizes for all trajectories</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>stepSizes <span class="ot">&lt;-</span> <span class="fu">TrajLogSequence</span>(.<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">10</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># Fractal dimension is a slow calculation, so just plot a subset </span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># of trajectories from the previous example</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>fn <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="dv">4</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>use <span class="ot">&lt;-</span> <span class="fu">sample.int</span>(fn, <span class="at">n =</span> <span class="fu">length</span>(angularErrorSd))</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>fangularErrorSd <span class="ot">&lt;-</span> angularErrorSd[use]</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># Calculate fractal dimension for all of the rediscretized trajectories</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reds, <span class="cf">function</span>(rtrjs) <span class="fu">sapply</span>(use, <span class="cf">function</span>(i) {</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  <span class="fu">TrajFractalDimension</span>(rtrjs[[i]], stepSizes)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>}))</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># Plot fractal dimension vs angular error</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rep</span>(fangularErrorSd, <span class="dv">3</span>), d,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>, </span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&#39;red&#39;</span>, fn), <span class="fu">rep</span>(<span class="st">&#39;blue&#39;</span>, fn), <span class="fu">rep</span>(<span class="st">&#39;darkgreen&#39;</span>, fn)),</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="at">ylab =</span> <span class="st">&quot;Fractal dimension&quot;</span>)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Step length 1&quot;</span>, <span class="st">&quot;Step length 2&quot;</span>, <span class="st">&quot;Step length 10&quot;</span>), </span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Fractal dimension as a function of \sigma_{\Delta}." />
<div class="figcaption"><em>Fractal dimension as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>.</em></div>
</div>
</div>
<div id="directional-change-dc-and-sddc" class="section level4">
<h4>Directional change (DC and SDDC)</h4>
<p>Directional change is defined as the change in direction over time,
and has been used to assess locomotor mimicry in butterflies (Kitamura
&amp; Imafuku, 2015). Directional change is defined for each pair of
steps, so a trajectory (or a portion thereof) may be characterised by
the mean (<code>DC</code>) and standard deviation (<code>SDDC</code>) of
all directional changes. <code>DC</code> may be used as an index of
nonlinearity, and <code>SDDC</code> as a measure of irregularity. The
directional changes for a trajectory are calculated by the function
<code>TrajDirectionalChange</code>, so <code>SD</code> may be calculated
as <code>mean(TrajDirectionalChange(trj))</code>, and <code>SDDC</code>
as <code>sd(TrajDirectionalChange(trj))</code>. Note that directional
change cannot be calculated on rediscretized trajectories, as
rediscretizing discards time information.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Calculate DC and SDDC for all of the original trajectories (from above)</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>dcs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">mean</span>(<span class="fu">TrajDirectionalChange</span>(trjs[[i]])))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>sddcs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) <span class="fu">sd</span>(<span class="fu">TrajDirectionalChange</span>(trjs[[i]])))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># Plot DC vs angular error</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="fu">plot</span>(angularErrorSd, dcs,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(sigma[<span class="st">&quot;angular error&quot;</span>]), <span class="at">ylab =</span> <span class="st">&quot;DC&quot;</span>)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="fu">points</span>(angularErrorSd, sddcs, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> .<span class="dv">8</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;DC&quot;</span>, <span class="st">&quot;SDDC&quot;</span>), </span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="DC and SDDC as a function of \sigma_{\Delta}." />
<div class="figcaption"><em>DC and SDDC as a function of <span class="math inline">\(\sigma_{\Delta}\)</span>.</em></div>
</div>
</div>
<div id="direction-autocorrelation" class="section level4">
<h4>Direction autocorrelation</h4>
<p>The direction autocorrelation function was devised to detect and
quantify regularities within trajectories, in the context of locomotor
mimicry by ant-mimics (Shamble, Hoy, Cohen, &amp; Beatus, 2017). It
detects wave-like periodicities, and provides an indication of their
wavelength and amplitude, so can be used to detect, for example, the
winding movements of trail-following ants. The function <span class="math inline">\(C(\Delta s)\)</span> is applied to a rediscretized
trajectory, and calculates the differences in step angles at all steps
separated by <span class="math inline">\(\Delta\)</span>, for a range of
<span class="math inline">\(\Delta s\)</span>. The position of the first
local minimum in <span class="math inline">\(C(\Delta s)\)</span>
(i.e. the 2-dimensional position <span class="math inline">\((\Delta s,
c(\Delta s))\)</span>) may be used to characterise the periodicity
within a trajectory.</p>
<p>The function is calculated by
<code>TrajDirectionAutocorrelations</code>, and the result may be
plotted. The position of the first local minimum (or maximum) is
calculated by <code>TrajDAFindFirstMinimum</code> (or
<code>TrajDAFindFirstMaximum</code>). Some trajectories will not have a
first local minimum (or maximum), which indicates that they do not
contain regular changes in direction.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="dv">1000</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fu">TrajDirectionAutocorrelations</span>(trj)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">plot</span>(corr)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Direction autocorrelation of a random trajectory with first local minimum indicated." />
<div class="figcaption"><em>Direction autocorrelation of a random
trajectory with first local minimum indicated.</em></div>
</div>
</div>
</div>
</div>
<div id="working-with-multiple-trajectories" class="section level2">
<h2>Working with multiple trajectories</h2>
<div id="building-multiple-trajectories" class="section level3">
<h3>Building multiple trajectories</h3>
<p>As trajectory studies are likely to involve multiple trajectories per
individual, per species, or trajectories for multiple species,
<code>trajr</code> provides some functions to simplify the manipulation
of multiple trajectories. <code>TrajsBuild</code> assumes that you have
a set of trajectory files (such as CSV files), each of which may have a
scale and a frames-per-second value. The function reads each of the
files specified in a list of file names, optionally using a custom
function, then passes the result to <code>TrajFromCoords</code>, which
assumes that the first column is <code>x</code>, the second is
<code>y</code>, and there is no time column. If these assumptions are
incorrect, the <code>csvStruct</code> argument can be specified to
identify the <code>x</code>, <code>y</code> and <code>time</code>
columns (see the example below). <code>TrajsBuild</code> optionally
scales the trajectories with the specified scale (by calling
<code>TrajScale</code>), and optionally smooths them with the specified
smoothing parameters (by calling <code>TrajSmoothSG</code>). The value
returned is a list of <code>Trajectory</code> objects.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>tracks <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3527.csv&quot;</span>, <span class="st">&quot;Zodariid2 sp1&quot;</span>,     <span class="st">&quot;spider&quot;</span>,       <span class="st">&quot;red&quot;</span>),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3530.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3534.csv&quot;</span>, <span class="st">&quot;Daerlac nigricans&quot;</span>, <span class="st">&quot;mimic bug&quot;</span>,    <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3537.csv&quot;</span>, <span class="st">&quot;M. erythrocephala&quot;</span>, <span class="st">&quot;mimic spider&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3542.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3543.csv&quot;</span>, <span class="st">&quot;Polyrhachis sp1&quot;</span>,   <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>),</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;3548.csv&quot;</span>, <span class="st">&quot;Crematogaster sp1&quot;</span>, <span class="st">&quot;ant&quot;</span>,          <span class="st">&quot;black&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="fu">colnames</span>(tracks) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;filename&quot;</span>, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;category&quot;</span>, <span class="st">&quot;col&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co"># If your list is read from a CSV file which contains empty lines, </span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co"># remove them like this:</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>tracks <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(tracks)</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co"># Order of columns in the CSV files is unknown so identify them by name</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>csvStruct <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, <span class="at">time =</span> <span class="st">&quot;Time&quot;</span>)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>trjs <span class="ot">&lt;-</span> <span class="fu">TrajsBuild</span>(tracks<span class="sc">$</span>filename, <span class="at">scale =</span> .<span class="dv">220</span> <span class="sc">/</span> <span class="dv">720</span>, </span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>                   <span class="at">spatialUnits =</span> <span class="st">&quot;m&quot;</span>, <span class="at">timeUnits =</span> <span class="st">&quot;s&quot;</span>, </span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>                   <span class="at">csvStruct =</span> csvStruct, <span class="at">rootDir =</span> <span class="st">&quot;..&quot;</span>)</span></code></pre></div>
</div>
<div id="characterising-multiple-trajectories" class="section level3">
<h3>Characterising multiple trajectories</h3>
<p><code>TrajsMergeStats</code> simplifies the construction of a data
frame of values, with one row per trajectory. To use it, you need a list
of trajectories (which you will probably obtain from a call to
<code>TrajsBuild</code>), and a function which calculates statistics for
a single trajectory. The following example demonstrates how you might
write and use such a function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Define a function which calculates some statistics</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># of interest for a single trajectory</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>characteriseTrajectory <span class="ot">&lt;-</span> <span class="cf">function</span>(trj) {</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="co"># Measures of speed</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  derivs <span class="ot">&lt;-</span> <span class="fu">TrajDerivatives</span>(trj)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  mean_speed <span class="ot">&lt;-</span> <span class="fu">mean</span>(derivs<span class="sc">$</span>speed)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  sd_speed <span class="ot">&lt;-</span> <span class="fu">sd</span>(derivs<span class="sc">$</span>speed)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="co"># Measures of straightness</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  sinuosity <span class="ot">&lt;-</span> <span class="fu">TrajSinuosity2</span>(trj)</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  resampled <span class="ot">&lt;-</span> <span class="fu">TrajRediscretize</span>(trj, .<span class="dv">001</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  Emax <span class="ot">&lt;-</span> <span class="fu">TrajEmax</span>(resampled)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>  <span class="co"># Periodicity</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  corr <span class="ot">&lt;-</span> <span class="fu">TrajDirectionAutocorrelations</span>(resampled, <span class="dv">60</span>)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>  first_min <span class="ot">&lt;-</span> <span class="fu">TrajDAFindFirstMinimum</span>(corr)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>  <span class="co"># Return a list with all of the statistics for this trajectory</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">mean_speed =</span> mean_speed,</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>       <span class="at">sd_speed =</span> sd_speed,</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>       <span class="at">sinuosity =</span> sinuosity,</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>       <span class="at">Emax =</span> Emax,</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>       <span class="at">min_deltaS =</span> first_min[<span class="dv">1</span>],</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>       <span class="at">min_C =</span> first_min[<span class="dv">2</span>]</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>  )</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>}</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co"># Calculate all stats for trajectories in the list</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co"># which was built in the previous example</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">TrajsMergeStats</span>(trjs, characteriseTrajectory)</span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="fu">print</span>(stats)</span></code></pre></div>
<pre><code>#&gt;          mean_speed    sd_speed sinuosity       Emax min_deltaS       min_C
#&gt; deltaS  0.061296301 0.009069424  0.829678 3180.72321         33 0.899013229
#&gt; deltaS1 0.010573501 0.005718966 13.507700  100.43632         50 0.303049396
#&gt; 1       0.014175447 0.005206138  7.494835  692.21342         NA          NA
#&gt; deltaS2 0.006245555 0.003005911  5.310497   67.52479          7 0.930992488
#&gt; 11      0.005344287 0.007936181 39.114922   14.90601         NA          NA
#&gt; deltaS3 0.019378799 0.005363627  2.800328   74.33277         35 0.002917922
#&gt; 12      0.014796829 0.002573456  2.045222  112.93798         NA          NA</code></pre>
</div>
<div id="pca-analysis-of-multiple-trajectories" class="section level3">
<h3>PCA analysis of multiple trajectories</h3>
<p>Principal components analysis (PCA) is a commonly used statistical
technique which can be used to visualise similarities and differences
between groups of trajectories. In R, the function <code>prcomp</code>
is usually used to perform a PCA. <code>Prcomp</code> will not process
data containing <code>NA</code>s (in R, the value <code>NA</code> is
used to indicate a ‘<code>N</code>ot <code>A</code>vailable’, or
missing, value). However, <code>NA</code>s can be potentially
informative, especially when using the first local minimum of the
direction autocorrelation function - in this case, an <code>NA</code>
indicates that there was no periodicity detected in the trajectory. To
avoid discarding this information, <code>Trajr</code> provides a utility
function, <code>TrajsStatsReplaceNAs</code>. It is used to replace
<code>NA</code> values with some other value, and optionally adds an
additional column to the data which flags trajectories which originally
contained <code>NA</code> values. It operates on a single column at a
time.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co">#---</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co"># Custom PCA plotting function</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>customPcaPlot <span class="ot">&lt;-</span> <span class="cf">function</span>(x, xlabs, xcols, <span class="at">choices =</span> 1L<span class="sc">:</span>2L, <span class="at">ycol =</span> <span class="st">&quot;#ff2222aa&quot;</span>, ...) {</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="co"># Draw points</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  pts <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(x<span class="sc">$</span>x[, choices]))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">plot</span>(pts, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, </span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">extendrange</span>(pts[, 1L]), <span class="at">ylim =</span> <span class="fu">extendrange</span>(pts[, 2L]), </span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>       <span class="at">asp =</span> <span class="dv">1</span>,</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> xcols, ...)</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="fu">text</span>(pts, <span class="at">labels =</span> xlabs, <span class="at">pos =</span> <span class="dv">1</span>, ...)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  </span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="co"># Draw arrows</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  axs <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(x<span class="sc">$</span>rotation[, choices])) <span class="sc">*</span> <span class="fl">3.5</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  <span class="fu">text</span>(axs, <span class="at">labels =</span> <span class="fu">dimnames</span>(axs)[[1L]], <span class="at">col =</span> ycol, ...)</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>  <span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, axs[, 1L] <span class="sc">*</span> .<span class="dv">8</span>, axs[, 2L] <span class="sc">*</span> .<span class="dv">8</span>, <span class="at">length =</span> .<span class="dv">1</span>, <span class="at">col =</span> ycol)</span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>}</span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co"># ---</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co"># Here we are operating on the statistics from the previous example</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co"># The PCA function, prcomp, can&#39;t handle NAs, so replace NAs with a &quot;neutral&quot; value </span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co"># and create a new column that flags which trajectories had an NA value.</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co"># First fix min_deltaS, and add an extra column which flags non-periodic trajectories</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>pcaStats <span class="ot">&lt;-</span> <span class="fu">TrajsStatsReplaceNAs</span>(stats, <span class="st">&quot;min_deltaS&quot;</span>, </span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>                                 <span class="at">replacementValue =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">max</span>(stats<span class="sc">$</span>min_deltaS, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a>                                 <span class="at">flagColumn =</span> <span class="st">&quot;no_first_min&quot;</span>)</span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co"># Also get rid of NAs in min_C - no need to add another column since it would duplicate no_first_min</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>pcaStats <span class="ot">&lt;-</span> <span class="fu">TrajsStatsReplaceNAs</span>(pcaStats, <span class="st">&quot;min_C&quot;</span>,</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a>                                 <span class="at">replacementValue =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">max</span>(stats<span class="sc">$</span>min_C, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a><span class="co"># Perform the PCA</span></span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>PCA <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(pcaStats, <span class="at">scale. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a><span class="co"># Plot it using custom plotting function. Could just call biplot instead</span></span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a><span class="fu">customPcaPlot</span>(PCA, tracks<span class="sc">$</span>category, tracks<span class="sc">$</span>col, <span class="at">cex =</span> .<span class="dv">8</span>)</span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Spider&quot;</span>, <span class="st">&quot;Mimic&quot;</span>, <span class="st">&quot;Ant&quot;</span>), <span class="at">pch =</span> <span class="dv">16</span>, </span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;black&#39;</span>), <span class="at">inset =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, .<span class="dv">02</span>))</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="PCA of trajectory characterisations." />
<div class="figcaption"><em>PCA of trajectory
characterisations.</em></div>
</div>
<p>The plot above shows that the trajectory of the non-mimetic spider
(red dot) seems quite different from the trajectories of ant mimicking
bugs, ant-mimicking spiders (blue dots) and ants (black dots). The
arrows indicate the importance and direction of the parameters that
separate the trajectories. From the plot, it seems that the non-mimetic
spider varies mainly in speed, (it is faster and more variable) and
E<sub>max</sub> (it walks in a straighter path). While these
trajectories have been digitised from videos of walking animals, clearly
this example does not contain enough data to be meaningful.</p>
</div>
<div id="other-operations" class="section level3">
<h3>Other operations</h3>
<p>The function <code>TrajsStepLengths</code> returns a vector
containing all of the step lengths in a list of trajectories.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">TrajsStepLengths</span>(trjs))</span></code></pre></div>
<pre><code>#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#&gt; 1.000e-10 7.813e-05 2.266e-04 2.266e-04 3.243e-04 1.550e-03</code></pre>
<p><code>TrajConvertTime</code> is a convenience function that converts
a delimited time string to a numeric value. This may be useful if your
data contains times which are formatted as strings with millisecond
accuracy. In general, the base R function <code>strptime</code> should
be used to convert strings to times, but it does not handle
milliseconds.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="fu">c</span>(<span class="st">&quot;0:00:00:029&quot;</span>, <span class="st">&quot;0:01:00:216&quot;</span>, <span class="st">&quot;0:02:01:062&quot;</span>, <span class="st">&quot;1:00:02:195&quot;</span>, <span class="st">&quot;1:06:03:949&quot;</span>, <span class="st">&quot;1:42:04:087&quot;</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>t<span class="sc">$</span>seconds <span class="ot">&lt;-</span> <span class="fu">TrajConvertTime</span>(t<span class="sc">$</span>time)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>t</span></code></pre></div>
<pre><code>#&gt;          time  seconds
#&gt; 1 0:00:00:029    0.029
#&gt; 2 0:01:00:216   60.216
#&gt; 3 0:02:01:062  121.062
#&gt; 4 1:00:02:195 3602.195
#&gt; 5 1:06:03:949 3963.949
#&gt; 6 1:42:04:087 6124.087</code></pre>
</div>
</div>
<div id="random-trajectory-generation" class="section level2">
<h2>Random trajectory generation</h2>
<p><code>Trajr</code> allows you to generate random trajectories with
the <code>TrajGenerate</code> function. Random trajectories may be used
in simulation studies, or simply for experimenting with trajectory
analysis, and it has been used to generate the majority of trajectories
in this document. By default, <code>TrajGenerate</code> returns a
correlated random walk, however, by specifying different arguments, a
variety of trajectory types can be created.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Correlated random walk</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="at">n =</span> <span class="dv">200</span>)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">plot</span>(trj)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;a)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">adj =</span> .<span class="dv">05</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co"># Directed walk</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">random =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="fu">plot</span>(trj)</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;b)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">adj =</span> .<span class="dv">05</span>)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co"># Brownian motion</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">angularErrorDist =</span> <span class="cf">function</span>(n) stats<span class="sc">::</span><span class="fu">runif</span>(n, <span class="sc">-</span>pi, pi))</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="fu">plot</span>(trj)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;c)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">adj =</span> .<span class="dv">05</span>)</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co"># Levy walk - path lengths follow a Cauchy distribution</span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>trj <span class="ot">&lt;-</span> <span class="fu">TrajGenerate</span>(<span class="at">linearErrorDist =</span> stats<span class="sc">::</span>rcauchy)</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="fu">plot</span>(trj)</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;d)&quot;</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">adj =</span> .<span class="dv">05</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="Some generated trajectories. a) correlated walk, b) directed walk, c) brownian motion, d) Levy walk." />
<div class="figcaption"><em>Some generated trajectories. a) correlated
walk, b) directed walk, c) brownian motion, d) Levy walk.</em></div>
</div>
<p><code>trajr</code> provides limited assistance for building more
sophisticated heterogeneous trajectories. Functions exist for splitting
(<code>TrajSplit</code>) and merging (<code>TrajMerge</code>)
trajectories, for detecting when trajectories cross polygon boundaries
(<code>TrajInPolygon</code>) and splitting a trajectory at a polygon
crossing (<code>TrajSplitAtFirstCrossing</code>).</p>
</div>
<div id="three-dimensional-trajectories" class="section level2">
<h2>Three dimensional trajectories</h2>
<p>As of version 1.5.0, <code>trajr</code> provides limited
functionality for characterising 3-dimensional trajectories. All
functions that operate on 3-dimensional trajectories are prefixed with
<code>Traj3D</code>. A 3D trajectory created by
<code>Traj3DFromCoords</code> is a 2D trajectory with an additional
<code>z</code> column, which allows additional functionality. You can
call any of the 2D <code>trajr</code> functions with a 3D trajectory,
however, they will simply ignore the 3rd dimension, so that is probably
not what you want. Any <code>trajr</code> functions that manipulate or
return metadata will work as expected, e.g. <code>TrajGetUnits</code>,
<code>TrajGetNCoords</code>, <code>TrajGetFPS</code>,
<code>TrajGetTimeUnits</code>. Similarly <code>TrajDuration</code> works
correctly as it does not use spatial data.</p>
<p>Functionality for 3D trajectory characterisation is limited to a
small set of functions. Each of the 3D functions is equivalent to a 2D
function with the same name but prefix <code>Traj</code>.</p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>Traj3DFromCoords</code></td>
<td align="left">Creates a 3D Trajectory Object</td>
</tr>
<tr class="even">
<td align="left"><code>Traj3DLength</code></td>
<td align="left">Return the length along a 3D trajectory</td>
</tr>
<tr class="odd">
<td align="left"><code>Traj3DDistance</code></td>
<td align="left">Returns the distance between the start and end points
of a 3D trajectory</td>
</tr>
<tr class="even">
<td align="left"><code>Traj3DStraightness</code></td>
<td align="left">Returns the straightness of a 3D trajectory (distance /
length)</td>
</tr>
<tr class="odd">
<td align="left"><code>Traj3DRediscretize</code></td>
<td align="left">Resamples a 3D trajectory to a constant step
length</td>
</tr>
<tr class="even">
<td align="left"><code>Traj3DResampleTime</code></td>
<td align="left">Resample a 3D trajectory to a constant time
interval</td>
</tr>
<tr class="odd">
<td align="left"><code>Traj3DSmoothSG</code></td>
<td align="left">Smooths a 3D trajectory using a Savitzky-Golay
filter</td>
</tr>
<tr class="even">
<td align="left"><code>Traj3DStepLengths</code></td>
<td align="left">Returns a vector of step lengths of a 3D
trajectory</td>
</tr>
</tbody>
</table>
<p>Plotting a 3D trajectory using <code>plot</code> will simply plot the
x and y dimensions, ignoring the z dimension. If you wish to plot a 3D
representation of a trajectory, use a package such as
<code>rgl</code>.</p>
<pre><code>library(rgl)
t3 &lt;- Traj3DFromCoords(...)
# Plot the 3D line
plot3d(t3$x, t3$y, t3$z, type = &#39;l&#39;, lwd = 2, xlim = range(t3$x))
# Mark the start of the trajectory
plot3d(t3$x[1], t3$y[1], t3$z[1], add = T, type = &#39;s&#39;, size = 0.8)</code></pre>
</div>
<div id="performance" class="section level2">
<h2>Performance</h2>
<p>While <code>trajr</code> was implemented with processing speed in
mind, processing time can be a problem when operating on large numbers
of large trajectories.</p>
<ul>
<li>Use an appropriate step length for <em>rediscretization</em>. Too
small a step length will result in trajectories with an excessive number
of steps and will take a long time to process.</li>
<li>Some steps, such as calculating directional autocorrelations, may be
amenable to <a href="https://en.wikipedia.org/wiki/Memoization">memoisation</a>.</li>
</ul>
</div>
<div id="and-finally" class="section level2">
<h2>And finally…</h2>
<p><code>Trajr</code> is open source, with the source available on <a href="https://github.com/JimMcL/trajr">Github</a>. If you have any
problems or suggestions, email <a href="mailto:jim_mclean@optusnet.com.au" class="email">jim_mclean@optusnet.com.au</a>.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Batschelet, E. (1981). Circular statistics in biology. ACADEMIC
PRESS, 111 FIFTH AVE., NEW YORK, NY 10003, 1981, 388.</p>
<p>Benhamou, S. (2004). How to reliably estimate the tortuosity of an
animal’s path. Journal of Theoretical Biology, 229(2), 209-220. </p>
<p>Benhamou, S. (2006). Detecting an orientation component in animal
paths when the preferred direction is individual-dependent. Ecology,
87(2), 518-528. </p>
<p>Bovet, P., &amp; Benhamou, S. (1988). Spatial analysis of animals’
movements using a correlated random walk model. Journal of Theoretical
Biology, 131(4), 419-433. </p>
<p>Cheung, A., Zhang, S., Stricker, C., &amp; Srinivasan, M. V. (2007).
Animal navigation: the difficulty of moving in a straight line.
Biological Cybernetics, 97(1), 47-61. </p>
<p>Kitamura, T., &amp; Imafuku, M. (2015). Behavioural mimicry in flight
path of Batesian intraspecific polymorphic butterfly Papilio polytes.
Proceedings of the Royal Society B: Biological Sciences, 282(1809). </p>
<p>Nams, V. O. (2006). Improving Accuracy and Precision in Estimating
Fractal Dimension of Animal movement paths. Acta Biotheoretica, 54(1),
1-11. </p>
<p>Shamble, P. S., Hoy, R. R., Cohen, I., &amp; Beatus, T. (2017).
Walking like an ant: a quantitative and experimental approach to
understanding locomotor mimicry in the jumping spider Myrmarachne
formicaria. Proceedings of the Royal Society B: Biological Sciences,
284(1858). </p>
<p>Turchin, P. (1996). Fractal Analyses of Animal Movement: A Critique.
Ecology, 77(7), 2086-2090. </p>
<p>Turchin, P. (1998). Quantitative analysis of movement. Sunderland
(Mass.): Sinauer assoc.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
