{\rtf1\ansi\ansicpg1250\cocoartf1404\cocoasubrtf470
{\fonttbl\f0\fnil\fcharset0 HelveticaNeue;\f1\fnil\fcharset0 Monaco;}
{\colortbl;\red255\green255\blue255;\red38\green38\blue38;\red245\green245\blue245;\red255\green0\blue0;
\red117\green117\blue117;\red210\green0\blue53;\red67\green67\blue67;\red53\green145\blue93;\red83\green83\blue83;
\red0\green0\blue0;}
\paperw11900\paperh16840\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\b\fs28 \cf0 \expnd0\expndtw0\kerning0
Introduction
\b0 \
The 
\f1\fs23\fsmilli11900 \cf2 \cb3 trajr
\f0\fs28 \cf0 \cb1  R package is a toolkit for \cf4 calculating parameters\cf0  and statistical analysis of the trajectories of moving animals. Trajectory analysis is applicable in fields as diverse as optimal foraging theory, studies of migration, and \cf4 behavioural mimicry (verifying similarity in locomotion)\cf0 . A 
\i trajectory
\i0  is simply a record of the path followed by a moving animal. 
\f1\fs23\fsmilli11900 \cf2 \cb3 Trajr
\f0\fs28 \cf0 \cb1  operates on trajectories in the form of a series of locations with times \cf4 (x, y coordinates in time)\cf0 . Trajectories may be obtained by any method which provides this information, including manual tracking, radio telemetry, GPS tracking, and motion tracking from videos.\
The goal of this package (and this document) is to aid biological researchers, who may not have extensive experience with R, to analyse trajectories without being handicapped by a limited knowledge of R or programming. However, a basic understanding of R is required.\
Within this document, the plots are generated by running the code examples immediately before them. For that reason, most code examples start with a call to 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajGenerate
\f0\fs28 \cf0 \cb1 , which generates a random trajectory to be plotted. These calls would not occur in an analysis of real animal trajectories.\
\

\b Creating trajectories
\b0 \
\
While examples are part of the help page, you can display \cf4 them\cf0  by calling the 
\f1\fs23\fsmilli11900 \cf2 \cb3 example
\f0\fs28 \cf0 \cb1  function\cf4 :\cf0  
\f1\fs23\fsmilli11900 \cf2 \cb3 example("TrajFromCoords")
\f0\fs28 \cf0 \cb1  will display and run the examples for the 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajFromCoords
\f0\fs28 \cf0 \cb1  function. \'97> I have never seen so many  \'93examples\'94 in one sentence! ;) I\'92ve changed it a bit :)\
\

\b Scaling trajectories
\b0 \
\
\'93
\f1\fs23\fsmilli11900 \cf5 \cb3 # A 10 mm object had length 47 pixels in the video, scale to metres\cf2 \cb3 \
trj <-\cf6 \cb3  \cf7 TrajScale\cf2 \cb3 (trj, \cf8 \cb3 10\cf2 \cb3  \cf9 \cb3 *\cf6  \cf8 1000\cf2 \cb3  \cf9 \cb3 /\cf6  \cf8 47\cf2 \cb3 , \cf6 \cb3 \'93m\'94\cf2 \cb3 )\'94\
\
\cf4 Does this in practice mean that one should always, for the trajr package, check how many pixels fit in 10 mm from the video or is this just an example and we could do, say 1000 pixels in 1 cm which would be coded: \
\pard\pardeftab720\partightenfactor0
\cf4 \cb3 trj <- TrajScale(trj, 1 * 100 / 1000, \'93m\'94)?\
\
\cf10 Smoothing trajectories\
\
\pard\pardeftab720\partightenfactor0
\cf5 \cb3 # Create a smoothed trajectory\cf2 \cb3 \
smoothed <-\cf6 \cb3  \cf7 TrajSmoothSG\cf2 \cb3 (trj, \cf8 \cb3 3\cf2 \cb3 , \cf8 \cb3 31\cf2 \cb3 )\
\
\pard\pardeftab720\partightenfactor0
\cf4 to me it\'92s not clear which number the filter order and which one is the length, maybe specify this in the text?\
\
\pard\pardeftab720\partightenfactor0

\f0\b\fs33\fsmilli16800 \cf0 \cb1 Other trajectory operations\
\

\b0\fs24 \cf4 this is cool! :)\
\

\b\fs33\fsmilli16800 \cf0 Analysing speed\
\pard\pardeftab720\partightenfactor0

\b0\fs28 \cf0 Once the trajectory speed and acceleration have been obtained, it is simple to calculate values such as mean, maximum, minimum or standard deviation of speed (or acceleration): 
\f1\fs23\fsmilli11900 \cf2 \cb3 mean(derivs$speed)
\f0\fs28 \cf0 \cb1 , 
\f1\fs23\fsmilli11900 \cf2 \cb3 max(derivs$speed)
\f0\fs28 \cf0 \cb1 , 
\f1\fs23\fsmilli11900 \cf2 \cb3 min(derivs$speed)
\f0\fs28 \cf0 \cb1 , or 
\f1\fs23\fsmilli11900 \cf2 \cb3 sd(derivs$speed)
\f0\fs28 \cf0 \cb1 . Similarly, calculations excluding periods when speed drops below (or above) some value are also straightforward, for example: 
\f1\fs23\fsmilli11900 \cf2 \cb3 mean(derivs$speed[deriv$speed > STOPPED_SPEED])
\f0\fs28 \cf0 \cb1 . In addition, the function 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajSpeedIntervals
\f0\fs28 \cf0 \cb1  allows you to determine the time intervals within the trajectory that satisfy a speed constraint, either slower than some speed, faster than a speed, or both. This may be useful, for example, when testing how often, or for how long, a flying insect hovers, \cf4 or a running insect stops\cf0 , i.e.\'a0when its speed drops below some threshold. The object returned by a call to 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajSpeedIntervals
\f0\fs28 \cf0 \cb1  can be plotted.\
\
\cf4 the plot is really cool, showing the hovering intervals, maybe we can apply that to our clearwing moth/bee/wasp trajectory plots :)\
\
\pard\pardeftab720\partightenfactor0

\b\fs29\fsmilli14700 \cf0 Straightness index\
\pard\pardeftab720\partightenfactor0

\b0\fs28 \cf0 Various methods to measure the straightness, or conversely, tortuosity, of trajectories are available within 
\f1\fs23\fsmilli11900 \cf2 \cb3 trajr
\f0\fs28 \cf0 \cb1 . The simplest is \cf4 briefly\cf0  \\(D/L\\), where \\(D\\) is the distance from the start to the end of the trajectory, and \\(L\\) is the length of the trajectory. This straightness index is calculated by the function 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajStraightness
\f0\fs28 \cf0 \cb1 , and is a number ranging from 0 to 1, where 1 indicates a straight line. Benhamou (2004) considers the straightness index to be a reliable measure of the efficiency of a directed walk, but inapplicable to random trajectories.\
Within this section, most of the figures show the statistic plotted for multiple trajectories which vary in their sinuosity. Sinuosity is varied by generating random trajectories with different standard deviations of angular errors.\
\
\pard\pardeftab720\partightenfactor0

\b\fs29\fsmilli14700 \cf0 Sinuosity\
\cf4 \

\b0 maybe it would be useful to say a few words about how to choose step sizes/what step sizes make sense in what cases? There is no information on this matter here, may be confusing for biologists :)\
\
\pard\pardeftab720\partightenfactor0

\b\fs33\fsmilli16800 \cf0 Building multiple trajectories\
\pard\pardeftab720\partightenfactor0

\b0\fs28 \cf0 As trajectory studies are likely to involve multiple trajectories, 
\f1\fs23\fsmilli11900 \cf2 \cb3 trajr
\f0\fs28 \cf0 \cb1  provides some functions to simplify this process. 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajsBuild
\f0\fs28 \cf0 \cb1  assumes that you have a set of trajectory files (such as CSV files), each of which may have a scale and a frames-per-second value. The function reads each of the files specified in a list of file names, optionally using a custom function, then passes the result to 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajFromCoords
\f0\fs28 \cf0 \cb1 , which assumes that the first column is 
\f1\fs23\fsmilli11900 \cf2 \cb3 x
\f0\fs28 \cf0 \cb1 , the second is 
\f1\fs23\fsmilli11900 \cf2 \cb3 y
\f0\fs28 \cf0 \cb1 , and there is no time column. If these settings are incorrect, the 
\f1\fs23\fsmilli11900 \cf2 \cb3 csvStruct
\f0\fs28 \cf0 \cb1  argument can be specified to identify the 
\f1\fs23\fsmilli11900 \cf2 \cb3 x
\f0\fs28 \cf0 \cb1 , 
\f1\fs23\fsmilli11900 \cf2 \cb3 y
\f0\fs28 \cf0 \cb1  and 
\f1\fs23\fsmilli11900 \cf2 \cb3 time
\f0\fs28 \cf0 \cb1  columns (see the example below). 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajsBuild
\f0\fs28 \cf0 \cb1  optionally scales the trajectories with the specified scale (by calling 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajScale
\f0\fs28 \cf0 \cb1 ), and optionally smooths them with the specified smoothing parameters (by calling 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajSmoothSG
\f0\fs28 \cf0 \cb1 ). The value returned is a list of 
\f1\fs23\fsmilli11900 \cf2 \cb3 Trajectory
\f0\fs28 \cf0 \cb1  objects.\
\cf4 \
maybe you should add here something about eliminating blank rows (such as we had in our csv files)? biologists will never think of that ;)\
\
\pard\pardeftab720\partightenfactor0

\b\fs33\fsmilli16800 \cf0 Calculating statistics for multiple trajectories\
\

\b0 \cf4 are these statistics or parameters/calculations? maybe it is just confusing for me but I think of stats as results of a statistic test such as the Kruskal-Wallis test, not the calculated values of, for example, sinuosity, for each individual trajectory.\
\

\b \cf0 PCA analysis of multiple trajectories\
\pard\pardeftab720\partightenfactor0

\b0\fs28 \cf0 Principal components analysis (PCA) is a commonly used statistical technique which can be used to visualise similarities and differences between groups of trajectories. In R, the function 
\f1\fs23\fsmilli11900 \cf2 \cb3 prcomp
\f0\fs28 \cf0 \cb1  is usually used to perform a PCA. 
\f1\fs23\fsmilli11900 \cf2 \cb3 Prcomp
\f0\fs28 \cf0 \cb1  will not process data containing 
\f1\fs23\fsmilli11900 \cf2 \cb3 NA
\f0\fs28 \cf0 \cb1 s (in R, the value 
\f1\fs23\fsmilli11900 \cf2 \cb3 NA
\f0\fs28 \cf0 \cb1  is used to indicate a \'91
\f1\fs23\fsmilli11900 \cf2 \cb3 N
\f0\fs28 \cf0 \cb1 ot 
\f1\fs23\fsmilli11900 \cf2 \cb3 A
\f0\fs28 \cf0 \cb1 vailable\'92, or missing, value). However, 
\f1\fs23\fsmilli11900 \cf2 \cb3 NA
\f0\fs28 \cf0 \cb1 s can be potentially informative, \cf4 especially when using the first local minimum of the direction autocorrelation function - in this case, an 
\f1\fs23\fsmilli11900 \cb3 NA
\f0\fs28 \cb1  indicates that there was no periodicity detected in the trajectory.\'97> shouldn\'92t this also be mentioned in the section for direction autocorrelation so that people aren\'92t terrified when they obtain a number of NAs?\cf0  To avoid discarding this information, 
\f1\fs23\fsmilli11900 \cf2 \cb3 Trajr
\f0\fs28 \cf0 \cb1  provides a utility function, 
\f1\fs23\fsmilli11900 \cf2 \cb3 TrajsStatsReplaceNAs
\f0\fs28 \cf0 \cb1 . It is used to replace 
\f1\fs23\fsmilli11900 \cf2 \cb3 NA
\f0\fs28 \cf0 \cb1  values with some other value, and optionally adds an additional column to the data which flags trajectories which originally contained 
\f1\fs23\fsmilli11900 \cf2 \cb3 NA
\f0\fs28 \cf0 \cb1  values. It operates on a single column at a time.\
\
\pard\pardeftab720\partightenfactor0

\b\fs29\fsmilli14700 \cf0 Expect travel distance\

\b0 \cf4 plots not displayed, just \'93?\'94 in a blue box\
\

\b \cf0 Random or directed?
\b0 \cf4 \
\pard\pardeftab720\partightenfactor0

\f1\fs23\fsmilli11900 \cf2 \cb3 Backward pattern analysis misclassified 18.2% of random walks, and 0% of directed walks\
\cf4 \
The result is not clear to me, this was supposed to give an answer to whether a path is random or directed. What do the percents tell us? \'93Misclassified 0% of directed walks\'94 means they were all directed because they weren\'92t misclassified?}